(function(Ie,Ze){typeof exports=="object"&&typeof module<"u"?Ze(exports):typeof define=="function"&&define.amd?define(["exports"],Ze):(Ie=typeof globalThis<"u"?globalThis:Ie||self,Ze(Ie["@walletconnect/sign-client"]={}))})(this,function(Ie){"use strict";var Ze=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function qt(e){var t=e.default;if(typeof t=="function"){var r=function(){return t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return e[n]}})}),r}function Xa(e){try{return JSON.stringify(e)}catch{return'"[Circular]"'}}var Ja=Za;function Za(e,t,r){var n=r&&r.stringify||Xa,i=1;if(typeof e=="object"&&e!==null){var s=t.length+i;if(s===1)return e;var o=new Array(s);o[0]=n(e);for(var c=1;c<s;c++)o[c]=n(t[c]);return o.join(" ")}if(typeof e!="string")return e;var h=t.length;if(h===0)return e;for(var f="",l=1-i,m=-1,b=e&&e.length||0,w=0;w<b;){if(e.charCodeAt(w)===37&&w+1<b){switch(m=m>-1?m:0,e.charCodeAt(w+1)){case 100:case 102:if(l>=h||t[l]==null)break;m<w&&(f+=e.slice(m,w)),f+=Number(t[l]),m=w+2,w++;break;case 105:if(l>=h||t[l]==null)break;m<w&&(f+=e.slice(m,w)),f+=Math.floor(Number(t[l])),m=w+2,w++;break;case 79:case 111:case 106:if(l>=h||t[l]===void 0)break;m<w&&(f+=e.slice(m,w));var D=typeof t[l];if(D==="string"){f+="'"+t[l]+"'",m=w+2,w++;break}if(D==="function"){f+=t[l].name||"<anonymous>",m=w+2,w++;break}f+=n(t[l]),m=w+2,w++;break;case 115:if(l>=h)break;m<w&&(f+=e.slice(m,w)),f+=String(t[l]),m=w+2,w++;break;case 37:m<w&&(f+=e.slice(m,w)),f+="%",m=w+2,w++,l--;break}++l}++w}return m===-1?e:(m<b&&(f+=e.slice(m)),f)}const Mi=Ja;var zr=Dt;const hr=cc().console||{},Qa={mapHttpRequest:Kr,mapHttpResponse:Kr,wrapRequestSerializer:Sn,wrapResponseSerializer:Sn,wrapErrorSerializer:Sn,req:Kr,res:Kr,err:ic};function ec(e,t){return Array.isArray(e)?e.filter(function(n){return n!=="!stdSerializers.err"}):e===!0?Object.keys(t):!1}function Dt(e){e=e||{},e.browser=e.browser||{};const t=e.browser.transmit;if(t&&typeof t.send!="function")throw Error("pino: transmit option must have a send function");const r=e.browser.write||hr;e.browser.write&&(e.browser.asObject=!0);const n=e.serializers||{},i=ec(e.browser.serialize,n);let s=e.browser.serialize;Array.isArray(e.browser.serialize)&&e.browser.serialize.indexOf("!stdSerializers.err")>-1&&(s=!1);const o=["error","fatal","warn","info","debug","trace"];typeof r=="function"&&(r.error=r.fatal=r.warn=r.info=r.debug=r.trace=r),e.enabled===!1&&(e.level="silent");const c=e.level||"info",h=Object.create(r);h.log||(h.log=lr),Object.defineProperty(h,"levelVal",{get:l}),Object.defineProperty(h,"level",{get:m,set:b});const f={transmit:t,serialize:i,asObject:e.browser.asObject,levels:o,timestamp:sc(e)};h.levels=Dt.levels,h.level=c,h.setMaxListeners=h.getMaxListeners=h.emit=h.addListener=h.on=h.prependListener=h.once=h.prependOnceListener=h.removeListener=h.removeAllListeners=h.listeners=h.listenerCount=h.eventNames=h.write=h.flush=lr,h.serializers=n,h._serialize=i,h._stdErrSerialize=s,h.child=w,t&&(h._logEvent=Dn());function l(){return this.level==="silent"?1/0:this.levels.values[this.level]}function m(){return this._level}function b(D){if(D!=="silent"&&!this.levels.values[D])throw Error("unknown level "+D);this._level=D,rr(f,h,"error","log"),rr(f,h,"fatal","error"),rr(f,h,"warn","error"),rr(f,h,"info","log"),rr(f,h,"debug","log"),rr(f,h,"trace","log")}function w(D,P){if(!D)throw new Error("missing bindings for child Pino");P=P||{},i&&D.serializers&&(P.serializers=D.serializers);const R=P.serializers;if(i&&R){var $=Object.assign({},n,R),E=e.browser.serialize===!0?Object.keys($):i;delete D.serializers,Br([D],E,$,this._stdErrSerialize)}function O(g){this._childLevel=(g._childLevel|0)+1,this.error=nr(g,D,"error"),this.fatal=nr(g,D,"fatal"),this.warn=nr(g,D,"warn"),this.info=nr(g,D,"info"),this.debug=nr(g,D,"debug"),this.trace=nr(g,D,"trace"),$&&(this.serializers=$,this._serialize=E),t&&(this._logEvent=Dn([].concat(g._logEvent.bindings,D)))}return O.prototype=this,new O(this)}return h}Dt.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},Dt.stdSerializers=Qa,Dt.stdTimeFunctions=Object.assign({},{nullTime:ji,epochTime:zi,unixTime:oc,isoTime:ac});function rr(e,t,r,n){const i=Object.getPrototypeOf(t);t[r]=t.levelVal>t.levels.values[r]?lr:i[r]?i[r]:hr[r]||hr[n]||lr,tc(e,t,r)}function tc(e,t,r){!e.transmit&&t[r]===lr||(t[r]=function(n){return function(){const s=e.timestamp(),o=new Array(arguments.length),c=Object.getPrototypeOf&&Object.getPrototypeOf(this)===hr?hr:this;for(var h=0;h<o.length;h++)o[h]=arguments[h];if(e.serialize&&!e.asObject&&Br(o,this._serialize,this.serializers,this._stdErrSerialize),e.asObject?n.call(c,rc(this,r,o,s)):n.apply(c,o),e.transmit){const f=e.transmit.level||t.level,l=Dt.levels.values[f],m=Dt.levels.values[r];if(m<l)return;nc(this,{ts:s,methodLevel:r,methodValue:m,transmitLevel:f,transmitValue:Dt.levels.values[e.transmit.level||t.level],send:e.transmit.send,val:t.levelVal},o)}}}(t[r]))}function rc(e,t,r,n){e._serialize&&Br(r,e._serialize,e.serializers,e._stdErrSerialize);const i=r.slice();let s=i[0];const o={};n&&(o.time=n),o.level=Dt.levels.values[t];let c=(e._childLevel|0)+1;if(c<1&&(c=1),s!==null&&typeof s=="object"){for(;c--&&typeof i[0]=="object";)Object.assign(o,i.shift());s=i.length?Mi(i.shift(),i):void 0}else typeof s=="string"&&(s=Mi(i.shift(),i));return s!==void 0&&(o.msg=s),o}function Br(e,t,r,n){for(const i in e)if(n&&e[i]instanceof Error)e[i]=Dt.stdSerializers.err(e[i]);else if(typeof e[i]=="object"&&!Array.isArray(e[i]))for(const s in e[i])t&&t.indexOf(s)>-1&&s in r&&(e[i][s]=r[s](e[i][s]))}function nr(e,t,r){return function(){const n=new Array(1+arguments.length);n[0]=t;for(var i=1;i<n.length;i++)n[i]=arguments[i-1];return e[r].apply(this,n)}}function nc(e,t,r){const n=t.send,i=t.ts,s=t.methodLevel,o=t.methodValue,c=t.val,h=e._logEvent.bindings;Br(r,e._serialize||Object.keys(e.serializers),e.serializers,e._stdErrSerialize===void 0?!0:e._stdErrSerialize),e._logEvent.ts=i,e._logEvent.messages=r.filter(function(f){return h.indexOf(f)===-1}),e._logEvent.level.label=s,e._logEvent.level.value=o,n(s,e._logEvent,c),e._logEvent=Dn(h)}function Dn(e){return{ts:0,messages:[],bindings:e||[],level:{label:"",value:0}}}function ic(e){const t={type:e.constructor.name,msg:e.message,stack:e.stack};for(const r in e)t[r]===void 0&&(t[r]=e[r]);return t}function sc(e){return typeof e.timestamp=="function"?e.timestamp:e.timestamp===!1?ji:zi}function Kr(){return{}}function Sn(e){return e}function lr(){}function ji(){return!1}function zi(){return Date.now()}function oc(){return Math.round(Date.now()/1e3)}function ac(){return new Date(Date.now()).toISOString()}function cc(){function e(t){return typeof t<"u"&&t}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return e(self)||e(window)||e(this)||{}}}var ct={exports:{}},ir=typeof Reflect=="object"?Reflect:null,Bi=ir&&typeof ir.apply=="function"?ir.apply:function(t,r,n){return Function.prototype.apply.call(t,r,n)},qr;ir&&typeof ir.ownKeys=="function"?qr=ir.ownKeys:Object.getOwnPropertySymbols?qr=function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:qr=function(t){return Object.getOwnPropertyNames(t)};function uc(e){console&&console.warn&&console.warn(e)}var Ki=Number.isNaN||function(t){return t!==t};function Se(){Se.init.call(this)}ct.exports=Se,ct.exports.once=dc,Se.EventEmitter=Se,Se.prototype._events=void 0,Se.prototype._eventsCount=0,Se.prototype._maxListeners=void 0;var qi=10;function Hr(e){if(typeof e!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}Object.defineProperty(Se,"defaultMaxListeners",{enumerable:!0,get:function(){return qi},set:function(e){if(typeof e!="number"||e<0||Ki(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");qi=e}}),Se.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},Se.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||Ki(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this};function Hi(e){return e._maxListeners===void 0?Se.defaultMaxListeners:e._maxListeners}Se.prototype.getMaxListeners=function(){return Hi(this)},Se.prototype.emit=function(t){for(var r=[],n=1;n<arguments.length;n++)r.push(arguments[n]);var i=t==="error",s=this._events;if(s!==void 0)i=i&&s.error===void 0;else if(!i)return!1;if(i){var o;if(r.length>0&&(o=r[0]),o instanceof Error)throw o;var c=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw c.context=o,c}var h=s[t];if(h===void 0)return!1;if(typeof h=="function")Bi(h,this,r);else for(var f=h.length,l=ki(h,f),n=0;n<f;++n)Bi(l[n],this,r);return!0};function Vi(e,t,r,n){var i,s,o;if(Hr(r),s=e._events,s===void 0?(s=e._events=Object.create(null),e._eventsCount=0):(s.newListener!==void 0&&(e.emit("newListener",t,r.listener?r.listener:r),s=e._events),o=s[t]),o===void 0)o=s[t]=r,++e._eventsCount;else if(typeof o=="function"?o=s[t]=n?[r,o]:[o,r]:n?o.unshift(r):o.push(r),i=Hi(e),i>0&&o.length>i&&!o.warned){o.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=o.length,uc(c)}return e}Se.prototype.addListener=function(t,r){return Vi(this,t,r,!1)},Se.prototype.on=Se.prototype.addListener,Se.prototype.prependListener=function(t,r){return Vi(this,t,r,!0)};function fc(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Gi(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},i=fc.bind(n);return i.listener=r,n.wrapFn=i,i}Se.prototype.once=function(t,r){return Hr(r),this.on(t,Gi(this,t,r)),this},Se.prototype.prependOnceListener=function(t,r){return Hr(r),this.prependListener(t,Gi(this,t,r)),this},Se.prototype.removeListener=function(t,r){var n,i,s,o,c;if(Hr(r),i=this._events,i===void 0)return this;if(n=i[t],n===void 0)return this;if(n===r||n.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete i[t],i.removeListener&&this.emit("removeListener",t,n.listener||r));else if(typeof n!="function"){for(s=-1,o=n.length-1;o>=0;o--)if(n[o]===r||n[o].listener===r){c=n[o].listener,s=o;break}if(s<0)return this;s===0?n.shift():hc(n,s),n.length===1&&(i[t]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",t,c||r)}return this},Se.prototype.off=Se.prototype.removeListener,Se.prototype.removeAllListeners=function(t){var r,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[t]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[t]),this;if(arguments.length===0){var s=Object.keys(n),o;for(i=0;i<s.length;++i)o=s[i],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=n[t],typeof r=="function")this.removeListener(t,r);else if(r!==void 0)for(i=r.length-1;i>=0;i--)this.removeListener(t,r[i]);return this};function Wi(e,t,r){var n=e._events;if(n===void 0)return[];var i=n[t];return i===void 0?[]:typeof i=="function"?r?[i.listener||i]:[i]:r?lc(i):ki(i,i.length)}Se.prototype.listeners=function(t){return Wi(this,t,!0)},Se.prototype.rawListeners=function(t){return Wi(this,t,!1)},Se.listenerCount=function(e,t){return typeof e.listenerCount=="function"?e.listenerCount(t):Yi.call(e,t)},Se.prototype.listenerCount=Yi;function Yi(e){var t=this._events;if(t!==void 0){var r=t[e];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}Se.prototype.eventNames=function(){return this._eventsCount>0?qr(this._events):[]};function ki(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function hc(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function lc(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}function dc(e,t){return new Promise(function(r,n){function i(o){e.removeListener(t,s),n(o)}function s(){typeof e.removeListener=="function"&&e.removeListener("error",i),r([].slice.call(arguments))}Xi(e,t,s,{once:!0}),t!=="error"&&pc(e,i,{once:!0})})}function pc(e,t,r){typeof e.on=="function"&&Xi(e,"error",t,r)}function Xi(e,t,r,n){if(typeof e.on=="function")n.once?e.once(t,r):e.on(t,r);else if(typeof e.addEventListener=="function")e.addEventListener(t,function i(s){n.once&&e.removeEventListener(t,i),r(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e)}var Vr={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var xn=function(e,t){return xn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},xn(e,t)};function gc(e,t){xn(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var On=function(){return On=Object.assign||function(t){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},On.apply(this,arguments)};function _c(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function yc(e,t,r,n){var i=arguments.length,s=i<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(e,t,r,n);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(s=(i<3?o(s):i>3?o(t,r,s):o(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s}function bc(e,t){return function(r,n){t(r,n,e)}}function wc(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}function vc(e,t,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function c(l){try{f(n.next(l))}catch(m){o(m)}}function h(l){try{f(n.throw(l))}catch(m){o(m)}}function f(l){l.done?s(l.value):i(l.value).then(c,h)}f((n=n.apply(e,t||[])).next())})}function mc(e,t){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(f){return function(l){return h([f,l])}}function h(f){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=f[0]&2?i.return:f[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,f[1])).done)return s;switch(i=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return r.label++,{value:f[1],done:!1};case 5:r.label++,i=f[1],f=[0];continue;case 7:f=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){r=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){r.label=f[1];break}if(f[0]===6&&r.label<s[1]){r.label=s[1],s=f;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(f);break}s[2]&&r.ops.pop(),r.trys.pop();continue}f=t.call(e,r)}catch(l){f=[6,l],i=0}finally{n=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function Ec(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}function Dc(e,t){for(var r in e)r!=="default"&&!t.hasOwnProperty(r)&&(t[r]=e[r])}function In(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ji(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),i,s=[],o;try{for(;(t===void 0||t-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(c){o={error:c}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return s}function Sc(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Ji(arguments[t]));return e}function xc(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),i=0,t=0;t<r;t++)for(var s=arguments[t],o=0,c=s.length;o<c;o++,i++)n[i]=s[o];return n}function dr(e){return this instanceof dr?(this.v=e,this):new dr(e)}function Oc(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(e,t||[]),i,s=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(b){n[b]&&(i[b]=function(w){return new Promise(function(D,P){s.push([b,w,D,P])>1||c(b,w)})})}function c(b,w){try{h(n[b](w))}catch(D){m(s[0][3],D)}}function h(b){b.value instanceof dr?Promise.resolve(b.value.v).then(f,l):m(s[0][2],b)}function f(b){c("next",b)}function l(b){c("throw",b)}function m(b,w){b(w),s.shift(),s.length&&c(s[0][0],s[0][1])}}function Ic(e){var t,r;return t={},n("next"),n("throw",function(i){throw i}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(i,s){t[i]=e[i]?function(o){return(r=!r)?{value:dr(e[i](o)),done:i==="return"}:s?s(o):o}:s}}function Tc(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof In=="function"?In(e):e[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=e[s]&&function(o){return new Promise(function(c,h){o=e[s](o),i(c,h,o.done,o.value)})}}function i(s,o,c,h){Promise.resolve(h).then(function(f){s({value:f,done:c})},o)}}function Nc(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function Ac(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function Rc(e){return e&&e.__esModule?e:{default:e}}function Pc(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}function Cc(e,t,r){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,r),r}var Fc=Object.freeze({__proto__:null,__extends:gc,get __assign(){return On},__rest:_c,__decorate:yc,__param:bc,__metadata:wc,__awaiter:vc,__generator:mc,__createBinding:Ec,__exportStar:Dc,__values:In,__read:Ji,__spread:Sc,__spreadArrays:xc,__await:dr,__asyncGenerator:Oc,__asyncDelegator:Ic,__asyncValues:Tc,__makeTemplateObject:Nc,__importStar:Ac,__importDefault:Rc,__classPrivateFieldGet:Pc,__classPrivateFieldSet:Cc}),Zi=qt(Fc),pr={};Object.defineProperty(pr,"__esModule",{value:!0});function Lc(e){if(typeof e!="string")throw new Error(`Cannot safe json parse value of type ${typeof e}`);try{return JSON.parse(e)}catch{return e}}pr.safeJsonParse=Lc;function Uc(e){return typeof e=="string"?e:JSON.stringify(e,(t,r)=>typeof r>"u"?null:r)}pr.safeJsonStringify=Uc;var gr={exports:{}},Qi;function $c(){return Qi||(Qi=1,function(){let e;function t(){}e=t,e.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},e.prototype.setItem=function(r,n){this[r]=String(n)},e.prototype.removeItem=function(r){delete this[r]},e.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(n){r[n]=void 0,delete r[n]})},e.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},e.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof Ze<"u"&&Ze.localStorage?gr.exports=Ze.localStorage:typeof window<"u"&&window.localStorage?gr.exports=window.localStorage:gr.exports=new t}()),gr.exports}var Tn={},_r={},es;function Mc(){if(es)return _r;es=1,Object.defineProperty(_r,"__esModule",{value:!0}),_r.IKeyValueStorage=void 0;class e{}return _r.IKeyValueStorage=e,_r}var yr={},ts;function jc(){if(ts)return yr;ts=1,Object.defineProperty(yr,"__esModule",{value:!0}),yr.parseEntry=void 0;const e=pr;function t(r){var n;return[r[0],e.safeJsonParse((n=r[1])!==null&&n!==void 0?n:"")]}return yr.parseEntry=t,yr}var rs;function zc(){return rs||(rs=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=Zi;t.__exportStar(Mc(),e),t.__exportStar(jc(),e)}(Tn)),Tn}Object.defineProperty(Vr,"__esModule",{value:!0}),Vr.KeyValueStorage=void 0;const sr=Zi,ns=pr,Bc=sr.__importDefault($c()),Kc=zc();class is{constructor(){this.localStorage=Bc.default}getKeys(){return sr.__awaiter(this,void 0,void 0,function*(){return Object.keys(this.localStorage)})}getEntries(){return sr.__awaiter(this,void 0,void 0,function*(){return Object.entries(this.localStorage).map(Kc.parseEntry)})}getItem(t){return sr.__awaiter(this,void 0,void 0,function*(){const r=this.localStorage.getItem(t);if(r!==null)return ns.safeJsonParse(r)})}setItem(t,r){return sr.__awaiter(this,void 0,void 0,function*(){this.localStorage.setItem(t,ns.safeJsonStringify(r))})}removeItem(t){return sr.__awaiter(this,void 0,void 0,function*(){this.localStorage.removeItem(t)})}}Vr.KeyValueStorage=is;var qc=Vr.default=is,br={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var Nn=function(e,t){return Nn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},Nn(e,t)};function Hc(e,t){Nn(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var An=function(){return An=Object.assign||function(t){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},An.apply(this,arguments)};function Vc(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function Gc(e,t,r,n){var i=arguments.length,s=i<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(e,t,r,n);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(s=(i<3?o(s):i>3?o(t,r,s):o(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s}function Wc(e,t){return function(r,n){t(r,n,e)}}function Yc(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}function kc(e,t,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function c(l){try{f(n.next(l))}catch(m){o(m)}}function h(l){try{f(n.throw(l))}catch(m){o(m)}}function f(l){l.done?s(l.value):i(l.value).then(c,h)}f((n=n.apply(e,t||[])).next())})}function Xc(e,t){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(f){return function(l){return h([f,l])}}function h(f){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=f[0]&2?i.return:f[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,f[1])).done)return s;switch(i=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return r.label++,{value:f[1],done:!1};case 5:r.label++,i=f[1],f=[0];continue;case 7:f=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){r=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){r.label=f[1];break}if(f[0]===6&&r.label<s[1]){r.label=s[1],s=f;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(f);break}s[2]&&r.ops.pop(),r.trys.pop();continue}f=t.call(e,r)}catch(l){f=[6,l],i=0}finally{n=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function Jc(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}function Zc(e,t){for(var r in e)r!=="default"&&!t.hasOwnProperty(r)&&(t[r]=e[r])}function Rn(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function ss(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),i,s=[],o;try{for(;(t===void 0||t-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(c){o={error:c}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return s}function Qc(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(ss(arguments[t]));return e}function eu(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),i=0,t=0;t<r;t++)for(var s=arguments[t],o=0,c=s.length;o<c;o++,i++)n[i]=s[o];return n}function wr(e){return this instanceof wr?(this.v=e,this):new wr(e)}function tu(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(e,t||[]),i,s=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(b){n[b]&&(i[b]=function(w){return new Promise(function(D,P){s.push([b,w,D,P])>1||c(b,w)})})}function c(b,w){try{h(n[b](w))}catch(D){m(s[0][3],D)}}function h(b){b.value instanceof wr?Promise.resolve(b.value.v).then(f,l):m(s[0][2],b)}function f(b){c("next",b)}function l(b){c("throw",b)}function m(b,w){b(w),s.shift(),s.length&&c(s[0][0],s[0][1])}}function ru(e){var t,r;return t={},n("next"),n("throw",function(i){throw i}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(i,s){t[i]=e[i]?function(o){return(r=!r)?{value:wr(e[i](o)),done:i==="return"}:s?s(o):o}:s}}function nu(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof Rn=="function"?Rn(e):e[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=e[s]&&function(o){return new Promise(function(c,h){o=e[s](o),i(c,h,o.done,o.value)})}}function i(s,o,c,h){Promise.resolve(h).then(function(f){s({value:f,done:c})},o)}}function iu(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function su(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function ou(e){return e&&e.__esModule?e:{default:e}}function au(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}function cu(e,t,r){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,r),r}var uu=Object.freeze({__proto__:null,__extends:Hc,get __assign(){return An},__rest:Vc,__decorate:Gc,__param:Wc,__metadata:Yc,__awaiter:kc,__generator:Xc,__createBinding:Jc,__exportStar:Zc,__values:Rn,__read:ss,__spread:Qc,__spreadArrays:eu,__await:wr,__asyncGenerator:tu,__asyncDelegator:ru,__asyncValues:nu,__makeTemplateObject:iu,__importStar:su,__importDefault:ou,__classPrivateFieldGet:au,__classPrivateFieldSet:cu}),Gr=qt(uu),vr={},Z={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var Pn=function(e,t){return Pn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},Pn(e,t)};function fu(e,t){Pn(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var Cn=function(){return Cn=Object.assign||function(t){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},Cn.apply(this,arguments)};function hu(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function lu(e,t,r,n){var i=arguments.length,s=i<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(e,t,r,n);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(s=(i<3?o(s):i>3?o(t,r,s):o(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s}function du(e,t){return function(r,n){t(r,n,e)}}function pu(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}function gu(e,t,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function c(l){try{f(n.next(l))}catch(m){o(m)}}function h(l){try{f(n.throw(l))}catch(m){o(m)}}function f(l){l.done?s(l.value):i(l.value).then(c,h)}f((n=n.apply(e,t||[])).next())})}function _u(e,t){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(f){return function(l){return h([f,l])}}function h(f){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=f[0]&2?i.return:f[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,f[1])).done)return s;switch(i=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return r.label++,{value:f[1],done:!1};case 5:r.label++,i=f[1],f=[0];continue;case 7:f=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){r=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){r.label=f[1];break}if(f[0]===6&&r.label<s[1]){r.label=s[1],s=f;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(f);break}s[2]&&r.ops.pop(),r.trys.pop();continue}f=t.call(e,r)}catch(l){f=[6,l],i=0}finally{n=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function yu(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}function bu(e,t){for(var r in e)r!=="default"&&!t.hasOwnProperty(r)&&(t[r]=e[r])}function Fn(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function os(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),i,s=[],o;try{for(;(t===void 0||t-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(c){o={error:c}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return s}function wu(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(os(arguments[t]));return e}function vu(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),i=0,t=0;t<r;t++)for(var s=arguments[t],o=0,c=s.length;o<c;o++,i++)n[i]=s[o];return n}function mr(e){return this instanceof mr?(this.v=e,this):new mr(e)}function mu(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(e,t||[]),i,s=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(b){n[b]&&(i[b]=function(w){return new Promise(function(D,P){s.push([b,w,D,P])>1||c(b,w)})})}function c(b,w){try{h(n[b](w))}catch(D){m(s[0][3],D)}}function h(b){b.value instanceof mr?Promise.resolve(b.value.v).then(f,l):m(s[0][2],b)}function f(b){c("next",b)}function l(b){c("throw",b)}function m(b,w){b(w),s.shift(),s.length&&c(s[0][0],s[0][1])}}function Eu(e){var t,r;return t={},n("next"),n("throw",function(i){throw i}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(i,s){t[i]=e[i]?function(o){return(r=!r)?{value:mr(e[i](o)),done:i==="return"}:s?s(o):o}:s}}function Du(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof Fn=="function"?Fn(e):e[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=e[s]&&function(o){return new Promise(function(c,h){o=e[s](o),i(c,h,o.done,o.value)})}}function i(s,o,c,h){Promise.resolve(h).then(function(f){s({value:f,done:c})},o)}}function Su(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function xu(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function Ou(e){return e&&e.__esModule?e:{default:e}}function Iu(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}function Tu(e,t,r){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,r),r}var Nu=Object.freeze({__proto__:null,__extends:fu,get __assign(){return Cn},__rest:hu,__decorate:lu,__param:du,__metadata:pu,__awaiter:gu,__generator:_u,__createBinding:yu,__exportStar:bu,__values:Fn,__read:os,__spread:wu,__spreadArrays:vu,__await:mr,__asyncGenerator:mu,__asyncDelegator:Eu,__asyncValues:Du,__makeTemplateObject:Su,__importStar:xu,__importDefault:Ou,__classPrivateFieldGet:Iu,__classPrivateFieldSet:Tu}),Wr=qt(Nu),Ln={},Er={},as;function Au(){if(as)return Er;as=1,Object.defineProperty(Er,"__esModule",{value:!0}),Er.delay=void 0;function e(t){return new Promise(r=>{setTimeout(()=>{r(!0)},t)})}return Er.delay=e,Er}var Ht={},Un={},Vt={},cs;function Ru(){return cs||(cs=1,Object.defineProperty(Vt,"__esModule",{value:!0}),Vt.ONE_THOUSAND=Vt.ONE_HUNDRED=void 0,Vt.ONE_HUNDRED=100,Vt.ONE_THOUSAND=1e3),Vt}var $n={},us;function Pu(){return us||(us=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ONE_YEAR=e.FOUR_WEEKS=e.THREE_WEEKS=e.TWO_WEEKS=e.ONE_WEEK=e.THIRTY_DAYS=e.SEVEN_DAYS=e.FIVE_DAYS=e.THREE_DAYS=e.ONE_DAY=e.TWENTY_FOUR_HOURS=e.TWELVE_HOURS=e.SIX_HOURS=e.THREE_HOURS=e.ONE_HOUR=e.SIXTY_MINUTES=e.THIRTY_MINUTES=e.TEN_MINUTES=e.FIVE_MINUTES=e.ONE_MINUTE=e.SIXTY_SECONDS=e.THIRTY_SECONDS=e.TEN_SECONDS=e.FIVE_SECONDS=e.ONE_SECOND=void 0,e.ONE_SECOND=1,e.FIVE_SECONDS=5,e.TEN_SECONDS=10,e.THIRTY_SECONDS=30,e.SIXTY_SECONDS=60,e.ONE_MINUTE=e.SIXTY_SECONDS,e.FIVE_MINUTES=e.ONE_MINUTE*5,e.TEN_MINUTES=e.ONE_MINUTE*10,e.THIRTY_MINUTES=e.ONE_MINUTE*30,e.SIXTY_MINUTES=e.ONE_MINUTE*60,e.ONE_HOUR=e.SIXTY_MINUTES,e.THREE_HOURS=e.ONE_HOUR*3,e.SIX_HOURS=e.ONE_HOUR*6,e.TWELVE_HOURS=e.ONE_HOUR*12,e.TWENTY_FOUR_HOURS=e.ONE_HOUR*24,e.ONE_DAY=e.TWENTY_FOUR_HOURS,e.THREE_DAYS=e.ONE_DAY*3,e.FIVE_DAYS=e.ONE_DAY*5,e.SEVEN_DAYS=e.ONE_DAY*7,e.THIRTY_DAYS=e.ONE_DAY*30,e.ONE_WEEK=e.SEVEN_DAYS,e.TWO_WEEKS=e.ONE_WEEK*2,e.THREE_WEEKS=e.ONE_WEEK*3,e.FOUR_WEEKS=e.ONE_WEEK*4,e.ONE_YEAR=e.ONE_DAY*365}($n)),$n}var fs;function hs(){return fs||(fs=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=Wr;t.__exportStar(Ru(),e),t.__exportStar(Pu(),e)}(Un)),Un}var ls;function Cu(){if(ls)return Ht;ls=1,Object.defineProperty(Ht,"__esModule",{value:!0}),Ht.fromMiliseconds=Ht.toMiliseconds=void 0;const e=hs();function t(n){return n*e.ONE_THOUSAND}Ht.toMiliseconds=t;function r(n){return Math.floor(n/e.ONE_THOUSAND)}return Ht.fromMiliseconds=r,Ht}var ds;function Fu(){return ds||(ds=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=Wr;t.__exportStar(Au(),e),t.__exportStar(Cu(),e)}(Ln)),Ln}var or={},ps;function Lu(){if(ps)return or;ps=1,Object.defineProperty(or,"__esModule",{value:!0}),or.Watch=void 0;class e{constructor(){this.timestamps=new Map}start(r){if(this.timestamps.has(r))throw new Error(`Watch already started for label: ${r}`);this.timestamps.set(r,{started:Date.now()})}stop(r){const n=this.get(r);if(typeof n.elapsed<"u")throw new Error(`Watch already stopped for label: ${r}`);const i=Date.now()-n.started;this.timestamps.set(r,{started:n.started,elapsed:i})}get(r){const n=this.timestamps.get(r);if(typeof n>"u")throw new Error(`No timestamp found for label: ${r}`);return n}elapsed(r){const n=this.get(r);return n.elapsed||Date.now()-n.started}}return or.Watch=e,or.default=e,or}var Mn={},Dr={},gs;function Uu(){if(gs)return Dr;gs=1,Object.defineProperty(Dr,"__esModule",{value:!0}),Dr.IWatch=void 0;class e{}return Dr.IWatch=e,Dr}var _s;function $u(){return _s||(_s=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),Wr.__exportStar(Uu(),e)}(Mn)),Mn}(function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=Wr;t.__exportStar(Fu(),e),t.__exportStar(Lu(),e),t.__exportStar($u(),e),t.__exportStar(hs(),e)})(Z);var jn={},Sr={};class Gt{}var Mu=Object.freeze({__proto__:null,IEvents:Gt}),ju=qt(Mu),ys;function zu(){if(ys)return Sr;ys=1,Object.defineProperty(Sr,"__esModule",{value:!0}),Sr.IHeartBeat=void 0;const e=ju;class t extends e.IEvents{constructor(n){super()}}return Sr.IHeartBeat=t,Sr}var bs;function ws(){return bs||(bs=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),Gr.__exportStar(zu(),e)}(jn)),jn}var zn={},Wt={},vs;function Bu(){if(vs)return Wt;vs=1,Object.defineProperty(Wt,"__esModule",{value:!0}),Wt.HEARTBEAT_EVENTS=Wt.HEARTBEAT_INTERVAL=void 0;const e=Z;return Wt.HEARTBEAT_INTERVAL=e.FIVE_SECONDS,Wt.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Wt}var ms;function Es(){return ms||(ms=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),Gr.__exportStar(Bu(),e)}(zn)),zn}var Ds;function Ku(){if(Ds)return vr;Ds=1,Object.defineProperty(vr,"__esModule",{value:!0}),vr.HeartBeat=void 0;const e=Gr,t=ct.exports,r=Z,n=ws(),i=Es();class s extends n.IHeartBeat{constructor(c){super(c),this.events=new t.EventEmitter,this.interval=i.HEARTBEAT_INTERVAL,this.interval=c?.interval||i.HEARTBEAT_INTERVAL}static init(c){return e.__awaiter(this,void 0,void 0,function*(){const h=new s(c);return yield h.init(),h})}init(){return e.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(c,h){this.events.on(c,h)}once(c,h){this.events.once(c,h)}off(c,h){this.events.off(c,h)}removeListener(c,h){this.events.removeListener(c,h)}initialize(){return e.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(i.HEARTBEAT_EVENTS.pulse)}}return vr.HeartBeat=s,vr}(function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=Gr;t.__exportStar(Ku(),e),t.__exportStar(ws(),e),t.__exportStar(Es(),e)})(br);var xe={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var Bn=function(e,t){return Bn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},Bn(e,t)};function qu(e,t){Bn(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var Kn=function(){return Kn=Object.assign||function(t){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},Kn.apply(this,arguments)};function Hu(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function Vu(e,t,r,n){var i=arguments.length,s=i<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(e,t,r,n);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(s=(i<3?o(s):i>3?o(t,r,s):o(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s}function Gu(e,t){return function(r,n){t(r,n,e)}}function Wu(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}function Yu(e,t,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function c(l){try{f(n.next(l))}catch(m){o(m)}}function h(l){try{f(n.throw(l))}catch(m){o(m)}}function f(l){l.done?s(l.value):i(l.value).then(c,h)}f((n=n.apply(e,t||[])).next())})}function ku(e,t){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(f){return function(l){return h([f,l])}}function h(f){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=f[0]&2?i.return:f[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,f[1])).done)return s;switch(i=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return r.label++,{value:f[1],done:!1};case 5:r.label++,i=f[1],f=[0];continue;case 7:f=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){r=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){r.label=f[1];break}if(f[0]===6&&r.label<s[1]){r.label=s[1],s=f;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(f);break}s[2]&&r.ops.pop(),r.trys.pop();continue}f=t.call(e,r)}catch(l){f=[6,l],i=0}finally{n=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function Xu(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}function Ju(e,t){for(var r in e)r!=="default"&&!t.hasOwnProperty(r)&&(t[r]=e[r])}function qn(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ss(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),i,s=[],o;try{for(;(t===void 0||t-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(c){o={error:c}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return s}function Zu(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Ss(arguments[t]));return e}function Qu(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),i=0,t=0;t<r;t++)for(var s=arguments[t],o=0,c=s.length;o<c;o++,i++)n[i]=s[o];return n}function xr(e){return this instanceof xr?(this.v=e,this):new xr(e)}function ef(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(e,t||[]),i,s=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(b){n[b]&&(i[b]=function(w){return new Promise(function(D,P){s.push([b,w,D,P])>1||c(b,w)})})}function c(b,w){try{h(n[b](w))}catch(D){m(s[0][3],D)}}function h(b){b.value instanceof xr?Promise.resolve(b.value.v).then(f,l):m(s[0][2],b)}function f(b){c("next",b)}function l(b){c("throw",b)}function m(b,w){b(w),s.shift(),s.length&&c(s[0][0],s[0][1])}}function tf(e){var t,r;return t={},n("next"),n("throw",function(i){throw i}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(i,s){t[i]=e[i]?function(o){return(r=!r)?{value:xr(e[i](o)),done:i==="return"}:s?s(o):o}:s}}function rf(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof qn=="function"?qn(e):e[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=e[s]&&function(o){return new Promise(function(c,h){o=e[s](o),i(c,h,o.done,o.value)})}}function i(s,o,c,h){Promise.resolve(h).then(function(f){s({value:f,done:c})},o)}}function nf(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function sf(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function of(e){return e&&e.__esModule?e:{default:e}}function af(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}function cf(e,t,r){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,r),r}var uf=Object.freeze({__proto__:null,__extends:qu,get __assign(){return Kn},__rest:Hu,__decorate:Vu,__param:Gu,__metadata:Wu,__awaiter:Yu,__generator:ku,__createBinding:Xu,__exportStar:Ju,__values:qn,__read:Ss,__spread:Zu,__spreadArrays:Qu,__await:xr,__asyncGenerator:ef,__asyncDelegator:tf,__asyncValues:rf,__makeTemplateObject:nf,__importStar:sf,__importDefault:of,__classPrivateFieldGet:af,__classPrivateFieldSet:cf}),ff=qt(uf),Yt={},xs;function Os(){return xs||(xs=1,Object.defineProperty(Yt,"__esModule",{value:!0}),Yt.PINO_CUSTOM_CONTEXT_KEY=Yt.PINO_LOGGER_DEFAULTS=void 0,Yt.PINO_LOGGER_DEFAULTS={level:"info"},Yt.PINO_CUSTOM_CONTEXT_KEY="custom_context"),Yt}var ot={},Is;function hf(){if(Is)return ot;Is=1,Object.defineProperty(ot,"__esModule",{value:!0}),ot.generateChildLogger=ot.formatChildLoggerContext=ot.getLoggerContext=ot.setBrowserLoggerContext=ot.getBrowserLoggerContext=ot.getDefaultLoggerOptions=void 0;const e=Os();function t(c){return Object.assign(Object.assign({},c),{level:c?.level||e.PINO_LOGGER_DEFAULTS.level})}ot.getDefaultLoggerOptions=t;function r(c,h=e.PINO_CUSTOM_CONTEXT_KEY){return c[h]||""}ot.getBrowserLoggerContext=r;function n(c,h,f=e.PINO_CUSTOM_CONTEXT_KEY){return c[f]=h,c}ot.setBrowserLoggerContext=n;function i(c,h=e.PINO_CUSTOM_CONTEXT_KEY){let f="";return typeof c.bindings>"u"?f=r(c,h):f=c.bindings().context||"",f}ot.getLoggerContext=i;function s(c,h,f=e.PINO_CUSTOM_CONTEXT_KEY){const l=i(c,f);return l.trim()?`${l}/${h}`:h}ot.formatChildLoggerContext=s;function o(c,h,f=e.PINO_CUSTOM_CONTEXT_KEY){const l=s(c,h,f),m=c.child({context:l});return n(m,l,f)}return ot.generateChildLogger=o,ot}(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.pino=void 0;const t=ff,r=t.__importDefault(zr);Object.defineProperty(e,"pino",{enumerable:!0,get:function(){return r.default}}),t.__exportStar(Os(),e),t.__exportStar(hf(),e)})(xe);class lf extends Gt{constructor(t){super(),this.opts=t,this.protocol="wc",this.version=2}}class df extends Gt{constructor(t,r){super(),this.core=t,this.logger=r,this.records=new Map}}class pf{constructor(t,r){this.logger=t,this.core=r}}class gf extends Gt{constructor(t,r){super(),this.relayer=t,this.logger=r}}class _f extends Gt{constructor(t){super()}}class yf{constructor(t,r,n,i){this.core=t,this.logger=r,this.name=n}}class bf extends Gt{constructor(t,r){super(),this.relayer=t,this.logger=r}}class wf extends Gt{constructor(t,r){super(),this.core=t,this.logger=r}}class vf{constructor(t){this.opts=t,this.protocol="wc",this.version=2}}class mf{constructor(t){this.client=t}}function Ts(e){if(typeof e!="string")throw new Error(`Cannot safe json parse value of type ${typeof e}`);try{return JSON.parse(e)}catch{return e}}function Hn(e){return typeof e=="string"?e:JSON.stringify(e)}var Vn={},ar={},Yr={},kr={};Object.defineProperty(kr,"__esModule",{value:!0}),kr.BrowserRandomSource=void 0;const Ns=65536;class Ef{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const t=typeof self<"u"?self.crypto||self.msCrypto:null;t&&t.getRandomValues!==void 0&&(this._crypto=t,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(t){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const r=new Uint8Array(t);for(let n=0;n<r.length;n+=Ns)this._crypto.getRandomValues(r.subarray(n,n+Math.min(r.length-n,Ns)));return r}}kr.BrowserRandomSource=Ef;function Df(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Xr={},dt={};Object.defineProperty(dt,"__esModule",{value:!0});function Sf(e){for(var t=0;t<e.length;t++)e[t]=0;return e}dt.wipe=Sf;var xf={},Of=Object.freeze({__proto__:null,default:xf}),If=qt(Of);Object.defineProperty(Xr,"__esModule",{value:!0}),Xr.NodeRandomSource=void 0;const Tf=dt;class Nf{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof Df<"u"){const t=If;t&&t.randomBytes&&(this._crypto=t,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(t){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let r=this._crypto.randomBytes(t);if(r.length!==t)throw new Error("NodeRandomSource: got fewer bytes than requested");const n=new Uint8Array(t);for(let i=0;i<n.length;i++)n[i]=r[i];return(0,Tf.wipe)(r),n}}Xr.NodeRandomSource=Nf,Object.defineProperty(Yr,"__esModule",{value:!0}),Yr.SystemRandomSource=void 0;const Af=kr,Rf=Xr;class Pf{constructor(){if(this.isAvailable=!1,this.name="",this._source=new Af.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new Rf.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(t){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(t)}}Yr.SystemRandomSource=Pf;var te={},As={};(function(e){Object.defineProperty(e,"__esModule",{value:!0});function t(c,h){var f=c>>>16&65535,l=c&65535,m=h>>>16&65535,b=h&65535;return l*b+(f*b+l*m<<16>>>0)|0}e.mul=Math.imul||t;function r(c,h){return c+h|0}e.add=r;function n(c,h){return c-h|0}e.sub=n;function i(c,h){return c<<h|c>>>32-h}e.rotl=i;function s(c,h){return c<<32-h|c>>>h}e.rotr=s;function o(c){return typeof c=="number"&&isFinite(c)&&Math.floor(c)===c}e.isInteger=Number.isInteger||o,e.MAX_SAFE_INTEGER=9007199254740991,e.isSafeInteger=function(c){return e.isInteger(c)&&c>=-e.MAX_SAFE_INTEGER&&c<=e.MAX_SAFE_INTEGER}})(As),Object.defineProperty(te,"__esModule",{value:!0});var Rs=As;function Cf(e,t){return t===void 0&&(t=0),(e[t+0]<<8|e[t+1])<<16>>16}te.readInt16BE=Cf;function Ff(e,t){return t===void 0&&(t=0),(e[t+0]<<8|e[t+1])>>>0}te.readUint16BE=Ff;function Lf(e,t){return t===void 0&&(t=0),(e[t+1]<<8|e[t])<<16>>16}te.readInt16LE=Lf;function Uf(e,t){return t===void 0&&(t=0),(e[t+1]<<8|e[t])>>>0}te.readUint16LE=Uf;function Ps(e,t,r){return t===void 0&&(t=new Uint8Array(2)),r===void 0&&(r=0),t[r+0]=e>>>8,t[r+1]=e>>>0,t}te.writeUint16BE=Ps,te.writeInt16BE=Ps;function Cs(e,t,r){return t===void 0&&(t=new Uint8Array(2)),r===void 0&&(r=0),t[r+0]=e>>>0,t[r+1]=e>>>8,t}te.writeUint16LE=Cs,te.writeInt16LE=Cs;function Gn(e,t){return t===void 0&&(t=0),e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]}te.readInt32BE=Gn;function Wn(e,t){return t===void 0&&(t=0),(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}te.readUint32BE=Wn;function Yn(e,t){return t===void 0&&(t=0),e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]}te.readInt32LE=Yn;function kn(e,t){return t===void 0&&(t=0),(e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t])>>>0}te.readUint32LE=kn;function Jr(e,t,r){return t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0),t[r+0]=e>>>24,t[r+1]=e>>>16,t[r+2]=e>>>8,t[r+3]=e>>>0,t}te.writeUint32BE=Jr,te.writeInt32BE=Jr;function Zr(e,t,r){return t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0),t[r+0]=e>>>0,t[r+1]=e>>>8,t[r+2]=e>>>16,t[r+3]=e>>>24,t}te.writeUint32LE=Zr,te.writeInt32LE=Zr;function $f(e,t){t===void 0&&(t=0);var r=Gn(e,t),n=Gn(e,t+4);return r*4294967296+n-(n>>31)*4294967296}te.readInt64BE=$f;function Mf(e,t){t===void 0&&(t=0);var r=Wn(e,t),n=Wn(e,t+4);return r*4294967296+n}te.readUint64BE=Mf;function jf(e,t){t===void 0&&(t=0);var r=Yn(e,t),n=Yn(e,t+4);return n*4294967296+r-(r>>31)*4294967296}te.readInt64LE=jf;function zf(e,t){t===void 0&&(t=0);var r=kn(e,t),n=kn(e,t+4);return n*4294967296+r}te.readUint64LE=zf;function Fs(e,t,r){return t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0),Jr(e/4294967296>>>0,t,r),Jr(e>>>0,t,r+4),t}te.writeUint64BE=Fs,te.writeInt64BE=Fs;function Ls(e,t,r){return t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0),Zr(e>>>0,t,r),Zr(e/4294967296>>>0,t,r+4),t}te.writeUint64LE=Ls,te.writeInt64LE=Ls;function Bf(e,t,r){if(r===void 0&&(r=0),e%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(e/8>t.length-r)throw new Error("readUintBE: array is too short for the given bitLength");for(var n=0,i=1,s=e/8+r-1;s>=r;s--)n+=t[s]*i,i*=256;return n}te.readUintBE=Bf;function Kf(e,t,r){if(r===void 0&&(r=0),e%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(e/8>t.length-r)throw new Error("readUintLE: array is too short for the given bitLength");for(var n=0,i=1,s=r;s<r+e/8;s++)n+=t[s]*i,i*=256;return n}te.readUintLE=Kf;function qf(e,t,r,n){if(r===void 0&&(r=new Uint8Array(e/8)),n===void 0&&(n=0),e%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!Rs.isSafeInteger(t))throw new Error("writeUintBE value must be an integer");for(var i=1,s=e/8+n-1;s>=n;s--)r[s]=t/i&255,i*=256;return r}te.writeUintBE=qf;function Hf(e,t,r,n){if(r===void 0&&(r=new Uint8Array(e/8)),n===void 0&&(n=0),e%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!Rs.isSafeInteger(t))throw new Error("writeUintLE value must be an integer");for(var i=1,s=n;s<n+e/8;s++)r[s]=t/i&255,i*=256;return r}te.writeUintLE=Hf;function Vf(e,t){t===void 0&&(t=0);var r=new DataView(e.buffer,e.byteOffset,e.byteLength);return r.getFloat32(t)}te.readFloat32BE=Vf;function Gf(e,t){t===void 0&&(t=0);var r=new DataView(e.buffer,e.byteOffset,e.byteLength);return r.getFloat32(t,!0)}te.readFloat32LE=Gf;function Wf(e,t){t===void 0&&(t=0);var r=new DataView(e.buffer,e.byteOffset,e.byteLength);return r.getFloat64(t)}te.readFloat64BE=Wf;function Yf(e,t){t===void 0&&(t=0);var r=new DataView(e.buffer,e.byteOffset,e.byteLength);return r.getFloat64(t,!0)}te.readFloat64LE=Yf;function kf(e,t,r){t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0);var n=new DataView(t.buffer,t.byteOffset,t.byteLength);return n.setFloat32(r,e),t}te.writeFloat32BE=kf;function Xf(e,t,r){t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0);var n=new DataView(t.buffer,t.byteOffset,t.byteLength);return n.setFloat32(r,e,!0),t}te.writeFloat32LE=Xf;function Jf(e,t,r){t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0);var n=new DataView(t.buffer,t.byteOffset,t.byteLength);return n.setFloat64(r,e),t}te.writeFloat64BE=Jf;function Zf(e,t,r){t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0);var n=new DataView(t.buffer,t.byteOffset,t.byteLength);return n.setFloat64(r,e,!0),t}te.writeFloat64LE=Zf,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.randomStringForEntropy=e.randomString=e.randomUint32=e.randomBytes=e.defaultRandomSource=void 0;const t=Yr,r=te,n=dt;e.defaultRandomSource=new t.SystemRandomSource;function i(f,l=e.defaultRandomSource){return l.randomBytes(f)}e.randomBytes=i;function s(f=e.defaultRandomSource){const l=i(4,f),m=(0,r.readUint32LE)(l);return(0,n.wipe)(l),m}e.randomUint32=s;const o="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function c(f,l=o,m=e.defaultRandomSource){if(l.length<2)throw new Error("randomString charset is too short");if(l.length>256)throw new Error("randomString charset is too long");let b="";const w=l.length,D=256-256%w;for(;f>0;){const P=i(Math.ceil(f*256/D),m);for(let R=0;R<P.length&&f>0;R++){const $=P[R];$<D&&(b+=l.charAt($%w),f--)}(0,n.wipe)(P)}return b}e.randomString=c;function h(f,l=o,m=e.defaultRandomSource){const b=Math.ceil(f/(Math.log(l.length)/Math.LN2));return c(b,l,m)}e.randomStringForEntropy=h}(ar);var Us={};(function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=te,r=dt;e.DIGEST_LENGTH=64,e.BLOCK_SIZE=128;var n=function(){function c(){this.digestLength=e.DIGEST_LENGTH,this.blockSize=e.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return c.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},c.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},c.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},c.prototype.update=function(h,f){if(f===void 0&&(f=h.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var l=0;if(this._bytesHashed+=f,this._bufferLength>0){for(;this._bufferLength<e.BLOCK_SIZE&&f>0;)this._buffer[this._bufferLength++]=h[l++],f--;this._bufferLength===this.blockSize&&(s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(f>=this.blockSize&&(l=s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,h,l,f),f%=this.blockSize);f>0;)this._buffer[this._bufferLength++]=h[l++],f--;return this},c.prototype.finish=function(h){if(!this._finished){var f=this._bytesHashed,l=this._bufferLength,m=f/536870912|0,b=f<<3,w=f%128<112?128:256;this._buffer[l]=128;for(var D=l+1;D<w-8;D++)this._buffer[D]=0;t.writeUint32BE(m,this._buffer,w-8),t.writeUint32BE(b,this._buffer,w-4),s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,w),this._finished=!0}for(var D=0;D<this.digestLength/8;D++)t.writeUint32BE(this._stateHi[D],h,D*8),t.writeUint32BE(this._stateLo[D],h,D*8+4);return this},c.prototype.digest=function(){var h=new Uint8Array(this.digestLength);return this.finish(h),h},c.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},c.prototype.restoreState=function(h){return this._stateHi.set(h.stateHi),this._stateLo.set(h.stateLo),this._bufferLength=h.bufferLength,h.buffer&&this._buffer.set(h.buffer),this._bytesHashed=h.bytesHashed,this._finished=!1,this},c.prototype.cleanSavedState=function(h){r.wipe(h.stateHi),r.wipe(h.stateLo),h.buffer&&r.wipe(h.buffer),h.bufferLength=0,h.bytesHashed=0},c}();e.SHA512=n;var i=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function s(c,h,f,l,m,b,w){for(var D=f[0],P=f[1],R=f[2],$=f[3],E=f[4],O=f[5],g=f[6],v=f[7],y=l[0],a=l[1],p=l[2],L=l[3],z=l[4],k=l[5],X=l[6],J=l[7],A,N,W,j,F,U,M,B;w>=128;){for(var ne=0;ne<16;ne++){var K=8*ne+b;c[ne]=t.readUint32BE(m,K),h[ne]=t.readUint32BE(m,K+4)}for(var ne=0;ne<80;ne++){var Q=D,Y=P,ae=R,T=$,I=E,S=O,u=g,_=v,q=y,V=a,he=p,ye=L,de=z,ve=k,Ue=X,Re=J;if(A=v,N=J,F=N&65535,U=N>>>16,M=A&65535,B=A>>>16,A=(E>>>14|z<<32-14)^(E>>>18|z<<32-18)^(z>>>41-32|E<<32-(41-32)),N=(z>>>14|E<<32-14)^(z>>>18|E<<32-18)^(E>>>41-32|z<<32-(41-32)),F+=N&65535,U+=N>>>16,M+=A&65535,B+=A>>>16,A=E&O^~E&g,N=z&k^~z&X,F+=N&65535,U+=N>>>16,M+=A&65535,B+=A>>>16,A=i[ne*2],N=i[ne*2+1],F+=N&65535,U+=N>>>16,M+=A&65535,B+=A>>>16,A=c[ne%16],N=h[ne%16],F+=N&65535,U+=N>>>16,M+=A&65535,B+=A>>>16,U+=F>>>16,M+=U>>>16,B+=M>>>16,W=M&65535|B<<16,j=F&65535|U<<16,A=W,N=j,F=N&65535,U=N>>>16,M=A&65535,B=A>>>16,A=(D>>>28|y<<32-28)^(y>>>34-32|D<<32-(34-32))^(y>>>39-32|D<<32-(39-32)),N=(y>>>28|D<<32-28)^(D>>>34-32|y<<32-(34-32))^(D>>>39-32|y<<32-(39-32)),F+=N&65535,U+=N>>>16,M+=A&65535,B+=A>>>16,A=D&P^D&R^P&R,N=y&a^y&p^a&p,F+=N&65535,U+=N>>>16,M+=A&65535,B+=A>>>16,U+=F>>>16,M+=U>>>16,B+=M>>>16,_=M&65535|B<<16,Re=F&65535|U<<16,A=T,N=ye,F=N&65535,U=N>>>16,M=A&65535,B=A>>>16,A=W,N=j,F+=N&65535,U+=N>>>16,M+=A&65535,B+=A>>>16,U+=F>>>16,M+=U>>>16,B+=M>>>16,T=M&65535|B<<16,ye=F&65535|U<<16,P=Q,R=Y,$=ae,E=T,O=I,g=S,v=u,D=_,a=q,p=V,L=he,z=ye,k=de,X=ve,J=Ue,y=Re,ne%16===15)for(var K=0;K<16;K++)A=c[K],N=h[K],F=N&65535,U=N>>>16,M=A&65535,B=A>>>16,A=c[(K+9)%16],N=h[(K+9)%16],F+=N&65535,U+=N>>>16,M+=A&65535,B+=A>>>16,W=c[(K+1)%16],j=h[(K+1)%16],A=(W>>>1|j<<32-1)^(W>>>8|j<<32-8)^W>>>7,N=(j>>>1|W<<32-1)^(j>>>8|W<<32-8)^(j>>>7|W<<32-7),F+=N&65535,U+=N>>>16,M+=A&65535,B+=A>>>16,W=c[(K+14)%16],j=h[(K+14)%16],A=(W>>>19|j<<32-19)^(j>>>61-32|W<<32-(61-32))^W>>>6,N=(j>>>19|W<<32-19)^(W>>>61-32|j<<32-(61-32))^(j>>>6|W<<32-6),F+=N&65535,U+=N>>>16,M+=A&65535,B+=A>>>16,U+=F>>>16,M+=U>>>16,B+=M>>>16,c[K]=M&65535|B<<16,h[K]=F&65535|U<<16}A=D,N=y,F=N&65535,U=N>>>16,M=A&65535,B=A>>>16,A=f[0],N=l[0],F+=N&65535,U+=N>>>16,M+=A&65535,B+=A>>>16,U+=F>>>16,M+=U>>>16,B+=M>>>16,f[0]=D=M&65535|B<<16,l[0]=y=F&65535|U<<16,A=P,N=a,F=N&65535,U=N>>>16,M=A&65535,B=A>>>16,A=f[1],N=l[1],F+=N&65535,U+=N>>>16,M+=A&65535,B+=A>>>16,U+=F>>>16,M+=U>>>16,B+=M>>>16,f[1]=P=M&65535|B<<16,l[1]=a=F&65535|U<<16,A=R,N=p,F=N&65535,U=N>>>16,M=A&65535,B=A>>>16,A=f[2],N=l[2],F+=N&65535,U+=N>>>16,M+=A&65535,B+=A>>>16,U+=F>>>16,M+=U>>>16,B+=M>>>16,f[2]=R=M&65535|B<<16,l[2]=p=F&65535|U<<16,A=$,N=L,F=N&65535,U=N>>>16,M=A&65535,B=A>>>16,A=f[3],N=l[3],F+=N&65535,U+=N>>>16,M+=A&65535,B+=A>>>16,U+=F>>>16,M+=U>>>16,B+=M>>>16,f[3]=$=M&65535|B<<16,l[3]=L=F&65535|U<<16,A=E,N=z,F=N&65535,U=N>>>16,M=A&65535,B=A>>>16,A=f[4],N=l[4],F+=N&65535,U+=N>>>16,M+=A&65535,B+=A>>>16,U+=F>>>16,M+=U>>>16,B+=M>>>16,f[4]=E=M&65535|B<<16,l[4]=z=F&65535|U<<16,A=O,N=k,F=N&65535,U=N>>>16,M=A&65535,B=A>>>16,A=f[5],N=l[5],F+=N&65535,U+=N>>>16,M+=A&65535,B+=A>>>16,U+=F>>>16,M+=U>>>16,B+=M>>>16,f[5]=O=M&65535|B<<16,l[5]=k=F&65535|U<<16,A=g,N=X,F=N&65535,U=N>>>16,M=A&65535,B=A>>>16,A=f[6],N=l[6],F+=N&65535,U+=N>>>16,M+=A&65535,B+=A>>>16,U+=F>>>16,M+=U>>>16,B+=M>>>16,f[6]=g=M&65535|B<<16,l[6]=X=F&65535|U<<16,A=v,N=J,F=N&65535,U=N>>>16,M=A&65535,B=A>>>16,A=f[7],N=l[7],F+=N&65535,U+=N>>>16,M+=A&65535,B+=A>>>16,U+=F>>>16,M+=U>>>16,B+=M>>>16,f[7]=v=M&65535|B<<16,l[7]=J=F&65535|U<<16,b+=128,w-=128}return b}function o(c){var h=new n;h.update(c);var f=h.digest();return h.clean(),f}e.hash=o})(Us),function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.convertSecretKeyToX25519=e.convertPublicKeyToX25519=e.verify=e.sign=e.extractPublicKeyFromSecretKey=e.generateKeyPair=e.generateKeyPairFromSeed=e.SEED_LENGTH=e.SECRET_KEY_LENGTH=e.PUBLIC_KEY_LENGTH=e.SIGNATURE_LENGTH=void 0;const t=ar,r=Us,n=dt;e.SIGNATURE_LENGTH=64,e.PUBLIC_KEY_LENGTH=32,e.SECRET_KEY_LENGTH=64,e.SEED_LENGTH=32;function i(T){const I=new Float64Array(16);if(T)for(let S=0;S<T.length;S++)I[S]=T[S];return I}const s=new Uint8Array(32);s[0]=9;const o=i(),c=i([1]),h=i([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),f=i([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),l=i([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),m=i([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),b=i([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function w(T,I){for(let S=0;S<16;S++)T[S]=I[S]|0}function D(T){let I=1;for(let S=0;S<16;S++){let u=T[S]+I+65535;I=Math.floor(u/65536),T[S]=u-I*65536}T[0]+=I-1+37*(I-1)}function P(T,I,S){const u=~(S-1);for(let _=0;_<16;_++){const q=u&(T[_]^I[_]);T[_]^=q,I[_]^=q}}function R(T,I){const S=i(),u=i();for(let _=0;_<16;_++)u[_]=I[_];D(u),D(u),D(u);for(let _=0;_<2;_++){S[0]=u[0]-65517;for(let V=1;V<15;V++)S[V]=u[V]-65535-(S[V-1]>>16&1),S[V-1]&=65535;S[15]=u[15]-32767-(S[14]>>16&1);const q=S[15]>>16&1;S[14]&=65535,P(u,S,1-q)}for(let _=0;_<16;_++)T[2*_]=u[_]&255,T[2*_+1]=u[_]>>8}function $(T,I){let S=0;for(let u=0;u<32;u++)S|=T[u]^I[u];return(1&S-1>>>8)-1}function E(T,I){const S=new Uint8Array(32),u=new Uint8Array(32);return R(S,T),R(u,I),$(S,u)}function O(T){const I=new Uint8Array(32);return R(I,T),I[0]&1}function g(T,I){for(let S=0;S<16;S++)T[S]=I[2*S]+(I[2*S+1]<<8);T[15]&=32767}function v(T,I,S){for(let u=0;u<16;u++)T[u]=I[u]+S[u]}function y(T,I,S){for(let u=0;u<16;u++)T[u]=I[u]-S[u]}function a(T,I,S){let u,_,q=0,V=0,he=0,ye=0,de=0,ve=0,Ue=0,Re=0,_e=0,pe=0,le=0,ue=0,ce=0,oe=0,se=0,ee=0,fe=0,ge=0,re=0,be=0,we=0,Ee=0,De=0,me=0,mt=0,Tt=0,jt=0,pt=0,Zt=0,$r=0,_n=0,$e=S[0],Pe=S[1],Me=S[2],je=S[3],ze=S[4],Ce=S[5],He=S[6],Ve=S[7],Ge=S[8],We=S[9],Ye=S[10],Ke=S[11],Be=S[12],Ne=S[13],ke=S[14],Xe=S[15];u=I[0],q+=u*$e,V+=u*Pe,he+=u*Me,ye+=u*je,de+=u*ze,ve+=u*Ce,Ue+=u*He,Re+=u*Ve,_e+=u*Ge,pe+=u*We,le+=u*Ye,ue+=u*Ke,ce+=u*Be,oe+=u*Ne,se+=u*ke,ee+=u*Xe,u=I[1],V+=u*$e,he+=u*Pe,ye+=u*Me,de+=u*je,ve+=u*ze,Ue+=u*Ce,Re+=u*He,_e+=u*Ve,pe+=u*Ge,le+=u*We,ue+=u*Ye,ce+=u*Ke,oe+=u*Be,se+=u*Ne,ee+=u*ke,fe+=u*Xe,u=I[2],he+=u*$e,ye+=u*Pe,de+=u*Me,ve+=u*je,Ue+=u*ze,Re+=u*Ce,_e+=u*He,pe+=u*Ve,le+=u*Ge,ue+=u*We,ce+=u*Ye,oe+=u*Ke,se+=u*Be,ee+=u*Ne,fe+=u*ke,ge+=u*Xe,u=I[3],ye+=u*$e,de+=u*Pe,ve+=u*Me,Ue+=u*je,Re+=u*ze,_e+=u*Ce,pe+=u*He,le+=u*Ve,ue+=u*Ge,ce+=u*We,oe+=u*Ye,se+=u*Ke,ee+=u*Be,fe+=u*Ne,ge+=u*ke,re+=u*Xe,u=I[4],de+=u*$e,ve+=u*Pe,Ue+=u*Me,Re+=u*je,_e+=u*ze,pe+=u*Ce,le+=u*He,ue+=u*Ve,ce+=u*Ge,oe+=u*We,se+=u*Ye,ee+=u*Ke,fe+=u*Be,ge+=u*Ne,re+=u*ke,be+=u*Xe,u=I[5],ve+=u*$e,Ue+=u*Pe,Re+=u*Me,_e+=u*je,pe+=u*ze,le+=u*Ce,ue+=u*He,ce+=u*Ve,oe+=u*Ge,se+=u*We,ee+=u*Ye,fe+=u*Ke,ge+=u*Be,re+=u*Ne,be+=u*ke,we+=u*Xe,u=I[6],Ue+=u*$e,Re+=u*Pe,_e+=u*Me,pe+=u*je,le+=u*ze,ue+=u*Ce,ce+=u*He,oe+=u*Ve,se+=u*Ge,ee+=u*We,fe+=u*Ye,ge+=u*Ke,re+=u*Be,be+=u*Ne,we+=u*ke,Ee+=u*Xe,u=I[7],Re+=u*$e,_e+=u*Pe,pe+=u*Me,le+=u*je,ue+=u*ze,ce+=u*Ce,oe+=u*He,se+=u*Ve,ee+=u*Ge,fe+=u*We,ge+=u*Ye,re+=u*Ke,be+=u*Be,we+=u*Ne,Ee+=u*ke,De+=u*Xe,u=I[8],_e+=u*$e,pe+=u*Pe,le+=u*Me,ue+=u*je,ce+=u*ze,oe+=u*Ce,se+=u*He,ee+=u*Ve,fe+=u*Ge,ge+=u*We,re+=u*Ye,be+=u*Ke,we+=u*Be,Ee+=u*Ne,De+=u*ke,me+=u*Xe,u=I[9],pe+=u*$e,le+=u*Pe,ue+=u*Me,ce+=u*je,oe+=u*ze,se+=u*Ce,ee+=u*He,fe+=u*Ve,ge+=u*Ge,re+=u*We,be+=u*Ye,we+=u*Ke,Ee+=u*Be,De+=u*Ne,me+=u*ke,mt+=u*Xe,u=I[10],le+=u*$e,ue+=u*Pe,ce+=u*Me,oe+=u*je,se+=u*ze,ee+=u*Ce,fe+=u*He,ge+=u*Ve,re+=u*Ge,be+=u*We,we+=u*Ye,Ee+=u*Ke,De+=u*Be,me+=u*Ne,mt+=u*ke,Tt+=u*Xe,u=I[11],ue+=u*$e,ce+=u*Pe,oe+=u*Me,se+=u*je,ee+=u*ze,fe+=u*Ce,ge+=u*He,re+=u*Ve,be+=u*Ge,we+=u*We,Ee+=u*Ye,De+=u*Ke,me+=u*Be,mt+=u*Ne,Tt+=u*ke,jt+=u*Xe,u=I[12],ce+=u*$e,oe+=u*Pe,se+=u*Me,ee+=u*je,fe+=u*ze,ge+=u*Ce,re+=u*He,be+=u*Ve,we+=u*Ge,Ee+=u*We,De+=u*Ye,me+=u*Ke,mt+=u*Be,Tt+=u*Ne,jt+=u*ke,pt+=u*Xe,u=I[13],oe+=u*$e,se+=u*Pe,ee+=u*Me,fe+=u*je,ge+=u*ze,re+=u*Ce,be+=u*He,we+=u*Ve,Ee+=u*Ge,De+=u*We,me+=u*Ye,mt+=u*Ke,Tt+=u*Be,jt+=u*Ne,pt+=u*ke,Zt+=u*Xe,u=I[14],se+=u*$e,ee+=u*Pe,fe+=u*Me,ge+=u*je,re+=u*ze,be+=u*Ce,we+=u*He,Ee+=u*Ve,De+=u*Ge,me+=u*We,mt+=u*Ye,Tt+=u*Ke,jt+=u*Be,pt+=u*Ne,Zt+=u*ke,$r+=u*Xe,u=I[15],ee+=u*$e,fe+=u*Pe,ge+=u*Me,re+=u*je,be+=u*ze,we+=u*Ce,Ee+=u*He,De+=u*Ve,me+=u*Ge,mt+=u*We,Tt+=u*Ye,jt+=u*Ke,pt+=u*Be,Zt+=u*Ne,$r+=u*ke,_n+=u*Xe,q+=38*fe,V+=38*ge,he+=38*re,ye+=38*be,de+=38*we,ve+=38*Ee,Ue+=38*De,Re+=38*me,_e+=38*mt,pe+=38*Tt,le+=38*jt,ue+=38*pt,ce+=38*Zt,oe+=38*$r,se+=38*_n,_=1,u=q+_+65535,_=Math.floor(u/65536),q=u-_*65536,u=V+_+65535,_=Math.floor(u/65536),V=u-_*65536,u=he+_+65535,_=Math.floor(u/65536),he=u-_*65536,u=ye+_+65535,_=Math.floor(u/65536),ye=u-_*65536,u=de+_+65535,_=Math.floor(u/65536),de=u-_*65536,u=ve+_+65535,_=Math.floor(u/65536),ve=u-_*65536,u=Ue+_+65535,_=Math.floor(u/65536),Ue=u-_*65536,u=Re+_+65535,_=Math.floor(u/65536),Re=u-_*65536,u=_e+_+65535,_=Math.floor(u/65536),_e=u-_*65536,u=pe+_+65535,_=Math.floor(u/65536),pe=u-_*65536,u=le+_+65535,_=Math.floor(u/65536),le=u-_*65536,u=ue+_+65535,_=Math.floor(u/65536),ue=u-_*65536,u=ce+_+65535,_=Math.floor(u/65536),ce=u-_*65536,u=oe+_+65535,_=Math.floor(u/65536),oe=u-_*65536,u=se+_+65535,_=Math.floor(u/65536),se=u-_*65536,u=ee+_+65535,_=Math.floor(u/65536),ee=u-_*65536,q+=_-1+37*(_-1),_=1,u=q+_+65535,_=Math.floor(u/65536),q=u-_*65536,u=V+_+65535,_=Math.floor(u/65536),V=u-_*65536,u=he+_+65535,_=Math.floor(u/65536),he=u-_*65536,u=ye+_+65535,_=Math.floor(u/65536),ye=u-_*65536,u=de+_+65535,_=Math.floor(u/65536),de=u-_*65536,u=ve+_+65535,_=Math.floor(u/65536),ve=u-_*65536,u=Ue+_+65535,_=Math.floor(u/65536),Ue=u-_*65536,u=Re+_+65535,_=Math.floor(u/65536),Re=u-_*65536,u=_e+_+65535,_=Math.floor(u/65536),_e=u-_*65536,u=pe+_+65535,_=Math.floor(u/65536),pe=u-_*65536,u=le+_+65535,_=Math.floor(u/65536),le=u-_*65536,u=ue+_+65535,_=Math.floor(u/65536),ue=u-_*65536,u=ce+_+65535,_=Math.floor(u/65536),ce=u-_*65536,u=oe+_+65535,_=Math.floor(u/65536),oe=u-_*65536,u=se+_+65535,_=Math.floor(u/65536),se=u-_*65536,u=ee+_+65535,_=Math.floor(u/65536),ee=u-_*65536,q+=_-1+37*(_-1),T[0]=q,T[1]=V,T[2]=he,T[3]=ye,T[4]=de,T[5]=ve,T[6]=Ue,T[7]=Re,T[8]=_e,T[9]=pe,T[10]=le,T[11]=ue,T[12]=ce,T[13]=oe,T[14]=se,T[15]=ee}function p(T,I){a(T,I,I)}function L(T,I){const S=i();let u;for(u=0;u<16;u++)S[u]=I[u];for(u=253;u>=0;u--)p(S,S),u!==2&&u!==4&&a(S,S,I);for(u=0;u<16;u++)T[u]=S[u]}function z(T,I){const S=i();let u;for(u=0;u<16;u++)S[u]=I[u];for(u=250;u>=0;u--)p(S,S),u!==1&&a(S,S,I);for(u=0;u<16;u++)T[u]=S[u]}function k(T,I){const S=i(),u=i(),_=i(),q=i(),V=i(),he=i(),ye=i(),de=i(),ve=i();y(S,T[1],T[0]),y(ve,I[1],I[0]),a(S,S,ve),v(u,T[0],T[1]),v(ve,I[0],I[1]),a(u,u,ve),a(_,T[3],I[3]),a(_,_,f),a(q,T[2],I[2]),v(q,q,q),y(V,u,S),y(he,q,_),v(ye,q,_),v(de,u,S),a(T[0],V,he),a(T[1],de,ye),a(T[2],ye,he),a(T[3],V,de)}function X(T,I,S){for(let u=0;u<4;u++)P(T[u],I[u],S)}function J(T,I){const S=i(),u=i(),_=i();L(_,I[2]),a(S,I[0],_),a(u,I[1],_),R(T,u),T[31]^=O(S)<<7}function A(T,I,S){w(T[0],o),w(T[1],c),w(T[2],c),w(T[3],o);for(let u=255;u>=0;--u){const _=S[u/8|0]>>(u&7)&1;X(T,I,_),k(I,T),k(T,T),X(T,I,_)}}function N(T,I){const S=[i(),i(),i(),i()];w(S[0],l),w(S[1],m),w(S[2],c),a(S[3],l,m),A(T,S,I)}function W(T){if(T.length!==e.SEED_LENGTH)throw new Error(`ed25519: seed must be ${e.SEED_LENGTH} bytes`);const I=(0,r.hash)(T);I[0]&=248,I[31]&=127,I[31]|=64;const S=new Uint8Array(32),u=[i(),i(),i(),i()];N(u,I),J(S,u);const _=new Uint8Array(64);return _.set(T),_.set(S,32),{publicKey:S,secretKey:_}}e.generateKeyPairFromSeed=W;function j(T){const I=(0,t.randomBytes)(32,T),S=W(I);return(0,n.wipe)(I),S}e.generateKeyPair=j;function F(T){if(T.length!==e.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${e.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(T.subarray(32))}e.extractPublicKeyFromSecretKey=F;const U=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function M(T,I){let S,u,_,q;for(u=63;u>=32;--u){for(S=0,_=u-32,q=u-12;_<q;++_)I[_]+=S-16*I[u]*U[_-(u-32)],S=Math.floor((I[_]+128)/256),I[_]-=S*256;I[_]+=S,I[u]=0}for(S=0,_=0;_<32;_++)I[_]+=S-(I[31]>>4)*U[_],S=I[_]>>8,I[_]&=255;for(_=0;_<32;_++)I[_]-=S*U[_];for(u=0;u<32;u++)I[u+1]+=I[u]>>8,T[u]=I[u]&255}function B(T){const I=new Float64Array(64);for(let S=0;S<64;S++)I[S]=T[S];for(let S=0;S<64;S++)T[S]=0;M(T,I)}function ne(T,I){const S=new Float64Array(64),u=[i(),i(),i(),i()],_=(0,r.hash)(T.subarray(0,32));_[0]&=248,_[31]&=127,_[31]|=64;const q=new Uint8Array(64);q.set(_.subarray(32),32);const V=new r.SHA512;V.update(q.subarray(32)),V.update(I);const he=V.digest();V.clean(),B(he),N(u,he),J(q,u),V.reset(),V.update(q.subarray(0,32)),V.update(T.subarray(32)),V.update(I);const ye=V.digest();B(ye);for(let de=0;de<32;de++)S[de]=he[de];for(let de=0;de<32;de++)for(let ve=0;ve<32;ve++)S[de+ve]+=ye[de]*_[ve];return M(q.subarray(32),S),q}e.sign=ne;function K(T,I){const S=i(),u=i(),_=i(),q=i(),V=i(),he=i(),ye=i();return w(T[2],c),g(T[1],I),p(_,T[1]),a(q,_,h),y(_,_,T[2]),v(q,T[2],q),p(V,q),p(he,V),a(ye,he,V),a(S,ye,_),a(S,S,q),z(S,S),a(S,S,_),a(S,S,q),a(S,S,q),a(T[0],S,q),p(u,T[0]),a(u,u,q),E(u,_)&&a(T[0],T[0],b),p(u,T[0]),a(u,u,q),E(u,_)?-1:(O(T[0])===I[31]>>7&&y(T[0],o,T[0]),a(T[3],T[0],T[1]),0)}function Q(T,I,S){const u=new Uint8Array(32),_=[i(),i(),i(),i()],q=[i(),i(),i(),i()];if(S.length!==e.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${e.SIGNATURE_LENGTH} bytes`);if(K(q,T))return!1;const V=new r.SHA512;V.update(S.subarray(0,32)),V.update(T),V.update(I);const he=V.digest();return B(he),A(_,q,he),N(q,S.subarray(32)),k(_,q),J(u,_),!$(S,u)}e.verify=Q;function Y(T){let I=[i(),i(),i(),i()];if(K(I,T))throw new Error("Ed25519: invalid public key");let S=i(),u=i(),_=I[1];v(S,c,_),y(u,c,_),L(u,u),a(S,S,u);let q=new Uint8Array(32);return R(q,S),q}e.convertPublicKeyToX25519=Y;function ae(T){const I=(0,r.hash)(T.subarray(0,32));I[0]&=248,I[31]&=127,I[31]|=64;const S=new Uint8Array(I.subarray(0,32));return(0,n.wipe)(I),S}e.convertSecretKeyToX25519=ae}(Vn);const Qf="EdDSA",eh="JWT",$s=".",Ms="base64url",th="utf8",rh="utf8",nh=":",ih="did",sh="key",js="base58btc",oh="z",ah="K36",ch=32;function zs(e=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(e):new Uint8Array(e)}function Xn(e,t){t||(t=e.reduce((i,s)=>i+s.length,0));const r=zs(t);let n=0;for(const i of e)r.set(i,n),n+=i.length;return r}function uh(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var s=e.charAt(i),o=s.charCodeAt(0);if(r[o]!==255)throw new TypeError(s+" is ambiguous");r[o]=i}var c=e.length,h=e.charAt(0),f=Math.log(c)/Math.log(256),l=Math.log(256)/Math.log(c);function m(D){if(D instanceof Uint8Array||(ArrayBuffer.isView(D)?D=new Uint8Array(D.buffer,D.byteOffset,D.byteLength):Array.isArray(D)&&(D=Uint8Array.from(D))),!(D instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(D.length===0)return"";for(var P=0,R=0,$=0,E=D.length;$!==E&&D[$]===0;)$++,P++;for(var O=(E-$)*l+1>>>0,g=new Uint8Array(O);$!==E;){for(var v=D[$],y=0,a=O-1;(v!==0||y<R)&&a!==-1;a--,y++)v+=256*g[a]>>>0,g[a]=v%c>>>0,v=v/c>>>0;if(v!==0)throw new Error("Non-zero carry");R=y,$++}for(var p=O-R;p!==O&&g[p]===0;)p++;for(var L=h.repeat(P);p<O;++p)L+=e.charAt(g[p]);return L}function b(D){if(typeof D!="string")throw new TypeError("Expected String");if(D.length===0)return new Uint8Array;var P=0;if(D[P]!==" "){for(var R=0,$=0;D[P]===h;)R++,P++;for(var E=(D.length-P)*f+1>>>0,O=new Uint8Array(E);D[P];){var g=r[D.charCodeAt(P)];if(g===255)return;for(var v=0,y=E-1;(g!==0||v<$)&&y!==-1;y--,v++)g+=c*O[y]>>>0,O[y]=g%256>>>0,g=g/256>>>0;if(g!==0)throw new Error("Non-zero carry");$=v,P++}if(D[P]!==" "){for(var a=E-$;a!==E&&O[a]===0;)a++;for(var p=new Uint8Array(R+(E-a)),L=R;a!==E;)p[L++]=O[a++];return p}}}function w(D){var P=b(D);if(P)return P;throw new Error(`Non-${t} character`)}return{encode:m,decodeUnsafe:b,decode:w}}var fh=uh,hh=fh;const Bs=e=>{if(e instanceof Uint8Array&&e.constructor.name==="Uint8Array")return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},lh=e=>new TextEncoder().encode(e),dh=e=>new TextDecoder().decode(e);class ph{constructor(t,r,n){this.name=t,this.prefix=r,this.baseEncode=n}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class gh{constructor(t,r,n){if(this.name=t,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return Ks(this,t)}}class _h{constructor(t){this.decoders=t}or(t){return Ks(this,t)}decode(t){const r=t[0],n=this.decoders[r];if(n)return n.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Ks=(e,t)=>new _h({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class yh{constructor(t,r,n,i){this.name=t,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new ph(t,r,n),this.decoder=new gh(t,r,i)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const Qr=({name:e,prefix:t,encode:r,decode:n})=>new yh(e,t,r,n),Or=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:i}=hh(r,t);return Qr({prefix:e,name:t,encode:n,decode:s=>Bs(i(s))})},bh=(e,t,r,n)=>{const i={};for(let l=0;l<t.length;++l)i[t[l]]=l;let s=e.length;for(;e[s-1]==="=";)--s;const o=new Uint8Array(s*r/8|0);let c=0,h=0,f=0;for(let l=0;l<s;++l){const m=i[e[l]];if(m===void 0)throw new SyntaxError(`Non-${n} character`);h=h<<r|m,c+=r,c>=8&&(c-=8,o[f++]=255&h>>c)}if(c>=r||255&h<<8-c)throw new SyntaxError("Unexpected end of data");return o},wh=(e,t,r)=>{const n=t[t.length-1]==="=",i=(1<<r)-1;let s="",o=0,c=0;for(let h=0;h<e.length;++h)for(c=c<<8|e[h],o+=8;o>r;)o-=r,s+=t[i&c>>o];if(o&&(s+=t[i&c<<r-o]),n)for(;s.length*r&7;)s+="=";return s},Qe=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>Qr({prefix:t,name:e,encode(i){return wh(i,n,r)},decode(i){return bh(i,n,r,e)}}),vh=Qr({prefix:"\0",name:"identity",encode:e=>dh(e),decode:e=>lh(e)});var mh=Object.freeze({__proto__:null,identity:vh});const Eh=Qe({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Dh=Object.freeze({__proto__:null,base2:Eh});const Sh=Qe({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var xh=Object.freeze({__proto__:null,base8:Sh});const Oh=Or({prefix:"9",name:"base10",alphabet:"0123456789"});var Ih=Object.freeze({__proto__:null,base10:Oh});const Th=Qe({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Nh=Qe({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Ah=Object.freeze({__proto__:null,base16:Th,base16upper:Nh});const Rh=Qe({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Ph=Qe({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Ch=Qe({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Fh=Qe({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Lh=Qe({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Uh=Qe({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),$h=Qe({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Mh=Qe({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),jh=Qe({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var zh=Object.freeze({__proto__:null,base32:Rh,base32upper:Ph,base32pad:Ch,base32padupper:Fh,base32hex:Lh,base32hexupper:Uh,base32hexpad:$h,base32hexpadupper:Mh,base32z:jh});const Bh=Or({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Kh=Or({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var qh=Object.freeze({__proto__:null,base36:Bh,base36upper:Kh});const Hh=Or({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Vh=Or({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Gh=Object.freeze({__proto__:null,base58btc:Hh,base58flickr:Vh});const Wh=Qe({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Yh=Qe({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),kh=Qe({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Xh=Qe({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Jh=Object.freeze({__proto__:null,base64:Wh,base64pad:Yh,base64url:kh,base64urlpad:Xh});const qs=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Zh=qs.reduce((e,t,r)=>(e[r]=t,e),[]),Qh=qs.reduce((e,t,r)=>(e[t.codePointAt(0)]=r,e),[]);function el(e){return e.reduce((t,r)=>(t+=Zh[r],t),"")}function tl(e){const t=[];for(const r of e){const n=Qh[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);t.push(n)}return new Uint8Array(t)}const rl=Qr({prefix:"\u{1F680}",name:"base256emoji",encode:el,decode:tl});var nl=Object.freeze({__proto__:null,base256emoji:rl}),il=Vs,Hs=128,sl=127,ol=~sl,al=Math.pow(2,31);function Vs(e,t,r){t=t||[],r=r||0;for(var n=r;e>=al;)t[r++]=e&255|Hs,e/=128;for(;e&ol;)t[r++]=e&255|Hs,e>>>=7;return t[r]=e|0,Vs.bytes=r-n+1,t}var cl=Jn,ul=128,Gs=127;function Jn(e,n){var r=0,n=n||0,i=0,s=n,o,c=e.length;do{if(s>=c)throw Jn.bytes=0,new RangeError("Could not decode varint");o=e[s++],r+=i<28?(o&Gs)<<i:(o&Gs)*Math.pow(2,i),i+=7}while(o>=ul);return Jn.bytes=s-n,r}var fl=Math.pow(2,7),hl=Math.pow(2,14),ll=Math.pow(2,21),dl=Math.pow(2,28),pl=Math.pow(2,35),gl=Math.pow(2,42),_l=Math.pow(2,49),yl=Math.pow(2,56),bl=Math.pow(2,63),wl=function(e){return e<fl?1:e<hl?2:e<ll?3:e<dl?4:e<pl?5:e<gl?6:e<_l?7:e<yl?8:e<bl?9:10},vl={encode:il,decode:cl,encodingLength:wl},Ws=vl;const Ys=(e,t,r=0)=>(Ws.encode(e,t,r),t),ks=e=>Ws.encodingLength(e),Zn=(e,t)=>{const r=t.byteLength,n=ks(e),i=n+ks(r),s=new Uint8Array(i+r);return Ys(e,s,0),Ys(r,s,n),s.set(t,i),new ml(e,r,t,s)};class ml{constructor(t,r,n,i){this.code=t,this.size=r,this.digest=n,this.bytes=i}}const Xs=({name:e,code:t,encode:r})=>new El(e,t,r);class El{constructor(t,r,n){this.name=t,this.code=r,this.encode=n}digest(t){if(t instanceof Uint8Array){const r=this.encode(t);return r instanceof Uint8Array?Zn(this.code,r):r.then(n=>Zn(this.code,n))}else throw Error("Unknown type, must be binary type")}}const Js=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),Dl=Xs({name:"sha2-256",code:18,encode:Js("SHA-256")}),Sl=Xs({name:"sha2-512",code:19,encode:Js("SHA-512")});var xl=Object.freeze({__proto__:null,sha256:Dl,sha512:Sl});const Zs=0,Ol="identity",Qs=Bs;var Il=Object.freeze({__proto__:null,identity:{code:Zs,name:Ol,encode:Qs,digest:e=>Zn(Zs,Qs(e))}});new TextEncoder,new TextDecoder;const eo={...mh,...Dh,...xh,...Ih,...Ah,...zh,...qh,...Gh,...Jh,...nl};({...xl,...Il});function to(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const ro=to("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>new TextEncoder().encode(e.substring(1))),Qn=to("ascii","a",e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},e=>{e=e.substring(1);const t=zs(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}),no={utf8:ro,"utf-8":ro,hex:eo.base16,latin1:Qn,ascii:Qn,binary:Qn,...eo};function ut(e,t="utf8"){const r=no[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8"):r.encoder.encode(e).substring(1)}function ft(e,t="utf8"){const r=no[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(e,"utf8"):r.decoder.decode(`${r.prefix}${e}`)}function en(e){return ut(ft(Hn(e),th),Ms)}function io(e){const t=ft(ah,js),r=oh+ut(Xn([t,e]),js);return[ih,sh,r].join(nh)}function Tl(e){return ut(e,Ms)}function Nl(e){return ft([en(e.header),en(e.payload)].join($s),rh)}function Al(e){return[en(e.header),en(e.payload),Tl(e.signature)].join($s)}function so(e=ar.randomBytes(ch)){return Vn.generateKeyPairFromSeed(e)}async function Rl(e,t,r,n,i=Z.fromMiliseconds(Date.now())){const s={alg:Qf,typ:eh},o=io(n.publicKey),c=i+r,h={iss:o,sub:e,aud:t,iat:i,exp:c},f=Nl({header:s,payload:h}),l=Vn.sign(n.secretKey,f);return Al({header:s,payload:h,signature:l})}var ei={},tn={};Object.defineProperty(tn,"__esModule",{value:!0});var nt=te,ti=dt,Pl=20;function Cl(e,t,r){for(var n=1634760805,i=857760878,s=2036477234,o=1797285236,c=r[3]<<24|r[2]<<16|r[1]<<8|r[0],h=r[7]<<24|r[6]<<16|r[5]<<8|r[4],f=r[11]<<24|r[10]<<16|r[9]<<8|r[8],l=r[15]<<24|r[14]<<16|r[13]<<8|r[12],m=r[19]<<24|r[18]<<16|r[17]<<8|r[16],b=r[23]<<24|r[22]<<16|r[21]<<8|r[20],w=r[27]<<24|r[26]<<16|r[25]<<8|r[24],D=r[31]<<24|r[30]<<16|r[29]<<8|r[28],P=t[3]<<24|t[2]<<16|t[1]<<8|t[0],R=t[7]<<24|t[6]<<16|t[5]<<8|t[4],$=t[11]<<24|t[10]<<16|t[9]<<8|t[8],E=t[15]<<24|t[14]<<16|t[13]<<8|t[12],O=n,g=i,v=s,y=o,a=c,p=h,L=f,z=l,k=m,X=b,J=w,A=D,N=P,W=R,j=$,F=E,U=0;U<Pl;U+=2)O=O+a|0,N^=O,N=N>>>32-16|N<<16,k=k+N|0,a^=k,a=a>>>32-12|a<<12,g=g+p|0,W^=g,W=W>>>32-16|W<<16,X=X+W|0,p^=X,p=p>>>32-12|p<<12,v=v+L|0,j^=v,j=j>>>32-16|j<<16,J=J+j|0,L^=J,L=L>>>32-12|L<<12,y=y+z|0,F^=y,F=F>>>32-16|F<<16,A=A+F|0,z^=A,z=z>>>32-12|z<<12,v=v+L|0,j^=v,j=j>>>32-8|j<<8,J=J+j|0,L^=J,L=L>>>32-7|L<<7,y=y+z|0,F^=y,F=F>>>32-8|F<<8,A=A+F|0,z^=A,z=z>>>32-7|z<<7,g=g+p|0,W^=g,W=W>>>32-8|W<<8,X=X+W|0,p^=X,p=p>>>32-7|p<<7,O=O+a|0,N^=O,N=N>>>32-8|N<<8,k=k+N|0,a^=k,a=a>>>32-7|a<<7,O=O+p|0,F^=O,F=F>>>32-16|F<<16,J=J+F|0,p^=J,p=p>>>32-12|p<<12,g=g+L|0,N^=g,N=N>>>32-16|N<<16,A=A+N|0,L^=A,L=L>>>32-12|L<<12,v=v+z|0,W^=v,W=W>>>32-16|W<<16,k=k+W|0,z^=k,z=z>>>32-12|z<<12,y=y+a|0,j^=y,j=j>>>32-16|j<<16,X=X+j|0,a^=X,a=a>>>32-12|a<<12,v=v+z|0,W^=v,W=W>>>32-8|W<<8,k=k+W|0,z^=k,z=z>>>32-7|z<<7,y=y+a|0,j^=y,j=j>>>32-8|j<<8,X=X+j|0,a^=X,a=a>>>32-7|a<<7,g=g+L|0,N^=g,N=N>>>32-8|N<<8,A=A+N|0,L^=A,L=L>>>32-7|L<<7,O=O+p|0,F^=O,F=F>>>32-8|F<<8,J=J+F|0,p^=J,p=p>>>32-7|p<<7;nt.writeUint32LE(O+n|0,e,0),nt.writeUint32LE(g+i|0,e,4),nt.writeUint32LE(v+s|0,e,8),nt.writeUint32LE(y+o|0,e,12),nt.writeUint32LE(a+c|0,e,16),nt.writeUint32LE(p+h|0,e,20),nt.writeUint32LE(L+f|0,e,24),nt.writeUint32LE(z+l|0,e,28),nt.writeUint32LE(k+m|0,e,32),nt.writeUint32LE(X+b|0,e,36),nt.writeUint32LE(J+w|0,e,40),nt.writeUint32LE(A+D|0,e,44),nt.writeUint32LE(N+P|0,e,48),nt.writeUint32LE(W+R|0,e,52),nt.writeUint32LE(j+$|0,e,56),nt.writeUint32LE(F+E|0,e,60)}function oo(e,t,r,n,i){if(i===void 0&&(i=0),e.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(n.length<r.length)throw new Error("ChaCha: destination is shorter than source");var s,o;if(i===0){if(t.length!==8&&t.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");s=new Uint8Array(16),o=s.length-t.length,s.set(t,o)}else{if(t.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");s=t,o=i}for(var c=new Uint8Array(64),h=0;h<r.length;h+=64){Cl(c,s,e);for(var f=h;f<h+64&&f<r.length;f++)n[f]=r[f]^c[f-h];Ll(s,0,o)}return ti.wipe(c),i===0&&ti.wipe(s),n}tn.streamXOR=oo;function Fl(e,t,r,n){return n===void 0&&(n=0),ti.wipe(r),oo(e,t,r,r,n)}tn.stream=Fl;function Ll(e,t,r){for(var n=1;r--;)n=n+(e[t]&255)|0,e[t]=n&255,n>>>=8,t++;if(n>0)throw new Error("ChaCha: counter overflow")}var ao={},Lt={};Object.defineProperty(Lt,"__esModule",{value:!0});function Ul(e,t,r){return~(e-1)&t|e-1&r}Lt.select=Ul;function $l(e,t){return(e|0)-(t|0)-1>>>31&1}Lt.lessOrEqual=$l;function co(e,t){if(e.length!==t.length)return 0;for(var r=0,n=0;n<e.length;n++)r|=e[n]^t[n];return 1&r-1>>>8}Lt.compare=co;function Ml(e,t){return e.length===0||t.length===0?!1:co(e,t)!==0}Lt.equal=Ml,function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=Lt,r=dt;e.DIGEST_LENGTH=16;var n=function(){function o(c){this.digestLength=e.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var h=c[0]|c[1]<<8;this._r[0]=h&8191;var f=c[2]|c[3]<<8;this._r[1]=(h>>>13|f<<3)&8191;var l=c[4]|c[5]<<8;this._r[2]=(f>>>10|l<<6)&7939;var m=c[6]|c[7]<<8;this._r[3]=(l>>>7|m<<9)&8191;var b=c[8]|c[9]<<8;this._r[4]=(m>>>4|b<<12)&255,this._r[5]=b>>>1&8190;var w=c[10]|c[11]<<8;this._r[6]=(b>>>14|w<<2)&8191;var D=c[12]|c[13]<<8;this._r[7]=(w>>>11|D<<5)&8065;var P=c[14]|c[15]<<8;this._r[8]=(D>>>8|P<<8)&8191,this._r[9]=P>>>5&127,this._pad[0]=c[16]|c[17]<<8,this._pad[1]=c[18]|c[19]<<8,this._pad[2]=c[20]|c[21]<<8,this._pad[3]=c[22]|c[23]<<8,this._pad[4]=c[24]|c[25]<<8,this._pad[5]=c[26]|c[27]<<8,this._pad[6]=c[28]|c[29]<<8,this._pad[7]=c[30]|c[31]<<8}return o.prototype._blocks=function(c,h,f){for(var l=this._fin?0:2048,m=this._h[0],b=this._h[1],w=this._h[2],D=this._h[3],P=this._h[4],R=this._h[5],$=this._h[6],E=this._h[7],O=this._h[8],g=this._h[9],v=this._r[0],y=this._r[1],a=this._r[2],p=this._r[3],L=this._r[4],z=this._r[5],k=this._r[6],X=this._r[7],J=this._r[8],A=this._r[9];f>=16;){var N=c[h+0]|c[h+1]<<8;m+=N&8191;var W=c[h+2]|c[h+3]<<8;b+=(N>>>13|W<<3)&8191;var j=c[h+4]|c[h+5]<<8;w+=(W>>>10|j<<6)&8191;var F=c[h+6]|c[h+7]<<8;D+=(j>>>7|F<<9)&8191;var U=c[h+8]|c[h+9]<<8;P+=(F>>>4|U<<12)&8191,R+=U>>>1&8191;var M=c[h+10]|c[h+11]<<8;$+=(U>>>14|M<<2)&8191;var B=c[h+12]|c[h+13]<<8;E+=(M>>>11|B<<5)&8191;var ne=c[h+14]|c[h+15]<<8;O+=(B>>>8|ne<<8)&8191,g+=ne>>>5|l;var K=0,Q=K;Q+=m*v,Q+=b*(5*A),Q+=w*(5*J),Q+=D*(5*X),Q+=P*(5*k),K=Q>>>13,Q&=8191,Q+=R*(5*z),Q+=$*(5*L),Q+=E*(5*p),Q+=O*(5*a),Q+=g*(5*y),K+=Q>>>13,Q&=8191;var Y=K;Y+=m*y,Y+=b*v,Y+=w*(5*A),Y+=D*(5*J),Y+=P*(5*X),K=Y>>>13,Y&=8191,Y+=R*(5*k),Y+=$*(5*z),Y+=E*(5*L),Y+=O*(5*p),Y+=g*(5*a),K+=Y>>>13,Y&=8191;var ae=K;ae+=m*a,ae+=b*y,ae+=w*v,ae+=D*(5*A),ae+=P*(5*J),K=ae>>>13,ae&=8191,ae+=R*(5*X),ae+=$*(5*k),ae+=E*(5*z),ae+=O*(5*L),ae+=g*(5*p),K+=ae>>>13,ae&=8191;var T=K;T+=m*p,T+=b*a,T+=w*y,T+=D*v,T+=P*(5*A),K=T>>>13,T&=8191,T+=R*(5*J),T+=$*(5*X),T+=E*(5*k),T+=O*(5*z),T+=g*(5*L),K+=T>>>13,T&=8191;var I=K;I+=m*L,I+=b*p,I+=w*a,I+=D*y,I+=P*v,K=I>>>13,I&=8191,I+=R*(5*A),I+=$*(5*J),I+=E*(5*X),I+=O*(5*k),I+=g*(5*z),K+=I>>>13,I&=8191;var S=K;S+=m*z,S+=b*L,S+=w*p,S+=D*a,S+=P*y,K=S>>>13,S&=8191,S+=R*v,S+=$*(5*A),S+=E*(5*J),S+=O*(5*X),S+=g*(5*k),K+=S>>>13,S&=8191;var u=K;u+=m*k,u+=b*z,u+=w*L,u+=D*p,u+=P*a,K=u>>>13,u&=8191,u+=R*y,u+=$*v,u+=E*(5*A),u+=O*(5*J),u+=g*(5*X),K+=u>>>13,u&=8191;var _=K;_+=m*X,_+=b*k,_+=w*z,_+=D*L,_+=P*p,K=_>>>13,_&=8191,_+=R*a,_+=$*y,_+=E*v,_+=O*(5*A),_+=g*(5*J),K+=_>>>13,_&=8191;var q=K;q+=m*J,q+=b*X,q+=w*k,q+=D*z,q+=P*L,K=q>>>13,q&=8191,q+=R*p,q+=$*a,q+=E*y,q+=O*v,q+=g*(5*A),K+=q>>>13,q&=8191;var V=K;V+=m*A,V+=b*J,V+=w*X,V+=D*k,V+=P*z,K=V>>>13,V&=8191,V+=R*L,V+=$*p,V+=E*a,V+=O*y,V+=g*v,K+=V>>>13,V&=8191,K=(K<<2)+K|0,K=K+Q|0,Q=K&8191,K=K>>>13,Y+=K,m=Q,b=Y,w=ae,D=T,P=I,R=S,$=u,E=_,O=q,g=V,h+=16,f-=16}this._h[0]=m,this._h[1]=b,this._h[2]=w,this._h[3]=D,this._h[4]=P,this._h[5]=R,this._h[6]=$,this._h[7]=E,this._h[8]=O,this._h[9]=g},o.prototype.finish=function(c,h){h===void 0&&(h=0);var f=new Uint16Array(10),l,m,b,w;if(this._leftover){for(w=this._leftover,this._buffer[w++]=1;w<16;w++)this._buffer[w]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(l=this._h[1]>>>13,this._h[1]&=8191,w=2;w<10;w++)this._h[w]+=l,l=this._h[w]>>>13,this._h[w]&=8191;for(this._h[0]+=l*5,l=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=l,l=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=l,f[0]=this._h[0]+5,l=f[0]>>>13,f[0]&=8191,w=1;w<10;w++)f[w]=this._h[w]+l,l=f[w]>>>13,f[w]&=8191;for(f[9]-=1<<13,m=(l^1)-1,w=0;w<10;w++)f[w]&=m;for(m=~m,w=0;w<10;w++)this._h[w]=this._h[w]&m|f[w];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,b=this._h[0]+this._pad[0],this._h[0]=b&65535,w=1;w<8;w++)b=(this._h[w]+this._pad[w]|0)+(b>>>16)|0,this._h[w]=b&65535;return c[h+0]=this._h[0]>>>0,c[h+1]=this._h[0]>>>8,c[h+2]=this._h[1]>>>0,c[h+3]=this._h[1]>>>8,c[h+4]=this._h[2]>>>0,c[h+5]=this._h[2]>>>8,c[h+6]=this._h[3]>>>0,c[h+7]=this._h[3]>>>8,c[h+8]=this._h[4]>>>0,c[h+9]=this._h[4]>>>8,c[h+10]=this._h[5]>>>0,c[h+11]=this._h[5]>>>8,c[h+12]=this._h[6]>>>0,c[h+13]=this._h[6]>>>8,c[h+14]=this._h[7]>>>0,c[h+15]=this._h[7]>>>8,this._finished=!0,this},o.prototype.update=function(c){var h=0,f=c.length,l;if(this._leftover){l=16-this._leftover,l>f&&(l=f);for(var m=0;m<l;m++)this._buffer[this._leftover+m]=c[h+m];if(f-=l,h+=l,this._leftover+=l,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(f>=16&&(l=f-f%16,this._blocks(c,h,l),h+=l,f-=l),f){for(var m=0;m<f;m++)this._buffer[this._leftover+m]=c[h+m];this._leftover+=f}return this},o.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var c=new Uint8Array(16);return this.finish(c),c},o.prototype.clean=function(){return r.wipe(this._buffer),r.wipe(this._r),r.wipe(this._h),r.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},o}();e.Poly1305=n;function i(o,c){var h=new n(o);h.update(c);var f=h.digest();return h.clean(),f}e.oneTimeAuth=i;function s(o,c){return o.length!==e.DIGEST_LENGTH||c.length!==e.DIGEST_LENGTH?!1:t.equal(o,c)}e.equal=s}(ao),function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=tn,r=ao,n=dt,i=te,s=Lt;e.KEY_LENGTH=32,e.NONCE_LENGTH=12,e.TAG_LENGTH=16;var o=new Uint8Array(16),c=function(){function h(f){if(this.nonceLength=e.NONCE_LENGTH,this.tagLength=e.TAG_LENGTH,f.length!==e.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(f)}return h.prototype.seal=function(f,l,m,b){if(f.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var w=new Uint8Array(16);w.set(f,w.length-f.length);var D=new Uint8Array(32);t.stream(this._key,w,D,4);var P=l.length+this.tagLength,R;if(b){if(b.length!==P)throw new Error("ChaCha20Poly1305: incorrect destination length");R=b}else R=new Uint8Array(P);return t.streamXOR(this._key,w,l,R,4),this._authenticate(R.subarray(R.length-this.tagLength,R.length),D,R.subarray(0,R.length-this.tagLength),m),n.wipe(w),R},h.prototype.open=function(f,l,m,b){if(f.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(l.length<this.tagLength)return null;var w=new Uint8Array(16);w.set(f,w.length-f.length);var D=new Uint8Array(32);t.stream(this._key,w,D,4);var P=new Uint8Array(this.tagLength);if(this._authenticate(P,D,l.subarray(0,l.length-this.tagLength),m),!s.equal(P,l.subarray(l.length-this.tagLength,l.length)))return null;var R=l.length-this.tagLength,$;if(b){if(b.length!==R)throw new Error("ChaCha20Poly1305: incorrect destination length");$=b}else $=new Uint8Array(R);return t.streamXOR(this._key,w,l.subarray(0,l.length-this.tagLength),$,4),n.wipe(w),$},h.prototype.clean=function(){return n.wipe(this._key),this},h.prototype._authenticate=function(f,l,m,b){var w=new r.Poly1305(l);b&&(w.update(b),b.length%16>0&&w.update(o.subarray(b.length%16))),w.update(m),m.length%16>0&&w.update(o.subarray(m.length%16));var D=new Uint8Array(8);b&&i.writeUint64LE(b.length,D),w.update(D),i.writeUint64LE(m.length,D),w.update(D);for(var P=w.digest(),R=0;R<P.length;R++)f[R]=P[R];w.clean(),n.wipe(P),n.wipe(D)},h}();e.ChaCha20Poly1305=c}(ei);var uo={},Ir={},ri={};Object.defineProperty(ri,"__esModule",{value:!0});function jl(e){return typeof e.saveState<"u"&&typeof e.restoreState<"u"&&typeof e.cleanSavedState<"u"}ri.isSerializableHash=jl,Object.defineProperty(Ir,"__esModule",{value:!0});var St=ri,zl=Lt,Bl=dt,fo=function(){function e(t,r){this._finished=!1,this._inner=new t,this._outer=new t,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var n=new Uint8Array(this.blockSize);r.length>this.blockSize?this._inner.update(r).finish(n).clean():n.set(r);for(var i=0;i<n.length;i++)n[i]^=54;this._inner.update(n);for(var i=0;i<n.length;i++)n[i]^=106;this._outer.update(n),St.isSerializableHash(this._inner)&&St.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),Bl.wipe(n)}return e.prototype.reset=function(){if(!St.isSerializableHash(this._inner)||!St.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},e.prototype.clean=function(){St.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),St.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},e.prototype.update=function(t){return this._inner.update(t),this},e.prototype.finish=function(t){return this._finished?(this._outer.finish(t),this):(this._inner.finish(t),this._outer.update(t.subarray(0,this.digestLength)).finish(t),this._finished=!0,this)},e.prototype.digest=function(){var t=new Uint8Array(this.digestLength);return this.finish(t),t},e.prototype.saveState=function(){if(!St.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},e.prototype.restoreState=function(t){if(!St.isSerializableHash(this._inner)||!St.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(t),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},e.prototype.cleanSavedState=function(t){if(!St.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(t)},e}();Ir.HMAC=fo;function Kl(e,t,r){var n=new fo(e,t);n.update(r);var i=n.digest();return n.clean(),i}Ir.hmac=Kl,Ir.equal=zl.equal,Object.defineProperty(uo,"__esModule",{value:!0});var ho=Ir,lo=dt,ql=function(){function e(t,r,n,i){n===void 0&&(n=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=t,this._info=i;var s=ho.hmac(this._hash,n,r);this._hmac=new ho.HMAC(t,s),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return e.prototype._fillBuffer=function(){this._counter[0]++;var t=this._counter[0];if(t===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),t>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},e.prototype.expand=function(t){for(var r=new Uint8Array(t),n=0;n<r.length;n++)this._bufpos===this._buffer.length&&this._fillBuffer(),r[n]=this._buffer[this._bufpos++];return r},e.prototype.clean=function(){this._hmac.clean(),lo.wipe(this._buffer),lo.wipe(this._counter),this._bufpos=0},e}(),Hl=uo.HKDF=ql,rn={};(function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=te,r=dt;e.DIGEST_LENGTH=32,e.BLOCK_SIZE=64;var n=function(){function c(){this.digestLength=e.DIGEST_LENGTH,this.blockSize=e.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return c.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},c.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},c.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._temp),this.reset()},c.prototype.update=function(h,f){if(f===void 0&&(f=h.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var l=0;if(this._bytesHashed+=f,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&f>0;)this._buffer[this._bufferLength++]=h[l++],f--;this._bufferLength===this.blockSize&&(s(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(f>=this.blockSize&&(l=s(this._temp,this._state,h,l,f),f%=this.blockSize);f>0;)this._buffer[this._bufferLength++]=h[l++],f--;return this},c.prototype.finish=function(h){if(!this._finished){var f=this._bytesHashed,l=this._bufferLength,m=f/536870912|0,b=f<<3,w=f%64<56?64:128;this._buffer[l]=128;for(var D=l+1;D<w-8;D++)this._buffer[D]=0;t.writeUint32BE(m,this._buffer,w-8),t.writeUint32BE(b,this._buffer,w-4),s(this._temp,this._state,this._buffer,0,w),this._finished=!0}for(var D=0;D<this.digestLength/4;D++)t.writeUint32BE(this._state[D],h,D*4);return this},c.prototype.digest=function(){var h=new Uint8Array(this.digestLength);return this.finish(h),h},c.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},c.prototype.restoreState=function(h){return this._state.set(h.state),this._bufferLength=h.bufferLength,h.buffer&&this._buffer.set(h.buffer),this._bytesHashed=h.bytesHashed,this._finished=!1,this},c.prototype.cleanSavedState=function(h){r.wipe(h.state),h.buffer&&r.wipe(h.buffer),h.bufferLength=0,h.bytesHashed=0},c}();e.SHA256=n;var i=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function s(c,h,f,l,m){for(;m>=64;){for(var b=h[0],w=h[1],D=h[2],P=h[3],R=h[4],$=h[5],E=h[6],O=h[7],g=0;g<16;g++){var v=l+g*4;c[g]=t.readUint32BE(f,v)}for(var g=16;g<64;g++){var y=c[g-2],a=(y>>>17|y<<32-17)^(y>>>19|y<<32-19)^y>>>10;y=c[g-15];var p=(y>>>7|y<<32-7)^(y>>>18|y<<32-18)^y>>>3;c[g]=(a+c[g-7]|0)+(p+c[g-16]|0)}for(var g=0;g<64;g++){var a=(((R>>>6|R<<26)^(R>>>11|R<<21)^(R>>>25|R<<7))+(R&$^~R&E)|0)+(O+(i[g]+c[g]|0)|0)|0,p=((b>>>2|b<<32-2)^(b>>>13|b<<32-13)^(b>>>22|b<<32-22))+(b&w^b&D^w&D)|0;O=E,E=$,$=R,R=P+a|0,P=D,D=w,w=b,b=a+p|0}h[0]+=b,h[1]+=w,h[2]+=D,h[3]+=P,h[4]+=R,h[5]+=$,h[6]+=E,h[7]+=O,l+=64,m-=64}return l}function o(c){var h=new n;h.update(c);var f=h.digest();return h.clean(),f}e.hash=o})(rn);var ni={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.sharedKey=e.generateKeyPair=e.generateKeyPairFromSeed=e.scalarMultBase=e.scalarMult=e.SHARED_KEY_LENGTH=e.SECRET_KEY_LENGTH=e.PUBLIC_KEY_LENGTH=void 0;const t=ar,r=dt;e.PUBLIC_KEY_LENGTH=32,e.SECRET_KEY_LENGTH=32,e.SHARED_KEY_LENGTH=32;function n(g){const v=new Float64Array(16);if(g)for(let y=0;y<g.length;y++)v[y]=g[y];return v}const i=new Uint8Array(32);i[0]=9;const s=n([56129,1]);function o(g){let v=1;for(let y=0;y<16;y++){let a=g[y]+v+65535;v=Math.floor(a/65536),g[y]=a-v*65536}g[0]+=v-1+37*(v-1)}function c(g,v,y){const a=~(y-1);for(let p=0;p<16;p++){const L=a&(g[p]^v[p]);g[p]^=L,v[p]^=L}}function h(g,v){const y=n(),a=n();for(let p=0;p<16;p++)a[p]=v[p];o(a),o(a),o(a);for(let p=0;p<2;p++){y[0]=a[0]-65517;for(let z=1;z<15;z++)y[z]=a[z]-65535-(y[z-1]>>16&1),y[z-1]&=65535;y[15]=a[15]-32767-(y[14]>>16&1);const L=y[15]>>16&1;y[14]&=65535,c(a,y,1-L)}for(let p=0;p<16;p++)g[2*p]=a[p]&255,g[2*p+1]=a[p]>>8}function f(g,v){for(let y=0;y<16;y++)g[y]=v[2*y]+(v[2*y+1]<<8);g[15]&=32767}function l(g,v,y){for(let a=0;a<16;a++)g[a]=v[a]+y[a]}function m(g,v,y){for(let a=0;a<16;a++)g[a]=v[a]-y[a]}function b(g,v,y){let a,p,L=0,z=0,k=0,X=0,J=0,A=0,N=0,W=0,j=0,F=0,U=0,M=0,B=0,ne=0,K=0,Q=0,Y=0,ae=0,T=0,I=0,S=0,u=0,_=0,q=0,V=0,he=0,ye=0,de=0,ve=0,Ue=0,Re=0,_e=y[0],pe=y[1],le=y[2],ue=y[3],ce=y[4],oe=y[5],se=y[6],ee=y[7],fe=y[8],ge=y[9],re=y[10],be=y[11],we=y[12],Ee=y[13],De=y[14],me=y[15];a=v[0],L+=a*_e,z+=a*pe,k+=a*le,X+=a*ue,J+=a*ce,A+=a*oe,N+=a*se,W+=a*ee,j+=a*fe,F+=a*ge,U+=a*re,M+=a*be,B+=a*we,ne+=a*Ee,K+=a*De,Q+=a*me,a=v[1],z+=a*_e,k+=a*pe,X+=a*le,J+=a*ue,A+=a*ce,N+=a*oe,W+=a*se,j+=a*ee,F+=a*fe,U+=a*ge,M+=a*re,B+=a*be,ne+=a*we,K+=a*Ee,Q+=a*De,Y+=a*me,a=v[2],k+=a*_e,X+=a*pe,J+=a*le,A+=a*ue,N+=a*ce,W+=a*oe,j+=a*se,F+=a*ee,U+=a*fe,M+=a*ge,B+=a*re,ne+=a*be,K+=a*we,Q+=a*Ee,Y+=a*De,ae+=a*me,a=v[3],X+=a*_e,J+=a*pe,A+=a*le,N+=a*ue,W+=a*ce,j+=a*oe,F+=a*se,U+=a*ee,M+=a*fe,B+=a*ge,ne+=a*re,K+=a*be,Q+=a*we,Y+=a*Ee,ae+=a*De,T+=a*me,a=v[4],J+=a*_e,A+=a*pe,N+=a*le,W+=a*ue,j+=a*ce,F+=a*oe,U+=a*se,M+=a*ee,B+=a*fe,ne+=a*ge,K+=a*re,Q+=a*be,Y+=a*we,ae+=a*Ee,T+=a*De,I+=a*me,a=v[5],A+=a*_e,N+=a*pe,W+=a*le,j+=a*ue,F+=a*ce,U+=a*oe,M+=a*se,B+=a*ee,ne+=a*fe,K+=a*ge,Q+=a*re,Y+=a*be,ae+=a*we,T+=a*Ee,I+=a*De,S+=a*me,a=v[6],N+=a*_e,W+=a*pe,j+=a*le,F+=a*ue,U+=a*ce,M+=a*oe,B+=a*se,ne+=a*ee,K+=a*fe,Q+=a*ge,Y+=a*re,ae+=a*be,T+=a*we,I+=a*Ee,S+=a*De,u+=a*me,a=v[7],W+=a*_e,j+=a*pe,F+=a*le,U+=a*ue,M+=a*ce,B+=a*oe,ne+=a*se,K+=a*ee,Q+=a*fe,Y+=a*ge,ae+=a*re,T+=a*be,I+=a*we,S+=a*Ee,u+=a*De,_+=a*me,a=v[8],j+=a*_e,F+=a*pe,U+=a*le,M+=a*ue,B+=a*ce,ne+=a*oe,K+=a*se,Q+=a*ee,Y+=a*fe,ae+=a*ge,T+=a*re,I+=a*be,S+=a*we,u+=a*Ee,_+=a*De,q+=a*me,a=v[9],F+=a*_e,U+=a*pe,M+=a*le,B+=a*ue,ne+=a*ce,K+=a*oe,Q+=a*se,Y+=a*ee,ae+=a*fe,T+=a*ge,I+=a*re,S+=a*be,u+=a*we,_+=a*Ee,q+=a*De,V+=a*me,a=v[10],U+=a*_e,M+=a*pe,B+=a*le,ne+=a*ue,K+=a*ce,Q+=a*oe,Y+=a*se,ae+=a*ee,T+=a*fe,I+=a*ge,S+=a*re,u+=a*be,_+=a*we,q+=a*Ee,V+=a*De,he+=a*me,a=v[11],M+=a*_e,B+=a*pe,ne+=a*le,K+=a*ue,Q+=a*ce,Y+=a*oe,ae+=a*se,T+=a*ee,I+=a*fe,S+=a*ge,u+=a*re,_+=a*be,q+=a*we,V+=a*Ee,he+=a*De,ye+=a*me,a=v[12],B+=a*_e,ne+=a*pe,K+=a*le,Q+=a*ue,Y+=a*ce,ae+=a*oe,T+=a*se,I+=a*ee,S+=a*fe,u+=a*ge,_+=a*re,q+=a*be,V+=a*we,he+=a*Ee,ye+=a*De,de+=a*me,a=v[13],ne+=a*_e,K+=a*pe,Q+=a*le,Y+=a*ue,ae+=a*ce,T+=a*oe,I+=a*se,S+=a*ee,u+=a*fe,_+=a*ge,q+=a*re,V+=a*be,he+=a*we,ye+=a*Ee,de+=a*De,ve+=a*me,a=v[14],K+=a*_e,Q+=a*pe,Y+=a*le,ae+=a*ue,T+=a*ce,I+=a*oe,S+=a*se,u+=a*ee,_+=a*fe,q+=a*ge,V+=a*re,he+=a*be,ye+=a*we,de+=a*Ee,ve+=a*De,Ue+=a*me,a=v[15],Q+=a*_e,Y+=a*pe,ae+=a*le,T+=a*ue,I+=a*ce,S+=a*oe,u+=a*se,_+=a*ee,q+=a*fe,V+=a*ge,he+=a*re,ye+=a*be,de+=a*we,ve+=a*Ee,Ue+=a*De,Re+=a*me,L+=38*Y,z+=38*ae,k+=38*T,X+=38*I,J+=38*S,A+=38*u,N+=38*_,W+=38*q,j+=38*V,F+=38*he,U+=38*ye,M+=38*de,B+=38*ve,ne+=38*Ue,K+=38*Re,p=1,a=L+p+65535,p=Math.floor(a/65536),L=a-p*65536,a=z+p+65535,p=Math.floor(a/65536),z=a-p*65536,a=k+p+65535,p=Math.floor(a/65536),k=a-p*65536,a=X+p+65535,p=Math.floor(a/65536),X=a-p*65536,a=J+p+65535,p=Math.floor(a/65536),J=a-p*65536,a=A+p+65535,p=Math.floor(a/65536),A=a-p*65536,a=N+p+65535,p=Math.floor(a/65536),N=a-p*65536,a=W+p+65535,p=Math.floor(a/65536),W=a-p*65536,a=j+p+65535,p=Math.floor(a/65536),j=a-p*65536,a=F+p+65535,p=Math.floor(a/65536),F=a-p*65536,a=U+p+65535,p=Math.floor(a/65536),U=a-p*65536,a=M+p+65535,p=Math.floor(a/65536),M=a-p*65536,a=B+p+65535,p=Math.floor(a/65536),B=a-p*65536,a=ne+p+65535,p=Math.floor(a/65536),ne=a-p*65536,a=K+p+65535,p=Math.floor(a/65536),K=a-p*65536,a=Q+p+65535,p=Math.floor(a/65536),Q=a-p*65536,L+=p-1+37*(p-1),p=1,a=L+p+65535,p=Math.floor(a/65536),L=a-p*65536,a=z+p+65535,p=Math.floor(a/65536),z=a-p*65536,a=k+p+65535,p=Math.floor(a/65536),k=a-p*65536,a=X+p+65535,p=Math.floor(a/65536),X=a-p*65536,a=J+p+65535,p=Math.floor(a/65536),J=a-p*65536,a=A+p+65535,p=Math.floor(a/65536),A=a-p*65536,a=N+p+65535,p=Math.floor(a/65536),N=a-p*65536,a=W+p+65535,p=Math.floor(a/65536),W=a-p*65536,a=j+p+65535,p=Math.floor(a/65536),j=a-p*65536,a=F+p+65535,p=Math.floor(a/65536),F=a-p*65536,a=U+p+65535,p=Math.floor(a/65536),U=a-p*65536,a=M+p+65535,p=Math.floor(a/65536),M=a-p*65536,a=B+p+65535,p=Math.floor(a/65536),B=a-p*65536,a=ne+p+65535,p=Math.floor(a/65536),ne=a-p*65536,a=K+p+65535,p=Math.floor(a/65536),K=a-p*65536,a=Q+p+65535,p=Math.floor(a/65536),Q=a-p*65536,L+=p-1+37*(p-1),g[0]=L,g[1]=z,g[2]=k,g[3]=X,g[4]=J,g[5]=A,g[6]=N,g[7]=W,g[8]=j,g[9]=F,g[10]=U,g[11]=M,g[12]=B,g[13]=ne,g[14]=K,g[15]=Q}function w(g,v){b(g,v,v)}function D(g,v){const y=n();for(let a=0;a<16;a++)y[a]=v[a];for(let a=253;a>=0;a--)w(y,y),a!==2&&a!==4&&b(y,y,v);for(let a=0;a<16;a++)g[a]=y[a]}function P(g,v){const y=new Uint8Array(32),a=new Float64Array(80),p=n(),L=n(),z=n(),k=n(),X=n(),J=n();for(let j=0;j<31;j++)y[j]=g[j];y[31]=g[31]&127|64,y[0]&=248,f(a,v);for(let j=0;j<16;j++)L[j]=a[j];p[0]=k[0]=1;for(let j=254;j>=0;--j){const F=y[j>>>3]>>>(j&7)&1;c(p,L,F),c(z,k,F),l(X,p,z),m(p,p,z),l(z,L,k),m(L,L,k),w(k,X),w(J,p),b(p,z,p),b(z,L,X),l(X,p,z),m(p,p,z),w(L,p),m(z,k,J),b(p,z,s),l(p,p,k),b(z,z,p),b(p,k,J),b(k,L,a),w(L,X),c(p,L,F),c(z,k,F)}for(let j=0;j<16;j++)a[j+16]=p[j],a[j+32]=z[j],a[j+48]=L[j],a[j+64]=k[j];const A=a.subarray(32),N=a.subarray(16);D(A,A),b(N,N,A);const W=new Uint8Array(32);return h(W,N),W}e.scalarMult=P;function R(g){return P(g,i)}e.scalarMultBase=R;function $(g){if(g.length!==e.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${e.SECRET_KEY_LENGTH} bytes`);const v=new Uint8Array(g);return{publicKey:R(v),secretKey:v}}e.generateKeyPairFromSeed=$;function E(g){const v=(0,t.randomBytes)(32,g),y=$(v);return(0,r.wipe)(v),y}e.generateKeyPair=E;function O(g,v,y=!1){if(g.length!==e.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(v.length!==e.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const a=P(g,v);if(y){let p=0;for(let L=0;L<a.length;L++)p|=a[L];if(p===0)throw new Error("X25519: invalid shared key")}return a}e.sharedKey=O})(ni);var po=function(e,t,r){if(r||arguments.length===2)for(var n=0,i=t.length,s;n<i;n++)(s||!(n in t))&&(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return e.concat(s||Array.prototype.slice.call(t))},Vl=function(){function e(t,r,n){this.name=t,this.version=r,this.os=n,this.type="browser"}return e}(),Gl=function(){function e(t){this.version=t,this.type="node",this.name="node",this.os=process.platform}return e}(),Wl=function(){function e(t,r,n,i){this.name=t,this.version=r,this.os=n,this.bot=i,this.type="bot-device"}return e}(),Yl=function(){function e(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return e}(),kl=function(){function e(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return e}(),Xl=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,Jl=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,go=3,Zl=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",Xl]],_o=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function Ql(e){return e?yo(e):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new kl:typeof navigator<"u"?yo(navigator.userAgent):rd()}function ed(e){return e!==""&&Zl.reduce(function(t,r){var n=r[0],i=r[1];if(t)return t;var s=i.exec(e);return!!s&&[n,s]},!1)}function yo(e){var t=ed(e);if(!t)return null;var r=t[0],n=t[1];if(r==="searchbot")return new Yl;var i=n[1]&&n[1].split(".").join("_").split("_").slice(0,3);i?i.length<go&&(i=po(po([],i,!0),nd(go-i.length),!0)):i=[];var s=i.join("."),o=td(e),c=Jl.exec(e);return c&&c[1]?new Wl(r,s,o,c[1]):new Vl(r,s,o)}function td(e){for(var t=0,r=_o.length;t<r;t++){var n=_o[t],i=n[0],s=n[1],o=s.exec(e);if(o)return i}return null}function rd(){var e=typeof process<"u"&&process.version;return e?new Gl(process.version.slice(1)):null}function nd(e){for(var t=[],r=0;r<e;r++)t.push("0");return t}var Oe={};Object.defineProperty(Oe,"__esModule",{value:!0}),Oe.getLocalStorage=Oe.getLocalStorageOrThrow=Oe.getCrypto=Oe.getCryptoOrThrow=wo=Oe.getLocation=Oe.getLocationOrThrow=ii=Oe.getNavigator=Oe.getNavigatorOrThrow=bo=Oe.getDocument=Oe.getDocumentOrThrow=Oe.getFromWindowOrThrow=Oe.getFromWindow=void 0;function kt(e){let t;return typeof window<"u"&&typeof window[e]<"u"&&(t=window[e]),t}Oe.getFromWindow=kt;function cr(e){const t=kt(e);if(!t)throw new Error(`${e} is not defined in Window`);return t}Oe.getFromWindowOrThrow=cr;function id(){return cr("document")}Oe.getDocumentOrThrow=id;function sd(){return kt("document")}var bo=Oe.getDocument=sd;function od(){return cr("navigator")}Oe.getNavigatorOrThrow=od;function ad(){return kt("navigator")}var ii=Oe.getNavigator=ad;function cd(){return cr("location")}Oe.getLocationOrThrow=cd;function ud(){return kt("location")}var wo=Oe.getLocation=ud;function fd(){return cr("crypto")}Oe.getCryptoOrThrow=fd;function hd(){return kt("crypto")}Oe.getCrypto=hd;function ld(){return cr("localStorage")}Oe.getLocalStorageOrThrow=ld;function dd(){return kt("localStorage")}Oe.getLocalStorage=dd;var si={};Object.defineProperty(si,"__esModule",{value:!0});var vo=si.getWindowMetadata=void 0;const mo=Oe;function pd(){let e,t;try{e=mo.getDocumentOrThrow(),t=mo.getLocationOrThrow()}catch{return null}function r(){const m=e.getElementsByTagName("link"),b=[];for(let w=0;w<m.length;w++){const D=m[w],P=D.getAttribute("rel");if(P&&P.toLowerCase().indexOf("icon")>-1){const R=D.getAttribute("href");if(R)if(R.toLowerCase().indexOf("https:")===-1&&R.toLowerCase().indexOf("http:")===-1&&R.indexOf("//")!==0){let $=t.protocol+"//"+t.host;if(R.indexOf("/")===0)$+=R;else{const E=t.pathname.split("/");E.pop();const O=E.join("/");$+=O+"/"+R}b.push($)}else if(R.indexOf("//")===0){const $=t.protocol+R;b.push($)}else b.push(R)}}return b}function n(...m){const b=e.getElementsByTagName("meta");for(let w=0;w<b.length;w++){const D=b[w],P=["itemprop","property","name"].map(R=>D.getAttribute(R)).filter(R=>R?m.includes(R):!1);if(P.length&&P){const R=D.getAttribute("content");if(R)return R}}return""}function i(){let m=n("name","og:site_name","og:title","twitter:title");return m||(m=e.title),m}function s(){return n("description","og:description","twitter:description","keywords")}const o=i(),c=s(),h=t.origin,f=r();return{description:c,url:h,icons:f,name:o}}vo=si.getWindowMetadata=pd;var Tr={},gd=e=>encodeURIComponent(e).replace(/[!'()*]/g,t=>`%${t.charCodeAt(0).toString(16).toUpperCase()}`),Eo="%[a-f0-9]{2}",Do=new RegExp("("+Eo+")|([^%]+?)","gi"),So=new RegExp("("+Eo+")+","gi");function oi(e,t){try{return[decodeURIComponent(e.join(""))]}catch{}if(e.length===1)return e;t=t||1;var r=e.slice(0,t),n=e.slice(t);return Array.prototype.concat.call([],oi(r),oi(n))}function _d(e){try{return decodeURIComponent(e)}catch{for(var t=e.match(Do)||[],r=1;r<t.length;r++)e=oi(t,r).join(""),t=e.match(Do)||[];return e}}function yd(e){for(var t={"%FE%FF":"\uFFFD\uFFFD","%FF%FE":"\uFFFD\uFFFD"},r=So.exec(e);r;){try{t[r[0]]=decodeURIComponent(r[0])}catch{var n=_d(r[0]);n!==r[0]&&(t[r[0]]=n)}r=So.exec(e)}t["%C2"]="\uFFFD";for(var i=Object.keys(t),s=0;s<i.length;s++){var o=i[s];e=e.replace(new RegExp(o,"g"),t[o])}return e}var bd=function(e){if(typeof e!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return e=e.replace(/\+/g," "),decodeURIComponent(e)}catch{return yd(e)}},wd=(e,t)=>{if(!(typeof e=="string"&&typeof t=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(t==="")return[e];const r=e.indexOf(t);return r===-1?[e]:[e.slice(0,r),e.slice(r+t.length)]},vd=function(e,t){for(var r={},n=Object.keys(e),i=Array.isArray(t),s=0;s<n.length;s++){var o=n[s],c=e[o];(i?t.indexOf(o)!==-1:t(o,c,e))&&(r[o]=c)}return r};(function(e){const t=gd,r=bd,n=wd,i=vd,s=E=>E==null,o=Symbol("encodeFragmentIdentifier");function c(E){switch(E.arrayFormat){case"index":return O=>(g,v)=>{const y=g.length;return v===void 0||E.skipNull&&v===null||E.skipEmptyString&&v===""?g:v===null?[...g,[l(O,E),"[",y,"]"].join("")]:[...g,[l(O,E),"[",l(y,E),"]=",l(v,E)].join("")]};case"bracket":return O=>(g,v)=>v===void 0||E.skipNull&&v===null||E.skipEmptyString&&v===""?g:v===null?[...g,[l(O,E),"[]"].join("")]:[...g,[l(O,E),"[]=",l(v,E)].join("")];case"colon-list-separator":return O=>(g,v)=>v===void 0||E.skipNull&&v===null||E.skipEmptyString&&v===""?g:v===null?[...g,[l(O,E),":list="].join("")]:[...g,[l(O,E),":list=",l(v,E)].join("")];case"comma":case"separator":case"bracket-separator":{const O=E.arrayFormat==="bracket-separator"?"[]=":"=";return g=>(v,y)=>y===void 0||E.skipNull&&y===null||E.skipEmptyString&&y===""?v:(y=y===null?"":y,v.length===0?[[l(g,E),O,l(y,E)].join("")]:[[v,l(y,E)].join(E.arrayFormatSeparator)])}default:return O=>(g,v)=>v===void 0||E.skipNull&&v===null||E.skipEmptyString&&v===""?g:v===null?[...g,l(O,E)]:[...g,[l(O,E),"=",l(v,E)].join("")]}}function h(E){let O;switch(E.arrayFormat){case"index":return(g,v,y)=>{if(O=/\[(\d*)\]$/.exec(g),g=g.replace(/\[\d*\]$/,""),!O){y[g]=v;return}y[g]===void 0&&(y[g]={}),y[g][O[1]]=v};case"bracket":return(g,v,y)=>{if(O=/(\[\])$/.exec(g),g=g.replace(/\[\]$/,""),!O){y[g]=v;return}if(y[g]===void 0){y[g]=[v];return}y[g]=[].concat(y[g],v)};case"colon-list-separator":return(g,v,y)=>{if(O=/(:list)$/.exec(g),g=g.replace(/:list$/,""),!O){y[g]=v;return}if(y[g]===void 0){y[g]=[v];return}y[g]=[].concat(y[g],v)};case"comma":case"separator":return(g,v,y)=>{const a=typeof v=="string"&&v.includes(E.arrayFormatSeparator),p=typeof v=="string"&&!a&&m(v,E).includes(E.arrayFormatSeparator);v=p?m(v,E):v;const L=a||p?v.split(E.arrayFormatSeparator).map(z=>m(z,E)):v===null?v:m(v,E);y[g]=L};case"bracket-separator":return(g,v,y)=>{const a=/(\[\])$/.test(g);if(g=g.replace(/\[\]$/,""),!a){y[g]=v&&m(v,E);return}const p=v===null?[]:v.split(E.arrayFormatSeparator).map(L=>m(L,E));if(y[g]===void 0){y[g]=p;return}y[g]=[].concat(y[g],p)};default:return(g,v,y)=>{if(y[g]===void 0){y[g]=v;return}y[g]=[].concat(y[g],v)}}}function f(E){if(typeof E!="string"||E.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function l(E,O){return O.encode?O.strict?t(E):encodeURIComponent(E):E}function m(E,O){return O.decode?r(E):E}function b(E){return Array.isArray(E)?E.sort():typeof E=="object"?b(Object.keys(E)).sort((O,g)=>Number(O)-Number(g)).map(O=>E[O]):E}function w(E){const O=E.indexOf("#");return O!==-1&&(E=E.slice(0,O)),E}function D(E){let O="";const g=E.indexOf("#");return g!==-1&&(O=E.slice(g)),O}function P(E){E=w(E);const O=E.indexOf("?");return O===-1?"":E.slice(O+1)}function R(E,O){return O.parseNumbers&&!Number.isNaN(Number(E))&&typeof E=="string"&&E.trim()!==""?E=Number(E):O.parseBooleans&&E!==null&&(E.toLowerCase()==="true"||E.toLowerCase()==="false")&&(E=E.toLowerCase()==="true"),E}function $(E,O){O=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},O),f(O.arrayFormatSeparator);const g=h(O),v=Object.create(null);if(typeof E!="string"||(E=E.trim().replace(/^[?#&]/,""),!E))return v;for(const y of E.split("&")){if(y==="")continue;let[a,p]=n(O.decode?y.replace(/\+/g," "):y,"=");p=p===void 0?null:["comma","separator","bracket-separator"].includes(O.arrayFormat)?p:m(p,O),g(m(a,O),p,v)}for(const y of Object.keys(v)){const a=v[y];if(typeof a=="object"&&a!==null)for(const p of Object.keys(a))a[p]=R(a[p],O);else v[y]=R(a,O)}return O.sort===!1?v:(O.sort===!0?Object.keys(v).sort():Object.keys(v).sort(O.sort)).reduce((y,a)=>{const p=v[a];return Boolean(p)&&typeof p=="object"&&!Array.isArray(p)?y[a]=b(p):y[a]=p,y},Object.create(null))}e.extract=P,e.parse=$,e.stringify=(E,O)=>{if(!E)return"";O=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},O),f(O.arrayFormatSeparator);const g=p=>O.skipNull&&s(E[p])||O.skipEmptyString&&E[p]==="",v=c(O),y={};for(const p of Object.keys(E))g(p)||(y[p]=E[p]);const a=Object.keys(y);return O.sort!==!1&&a.sort(O.sort),a.map(p=>{const L=E[p];return L===void 0?"":L===null?l(p,O):Array.isArray(L)?L.length===0&&O.arrayFormat==="bracket-separator"?l(p,O)+"[]":L.reduce(v(p),[]).join("&"):l(p,O)+"="+l(L,O)}).filter(p=>p.length>0).join("&")},e.parseUrl=(E,O)=>{O=Object.assign({decode:!0},O);const[g,v]=n(E,"#");return Object.assign({url:g.split("?")[0]||"",query:$(P(E),O)},O&&O.parseFragmentIdentifier&&v?{fragmentIdentifier:m(v,O)}:{})},e.stringifyUrl=(E,O)=>{O=Object.assign({encode:!0,strict:!0,[o]:!0},O);const g=w(E.url).split("?")[0]||"",v=e.extract(E.url),y=e.parse(v,{sort:!1}),a=Object.assign(y,E.query);let p=e.stringify(a,O);p&&(p=`?${p}`);let L=D(E.url);return E.fragmentIdentifier&&(L=`#${O[o]?l(E.fragmentIdentifier,O):E.fragmentIdentifier}`),`${g}${p}${L}`},e.pick=(E,O,g)=>{g=Object.assign({parseFragmentIdentifier:!0,[o]:!1},g);const{url:v,query:y,fragmentIdentifier:a}=e.parseUrl(E,g);return e.stringifyUrl({url:v,query:i(y,O),fragmentIdentifier:a},g)},e.exclude=(E,O,g)=>{const v=Array.isArray(O)?y=>!O.includes(y):(y,a)=>!O(y,a);return e.pick(E,v,g)}})(Tr);const md={waku:{publish:"waku_publish",subscribe:"waku_subscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe"},irn:{publish:"irn_publish",subscribe:"irn_subscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe"},iridium:{publish:"iridium_publish",subscribe:"iridium_subscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe"}},xo="base10",ht="base16",ai="base64pad",ci="utf8",Oo=0,Xt=1,Ed=0,Io=1,ui=12,fi=32;function Dd(){const e=ni.generateKeyPair();return{privateKey:ut(e.secretKey,ht),publicKey:ut(e.publicKey,ht)}}function hi(){const e=ar.randomBytes(fi);return ut(e,ht)}function Sd(e,t){const r=ni.sharedKey(ft(e,ht),ft(t,ht)),n=new Hl(rn.SHA256,r).expand(fi);return ut(n,ht)}function xd(e){const t=rn.hash(ft(e,ht));return ut(t,ht)}function li(e){const t=rn.hash(ft(e,ci));return ut(t,ht)}function Od(e){return ft(`${e}`,xo)}function Nr(e){return Number(ut(e,xo))}function Id(e){const t=Od(typeof e.type<"u"?e.type:Oo);if(Nr(t)===Xt&&typeof e.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof e.senderPublicKey<"u"?ft(e.senderPublicKey,ht):void 0,n=typeof e.iv<"u"?ft(e.iv,ht):ar.randomBytes(ui),i=new ei.ChaCha20Poly1305(ft(e.symKey,ht)).seal(n,ft(e.message,ci));return Nd({type:t,sealed:i,iv:n,senderPublicKey:r})}function Td(e){const t=new ei.ChaCha20Poly1305(ft(e.symKey,ht)),{sealed:r,iv:n}=di(e.encoded),i=t.open(n,r);if(i===null)throw new Error("Failed to decrypt");return ut(i,ci)}function Nd(e){if(Nr(e.type)===Xt){if(typeof e.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return ut(Xn([e.type,e.senderPublicKey,e.iv,e.sealed]),ai)}return ut(Xn([e.type,e.iv,e.sealed]),ai)}function di(e){const t=ft(e,ai),r=t.slice(Ed,Io),n=Io;if(Nr(r)===Xt){const c=n+fi,h=c+ui,f=t.slice(n,c),l=t.slice(c,h),m=t.slice(h);return{type:r,sealed:m,iv:l,senderPublicKey:f}}const i=n+ui,s=t.slice(n,i),o=t.slice(i);return{type:r,sealed:o,iv:s}}function Ad(e,t){const r=di(e);return To({type:Nr(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?ut(r.senderPublicKey,ht):void 0,receiverPublicKey:t?.receiverPublicKey})}function To(e){const t=e?.type||Oo;if(t===Xt){if(typeof e?.senderPublicKey>"u")throw new Error("missing sender public key");if(typeof e?.receiverPublicKey>"u")throw new Error("missing receiver public key")}return{type:t,senderPublicKey:e?.senderPublicKey,receiverPublicKey:e?.receiverPublicKey}}function No(e){return e.type===Xt&&typeof e.senderPublicKey=="string"&&typeof e.receiverPublicKey=="string"}var Rd=Object.defineProperty,Ao=Object.getOwnPropertySymbols,Pd=Object.prototype.hasOwnProperty,Cd=Object.prototype.propertyIsEnumerable,Ro=(e,t,r)=>t in e?Rd(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Po=(e,t)=>{for(var r in t||(t={}))Pd.call(t,r)&&Ro(e,r,t[r]);if(Ao)for(var r of Ao(t))Cd.call(t,r)&&Ro(e,r,t[r]);return e};const Fd="ReactNative",Ar={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},Ld="js";function Co(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function Ud(){return!bo()&&!!ii()&&navigator.product===Fd}function $d(){return!Co()&&!!ii()}function Md(){return Ud()?Ar.reactNative:Co()?Ar.node:$d()?Ar.browser:Ar.unknown}function jd(e,t){let r=Tr.parse(e);return r=Po(Po({},r),t),e=Tr.stringify(r),e}function zd(){return vo()||{name:"",description:"",url:"",icons:[""]}}function Bd(){const e=Ql();if(e===null)return"unknown";const t=e.os?e.os.replace(" ","").toLowerCase():"unknown";return e.type==="browser"?[t,e.name,e.version].join("-"):[t,e.version].join("-")}function Kd(){var e;const t=Md();return t===Ar.browser?[t,((e=wo())==null?void 0:e.host)||"unknown"].join(":"):t}function qd(e,t,r){const n=Bd(),i=Kd();return[[e,t].join("-"),[Ld,r].join("-"),n,i].join("/")}function Hd({protocol:e,version:t,relayUrl:r,sdkVersion:n,auth:i,projectId:s}){const o=r.split("?"),c=qd(e,t,n),h={auth:i,ua:c,projectId:s},f=jd(o[1]||"",h);return o[0]+"?"+f}function Ut(e,t){return e.filter(r=>t.includes(r)).length===e.length}function Fo(e){return Object.fromEntries(e.entries())}function Lo(e){return new Map(Object.entries(e))}function xt(e,t){return Z.fromMiliseconds((t||Date.now())+Z.toMiliseconds(e))}function $t(e){return Z.fromMiliseconds(Date.now())>=Z.toMiliseconds(e)}function Jt(e){const t=Z.toMiliseconds(e||Z.FIVE_MINUTES);let r,n,i;return{resolve:s=>{i&&r&&(clearTimeout(i),r(s))},reject:s=>{i&&n&&(clearTimeout(i),n(s))},done:()=>new Promise((s,o)=>{i=setTimeout(o,t),r=s,n=o})}}function Uo(e,t){return new Promise(async(r,n)=>{const i=setTimeout(()=>n(),t),s=await e;clearTimeout(i),r(s)})}function $o(e,t){if(typeof t=="string"&&t.startsWith(`${e}:`))return t;if(e.toLowerCase()==="topic"){if(typeof t!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${t}`}else if(e.toLowerCase()==="id"){if(typeof t!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${t}`}throw new Error(`Unknown expirer target type: ${e}`)}function Vd(e){return $o("topic",e)}function Gd(e){return $o("id",e)}function Mo(e){const[t,r]=e.split(":"),n={id:void 0,topic:void 0};if(t==="topic"&&typeof r=="string")n.topic=r;else if(t==="id"&&Number.isInteger(Number(r)))n.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${t}:${r}`);return n}function Le(e,t){return`${e}${t?`:${t}`:""}`}const Wd="irn";function pi(e){return e?.relay||{protocol:Wd}}function gi(e){const t=md[e];if(typeof t>"u")throw new Error(`Relay Protocol not supported: ${e}`);return t}var Yd=Object.defineProperty,jo=Object.getOwnPropertySymbols,kd=Object.prototype.hasOwnProperty,Xd=Object.prototype.propertyIsEnumerable,zo=(e,t,r)=>t in e?Yd(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Jd=(e,t)=>{for(var r in t||(t={}))kd.call(t,r)&&zo(e,r,t[r]);if(jo)for(var r of jo(t))Xd.call(t,r)&&zo(e,r,t[r]);return e};function Zd(e,t="-"){const r={},n="relay"+t;return Object.keys(e).forEach(i=>{if(i.startsWith(n)){const s=i.replace(n,""),o=e[i];r[s]=o}}),r}function Qd(e){const t=e.indexOf(":"),r=e.indexOf("?")!==-1?e.indexOf("?"):void 0,n=e.substring(0,t),i=e.substring(t+1,r).split("@"),s=typeof r<"u"?e.substring(r):"",o=Tr.parse(s);return{protocol:n,topic:i[0],version:parseInt(i[1],10),symKey:o.symKey,relay:Zd(o)}}function ep(e,t="-"){const r="relay",n={};return Object.keys(e).forEach(i=>{const s=r+t+i;e[i]&&(n[s]=e[i])}),n}function tp(e){return`${e.protocol}:${e.topic}@${e.version}?`+Tr.stringify(Jd({symKey:e.symKey},ep(e.relay)))}function Rr(e){const t=[];return e.forEach(r=>{const[n,i]=r.split(":");t.push(`${n}:${i}`)}),t}function rp(e){const t=[];return Object.values(e).forEach(r=>{t.push(...Rr(r.accounts))}),t}function np(e,t){const r=[];return Object.values(e).forEach(n=>{Rr(n.accounts).includes(t)&&r.push(...n.methods)}),r}function ip(e,t){const r=[];return Object.values(e).forEach(n=>{Rr(n.accounts).includes(t)&&r.push(...n.events)}),r}function sp(e,t){const r=on(e,t);if(r)throw new Error(r.message);const n={};for(const[i,s]of Object.entries(e))n[i]={methods:s.methods,events:s.events,chains:s.accounts.map(o=>`${o.split(":")[0]}:${o.split(":")[1]}`)};return n}const op={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},ap={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function H(e,t){const{message:r,code:n}=ap[e];return{message:t?`${r} ${t}`:r,code:n}}function qe(e,t){const{message:r,code:n}=op[e];return{message:t?`${r} ${t}`:r,code:n}}function nn(e,t){return Array.isArray(e)?typeof t<"u"&&e.length?e.every(t):!0:!1}function sn(e){return Object.getPrototypeOf(e)===Object.prototype&&Object.keys(e).length}function _t(e){return typeof e>"u"}function et(e,t){return t&&_t(e)?!0:typeof e=="string"&&Boolean(e.trim().length)}function _i(e,t){return t&&_t(e)?!0:typeof e=="number"&&!isNaN(e)}function cp(e,t){const{requiredNamespaces:r}=t,n=Object.keys(e.namespaces),i=Object.keys(r);let s=!0;return Ut(i,n)?(n.forEach(o=>{const{accounts:c,methods:h,events:f}=e.namespaces[o],l=Rr(c),m=r[o];(!Ut(m.chains,l)||!Ut(m.methods,h)||!Ut(m.events,f))&&(s=!1)}),s):!1}function yi(e){return et(e,!1)&&e.includes(":")?e.split(":").length===2:!1}function up(e){if(et(e,!1)&&e.includes(":")){const t=e.split(":");if(t.length===3){const r=t[0]+":"+t[1];return!!t[2]&&yi(r)}}return!1}function fp(e){if(et(e,!1))try{return typeof new URL(e)<"u"}catch{return!1}return!1}function hp(e){var t;return(t=e?.proposer)==null?void 0:t.publicKey}function lp(e){return e?.topic}function dp(e,t){let r=null;return et(e?.publicKey,!1)||(r=H("MISSING_OR_INVALID",`${t} controller public key should be a string`)),r}function Bo(e){let t=!0;return nn(e)?e.length&&(t=e.every(r=>et(r,!1))):t=!1,t}function pp(e,t,r){let n=null;return nn(t)?t.forEach(i=>{n||(!yi(i)||!i.includes(e))&&(n=qe("UNSUPPORTED_CHAINS",`${r}, chain ${i} should be a string and conform to "namespace:chainId" format`))}):n=qe("UNSUPPORTED_CHAINS",`${r}, chains ${t} should be an array of strings conforming to "namespace:chainId" format`),n}function gp(e,t){let r=null;return Object.entries(e).forEach(([n,i])=>{if(r)return;const s=pp(n,i?.chains,`${t} requiredNamespace`);s&&(r=s)}),r}function _p(e,t){let r=null;return nn(e)?e.forEach(n=>{r||up(n)||(r=qe("UNSUPPORTED_ACCOUNTS",`${t}, account ${n} should be a string and conform to "namespace:chainId:address" format`))}):r=qe("UNSUPPORTED_ACCOUNTS",`${t}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function yp(e,t){let r=null;return Object.values(e).forEach(n=>{if(r)return;const i=_p(n?.accounts,`${t} namespace`);i&&(r=i)}),r}function bp(e,t){let r=null;return Bo(e?.methods)?Bo(e?.events)||(r=qe("UNSUPPORTED_EVENTS",`${t}, events should be an array of strings or empty array for no events`)):r=qe("UNSUPPORTED_METHODS",`${t}, methods should be an array of strings or empty array for no methods`),r}function Ko(e,t){let r=null;return Object.values(e).forEach(n=>{if(r)return;const i=bp(n,`${t}, namespace`);i&&(r=i)}),r}function wp(e,t){let r=null;if(e&&sn(e)){const n=Ko(e,t);n&&(r=n);const i=gp(e,t);i&&(r=i)}else r=H("MISSING_OR_INVALID",`${t}, requiredNamespaces should be an object with data`);return r}function on(e,t){let r=null;if(e&&sn(e)){const n=Ko(e,t);n&&(r=n);const i=yp(e,t);i&&(r=i)}else r=H("MISSING_OR_INVALID",`${t}, namespaces should be an object with data`);return r}function qo(e){return et(e.protocol,!0)}function vp(e,t){let r=!1;return t&&!e?r=!0:e&&nn(e)&&e.length&&e.forEach(n=>{r=qo(n)}),r}function mp(e){return typeof e=="number"}function lt(e){return typeof e<"u"&&typeof e!==null}function Ep(e){return!(!e||typeof e!="object"||!e.code||!_i(e.code,!1)||!e.message||!et(e.message,!1))}function Dp(e){return!(_t(e)||!et(e.method,!1))}function Sp(e){return!(_t(e)||_t(e.result)&&_t(e.error)||!_i(e.id,!1)||!et(e.jsonrpc,!1))}function xp(e){return!(_t(e)||!et(e.name,!1))}function Ho(e,t){return!(!yi(t)||!rp(e).includes(t))}function Op(e,t,r){return et(r,!1)?np(e,t).includes(r):!1}function Ip(e,t,r){return et(r,!1)?ip(e,t).includes(r):!1}function Vo(e,t,r){let n=null;const i=Object.keys(e),s=Object.keys(t);return Ut(i,s)?i.forEach(o=>{if(n)return;const c=e[o].chains,h=Rr(t[o].accounts);Ut(c,h)?Ut(e[o].methods,t[o].methods)?Ut(e[o].events,t[o].events)||(n=H("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy requiredNamespaces events for ${o}`)):n=H("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy requiredNamespaces methods for ${o}`):n=H("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy requiredNamespaces chains for ${o}`)}):n=H("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces`),n}function Tp(e,t){return _i(e,!1)&&e<=t.max&&e>=t.min}const Np="PARSE_ERROR",Ap="INVALID_REQUEST",Rp="METHOD_NOT_FOUND",Pp="INVALID_PARAMS",Go="INTERNAL_ERROR",bi="SERVER_ERROR",Cp=[-32700,-32600,-32601,-32602,-32603],Pr={[Np]:{code:-32700,message:"Parse error"},[Ap]:{code:-32600,message:"Invalid Request"},[Rp]:{code:-32601,message:"Method not found"},[Pp]:{code:-32602,message:"Invalid params"},[Go]:{code:-32603,message:"Internal error"},[bi]:{code:-32e3,message:"Server error"}},Wo=bi;function Fp(e){return Cp.includes(e)}function Yo(e){return Object.keys(Pr).includes(e)?Pr[e]:Pr[Wo]}function Lp(e){const t=Object.values(Pr).find(r=>r.code===e);return t||Pr[Wo]}function Up(e,t,r){return e.message.includes("getaddrinfo ENOTFOUND")||e.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${t}`):e}var ko={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var wi=function(e,t){return wi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},wi(e,t)};function $p(e,t){wi(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var vi=function(){return vi=Object.assign||function(t){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},vi.apply(this,arguments)};function Mp(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function jp(e,t,r,n){var i=arguments.length,s=i<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(e,t,r,n);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(s=(i<3?o(s):i>3?o(t,r,s):o(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s}function zp(e,t){return function(r,n){t(r,n,e)}}function Bp(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}function Kp(e,t,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function c(l){try{f(n.next(l))}catch(m){o(m)}}function h(l){try{f(n.throw(l))}catch(m){o(m)}}function f(l){l.done?s(l.value):i(l.value).then(c,h)}f((n=n.apply(e,t||[])).next())})}function qp(e,t){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(f){return function(l){return h([f,l])}}function h(f){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=f[0]&2?i.return:f[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,f[1])).done)return s;switch(i=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return r.label++,{value:f[1],done:!1};case 5:r.label++,i=f[1],f=[0];continue;case 7:f=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){r=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){r.label=f[1];break}if(f[0]===6&&r.label<s[1]){r.label=s[1],s=f;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(f);break}s[2]&&r.ops.pop(),r.trys.pop();continue}f=t.call(e,r)}catch(l){f=[6,l],i=0}finally{n=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function Hp(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}function Vp(e,t){for(var r in e)r!=="default"&&!t.hasOwnProperty(r)&&(t[r]=e[r])}function mi(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Xo(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),i,s=[],o;try{for(;(t===void 0||t-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(c){o={error:c}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return s}function Gp(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Xo(arguments[t]));return e}function Wp(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),i=0,t=0;t<r;t++)for(var s=arguments[t],o=0,c=s.length;o<c;o++,i++)n[i]=s[o];return n}function Cr(e){return this instanceof Cr?(this.v=e,this):new Cr(e)}function Yp(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(e,t||[]),i,s=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(b){n[b]&&(i[b]=function(w){return new Promise(function(D,P){s.push([b,w,D,P])>1||c(b,w)})})}function c(b,w){try{h(n[b](w))}catch(D){m(s[0][3],D)}}function h(b){b.value instanceof Cr?Promise.resolve(b.value.v).then(f,l):m(s[0][2],b)}function f(b){c("next",b)}function l(b){c("throw",b)}function m(b,w){b(w),s.shift(),s.length&&c(s[0][0],s[0][1])}}function kp(e){var t,r;return t={},n("next"),n("throw",function(i){throw i}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(i,s){t[i]=e[i]?function(o){return(r=!r)?{value:Cr(e[i](o)),done:i==="return"}:s?s(o):o}:s}}function Xp(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof mi=="function"?mi(e):e[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=e[s]&&function(o){return new Promise(function(c,h){o=e[s](o),i(c,h,o.done,o.value)})}}function i(s,o,c,h){Promise.resolve(h).then(function(f){s({value:f,done:c})},o)}}function Jp(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function Zp(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function Qp(e){return e&&e.__esModule?e:{default:e}}function eg(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}function tg(e,t,r){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,r),r}var rg=Object.freeze({__proto__:null,__extends:$p,get __assign(){return vi},__rest:Mp,__decorate:jp,__param:zp,__metadata:Bp,__awaiter:Kp,__generator:qp,__createBinding:Hp,__exportStar:Vp,__values:mi,__read:Xo,__spread:Gp,__spreadArrays:Wp,__await:Cr,__asyncGenerator:Yp,__asyncDelegator:kp,__asyncValues:Xp,__makeTemplateObject:Jp,__importStar:Zp,__importDefault:Qp,__classPrivateFieldGet:eg,__classPrivateFieldSet:tg}),ng=qt(rg),Nt={},Jo;function ig(){if(Jo)return Nt;Jo=1,Object.defineProperty(Nt,"__esModule",{value:!0}),Nt.isBrowserCryptoAvailable=Nt.getSubtleCrypto=Nt.getBrowerCrypto=void 0;function e(){return Ze?.crypto||Ze?.msCrypto||{}}Nt.getBrowerCrypto=e;function t(){const n=e();return n.subtle||n.webkitSubtle}Nt.getSubtleCrypto=t;function r(){return!!e()&&!!t()}return Nt.isBrowserCryptoAvailable=r,Nt}var At={},Zo;function sg(){if(Zo)return At;Zo=1,Object.defineProperty(At,"__esModule",{value:!0}),At.isBrowser=At.isNode=At.isReactNative=void 0;function e(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}At.isReactNative=e;function t(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}At.isNode=t;function r(){return!e()&&!t()}return At.isBrowser=r,At}(function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=ng;t.__exportStar(ig(),e),t.__exportStar(sg(),e)})(ko);function og(){const e=Date.now()*Math.pow(10,3),t=Math.floor(Math.random()*Math.pow(10,3));return e+t}function an(e,t,r){return{id:r||og(),jsonrpc:"2.0",method:e,params:t}}function Ei(e,t){return{id:e,jsonrpc:"2.0",result:t}}function Di(e,t,r){return{id:e,jsonrpc:"2.0",error:ag(t,r)}}function ag(e,t){return typeof e>"u"?Yo(Go):(typeof e=="string"&&(e=Object.assign(Object.assign({},Yo(bi)),{message:e})),typeof t<"u"&&(e.data=t),Fp(e.code)&&(e=Lp(e.code)),e)}class cg{}class ug extends cg{constructor(){super()}}class fg extends ug{constructor(t){super()}}const hg="^wss?:";function lg(e){const t=e.match(new RegExp(/^\w+:/,"gi"));if(!(!t||!t.length))return t[0]}function dg(e,t){const r=lg(e);return typeof r>"u"?!1:new RegExp(t).test(r)}function Qo(e){return dg(e,hg)}function pg(e){return new RegExp("wss?://localhost(:d{2,5})?").test(e)}function ea(e){return typeof e=="object"&&"id"in e&&"jsonrpc"in e&&e.jsonrpc==="2.0"}function Si(e){return ea(e)&&"method"in e}function xi(e){return ea(e)&&(Rt(e)||vt(e))}function Rt(e){return"result"in e}function vt(e){return"error"in e}class gg extends fg{constructor(t){super(t),this.events=new ct.exports.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(t),this.connection.connected&&this.registerEventListeners()}async connect(t=this.connection){await this.open(t)}async disconnect(){await this.close()}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async request(t,r){return this.requestStrict(an(t.method,t.params||[]),r)}async requestStrict(t,r){return new Promise(async(n,i)=>{if(!this.connection.connected)try{await this.open()}catch(s){i(s)}this.events.on(`${t.id}`,s=>{vt(s)?i(s.error):n(s.result)});try{await this.connection.send(t,r)}catch(s){i(s)}})}setConnection(t=this.connection){return t}onPayload(t){this.events.emit("payload",t),xi(t)?this.events.emit(`${t.id}`,t):this.events.emit("message",{type:t.method,data:t.params})}async open(t=this.connection){this.connection===t&&this.connection.connected||(this.connection.connected&&this.close(),typeof t=="string"&&(await this.connection.open(t),t=this.connection),this.connection=this.setConnection(t),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",t=>this.onPayload(t)),this.connection.on("close",()=>this.events.emit("disconnect")),this.connection.on("error",t=>this.events.emit("error",t)),this.hasRegisteredEventListeners=!0)}}const ta=10,_g=()=>typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:require("ws"),yg=()=>typeof window<"u",bg=_g();class wg{constructor(t){if(this.url=t,this.events=new ct.exports.EventEmitter,this.registering=!1,!Qo(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);this.url=t}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async open(t=this.url){await this.register(t)}async close(){if(typeof this.socket>"u")throw new Error("Connection already closed");this.socket.close(),this.onClose()}async send(t,r){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Hn(t))}catch(n){this.onError(t.id,n)}}register(t=this.url){if(!Qo(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((n,i)=>{this.events.once("register_error",s=>{this.resetMaxListeners(),i(s)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return i(new Error("WebSocket connection is missing or invalid"));n(this.socket)})})}return this.url=t,this.registering=!0,new Promise((r,n)=>{const i=ko.isReactNative()?void 0:{rejectUnauthorized:!pg(t)},s=new bg(t,[],i);yg()?s.onerror=o=>{const c=o;n(this.emitError(c.error))}:s.on("error",o=>{n(this.emitError(o))}),s.onopen=()=>{this.onOpen(s),r(s)}})}onOpen(t){t.onmessage=r=>this.onPayload(r),t.onclose=()=>this.onClose(),this.socket=t,this.registering=!1,this.events.emit("open")}onClose(){this.socket=void 0,this.registering=!1,this.events.emit("close")}onPayload(t){if(typeof t.data>"u")return;const r=typeof t.data=="string"?Ts(t.data):t.data;this.events.emit("payload",r)}onError(t,r){const n=this.parseError(r),i=n.message||n.toString(),s=Di(t,i);this.events.emit("payload",s)}parseError(t,r=this.url){return Up(t,r,"WS")}resetMaxListeners(){this.events.getMaxListeners()>ta&&this.events.setMaxListeners(ta)}emitError(t){const r=this.parseError(new Error(t?.message||`WebSocket connection failed for URL: ${this.url}`));return this.events.emit("register_error",r),r}}var Oi={exports:{}};(function(e,t){var r=200,n="__lodash_hash_undefined__",i=1,s=2,o=9007199254740991,c="[object Arguments]",h="[object Array]",f="[object AsyncFunction]",l="[object Boolean]",m="[object Date]",b="[object Error]",w="[object Function]",D="[object GeneratorFunction]",P="[object Map]",R="[object Number]",$="[object Null]",E="[object Object]",O="[object Promise]",g="[object Proxy]",v="[object RegExp]",y="[object Set]",a="[object String]",p="[object Symbol]",L="[object Undefined]",z="[object WeakMap]",k="[object ArrayBuffer]",X="[object DataView]",J="[object Float32Array]",A="[object Float64Array]",N="[object Int8Array]",W="[object Int16Array]",j="[object Int32Array]",F="[object Uint8Array]",U="[object Uint8ClampedArray]",M="[object Uint16Array]",B="[object Uint32Array]",ne=/[\\^$.*+?()[\]{}|]/g,K=/^\[object .+?Constructor\]$/,Q=/^(?:0|[1-9]\d*)$/,Y={};Y[J]=Y[A]=Y[N]=Y[W]=Y[j]=Y[F]=Y[U]=Y[M]=Y[B]=!0,Y[c]=Y[h]=Y[k]=Y[l]=Y[X]=Y[m]=Y[b]=Y[w]=Y[P]=Y[R]=Y[E]=Y[v]=Y[y]=Y[a]=Y[z]=!1;var ae=typeof Ze=="object"&&Ze&&Ze.Object===Object&&Ze,T=typeof self=="object"&&self&&self.Object===Object&&self,I=ae||T||Function("return this")(),S=t&&!t.nodeType&&t,u=S&&!0&&e&&!e.nodeType&&e,_=u&&u.exports===S,q=_&&ae.process,V=function(){try{return q&&q.binding&&q.binding("util")}catch{}}(),he=V&&V.isTypedArray;function ye(d,x){for(var C=-1,G=d==null?0:d.length,Te=0,ie=[];++C<G;){var Fe=d[C];x(Fe,C,d)&&(ie[Te++]=Fe)}return ie}function de(d,x){for(var C=-1,G=x.length,Te=d.length;++C<G;)d[Te+C]=x[C];return d}function ve(d,x){for(var C=-1,G=d==null?0:d.length;++C<G;)if(x(d[C],C,d))return!0;return!1}function Ue(d,x){for(var C=-1,G=Array(d);++C<d;)G[C]=x(C);return G}function Re(d){return function(x){return d(x)}}function _e(d,x){return d.has(x)}function pe(d,x){return d?.[x]}function le(d){var x=-1,C=Array(d.size);return d.forEach(function(G,Te){C[++x]=[Te,G]}),C}function ue(d,x){return function(C){return d(x(C))}}function ce(d){var x=-1,C=Array(d.size);return d.forEach(function(G){C[++x]=G}),C}var oe=Array.prototype,se=Function.prototype,ee=Object.prototype,fe=I["__core-js_shared__"],ge=se.toString,re=ee.hasOwnProperty,be=function(){var d=/[^.]+$/.exec(fe&&fe.keys&&fe.keys.IE_PROTO||"");return d?"Symbol(src)_1."+d:""}(),we=ee.toString,Ee=RegExp("^"+ge.call(re).replace(ne,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),De=_?I.Buffer:void 0,me=I.Symbol,mt=I.Uint8Array,Tt=ee.propertyIsEnumerable,jt=oe.splice,pt=me?me.toStringTag:void 0,Zt=Object.getOwnPropertySymbols,$r=De?De.isBuffer:void 0,_n=ue(Object.keys,Object),$e=fr(I,"DataView"),Pe=fr(I,"Map"),Me=fr(I,"Promise"),je=fr(I,"Set"),ze=fr(I,"WeakMap"),Ce=fr(Object,"create"),He=er($e),Ve=er(Pe),Ge=er(Me),We=er(je),Ye=er(ze),Ke=me?me.prototype:void 0,Be=Ke?Ke.valueOf:void 0;function Ne(d){var x=-1,C=d==null?0:d.length;for(this.clear();++x<C;){var G=d[x];this.set(G[0],G[1])}}function ke(){this.__data__=Ce?Ce(null):{},this.size=0}function Xe(d){var x=this.has(d)&&delete this.__data__[d];return this.size-=x?1:0,x}function oy(d){var x=this.__data__;if(Ce){var C=x[d];return C===n?void 0:C}return re.call(x,d)?x[d]:void 0}function ay(d){var x=this.__data__;return Ce?x[d]!==void 0:re.call(x,d)}function cy(d,x){var C=this.__data__;return this.size+=this.has(d)?0:1,C[d]=Ce&&x===void 0?n:x,this}Ne.prototype.clear=ke,Ne.prototype.delete=Xe,Ne.prototype.get=oy,Ne.prototype.has=ay,Ne.prototype.set=cy;function Ct(d){var x=-1,C=d==null?0:d.length;for(this.clear();++x<C;){var G=d[x];this.set(G[0],G[1])}}function uy(){this.__data__=[],this.size=0}function fy(d){var x=this.__data__,C=bn(x,d);if(C<0)return!1;var G=x.length-1;return C==G?x.pop():jt.call(x,C,1),--this.size,!0}function hy(d){var x=this.__data__,C=bn(x,d);return C<0?void 0:x[C][1]}function ly(d){return bn(this.__data__,d)>-1}function dy(d,x){var C=this.__data__,G=bn(C,d);return G<0?(++this.size,C.push([d,x])):C[G][1]=x,this}Ct.prototype.clear=uy,Ct.prototype.delete=fy,Ct.prototype.get=hy,Ct.prototype.has=ly,Ct.prototype.set=dy;function Qt(d){var x=-1,C=d==null?0:d.length;for(this.clear();++x<C;){var G=d[x];this.set(G[0],G[1])}}function py(){this.size=0,this.__data__={hash:new Ne,map:new(Pe||Ct),string:new Ne}}function gy(d){var x=wn(this,d).delete(d);return this.size-=x?1:0,x}function _y(d){return wn(this,d).get(d)}function yy(d){return wn(this,d).has(d)}function by(d,x){var C=wn(this,d),G=C.size;return C.set(d,x),this.size+=C.size==G?0:1,this}Qt.prototype.clear=py,Qt.prototype.delete=gy,Qt.prototype.get=_y,Qt.prototype.has=yy,Qt.prototype.set=by;function yn(d){var x=-1,C=d==null?0:d.length;for(this.__data__=new Qt;++x<C;)this.add(d[x])}function wy(d){return this.__data__.set(d,n),this}function vy(d){return this.__data__.has(d)}yn.prototype.add=yn.prototype.push=wy,yn.prototype.has=vy;function zt(d){var x=this.__data__=new Ct(d);this.size=x.size}function my(){this.__data__=new Ct,this.size=0}function Ey(d){var x=this.__data__,C=x.delete(d);return this.size=x.size,C}function Dy(d){return this.__data__.get(d)}function Sy(d){return this.__data__.has(d)}function xy(d,x){var C=this.__data__;if(C instanceof Ct){var G=C.__data__;if(!Pe||G.length<r-1)return G.push([d,x]),this.size=++C.size,this;C=this.__data__=new Qt(G)}return C.set(d,x),this.size=C.size,this}zt.prototype.clear=my,zt.prototype.delete=Ey,zt.prototype.get=Dy,zt.prototype.has=Sy,zt.prototype.set=xy;function Oy(d,x){var C=vn(d),G=!C&&By(d),Te=!C&&!G&&$i(d),ie=!C&&!G&&!Te&&Ya(d),Fe=C||G||Te||ie,Je=Fe?Ue(d.length,String):[],rt=Je.length;for(var Ae in d)(x||re.call(d,Ae))&&!(Fe&&(Ae=="length"||Te&&(Ae=="offset"||Ae=="parent")||ie&&(Ae=="buffer"||Ae=="byteLength"||Ae=="byteOffset")||Uy(Ae,rt)))&&Je.push(Ae);return Je}function bn(d,x){for(var C=d.length;C--;)if(Ha(d[C][0],x))return C;return-1}function Iy(d,x,C){var G=x(d);return vn(d)?G:de(G,C(d))}function Mr(d){return d==null?d===void 0?L:$:pt&&pt in Object(d)?Fy(d):zy(d)}function za(d){return jr(d)&&Mr(d)==c}function Ba(d,x,C,G,Te){return d===x?!0:d==null||x==null||!jr(d)&&!jr(x)?d!==d&&x!==x:Ty(d,x,C,G,Ba,Te)}function Ty(d,x,C,G,Te,ie){var Fe=vn(d),Je=vn(x),rt=Fe?h:Bt(d),Ae=Je?h:Bt(x);rt=rt==c?E:rt,Ae=Ae==c?E:Ae;var gt=rt==E,Et=Ae==E,st=rt==Ae;if(st&&$i(d)){if(!$i(x))return!1;Fe=!0,gt=!1}if(st&&!gt)return ie||(ie=new zt),Fe||Ya(d)?Ka(d,x,C,G,Te,ie):Py(d,x,rt,C,G,Te,ie);if(!(C&i)){var bt=gt&&re.call(d,"__wrapped__"),wt=Et&&re.call(x,"__wrapped__");if(bt||wt){var Kt=bt?d.value():d,Ft=wt?x.value():x;return ie||(ie=new zt),Te(Kt,Ft,C,G,ie)}}return st?(ie||(ie=new zt),Cy(d,x,C,G,Te,ie)):!1}function Ny(d){if(!Wa(d)||My(d))return!1;var x=Va(d)?Ee:K;return x.test(er(d))}function Ay(d){return jr(d)&&Ga(d.length)&&!!Y[Mr(d)]}function Ry(d){if(!jy(d))return _n(d);var x=[];for(var C in Object(d))re.call(d,C)&&C!="constructor"&&x.push(C);return x}function Ka(d,x,C,G,Te,ie){var Fe=C&i,Je=d.length,rt=x.length;if(Je!=rt&&!(Fe&&rt>Je))return!1;var Ae=ie.get(d);if(Ae&&ie.get(x))return Ae==x;var gt=-1,Et=!0,st=C&s?new yn:void 0;for(ie.set(d,x),ie.set(x,d);++gt<Je;){var bt=d[gt],wt=x[gt];if(G)var Kt=Fe?G(wt,bt,gt,x,d,ie):G(bt,wt,gt,d,x,ie);if(Kt!==void 0){if(Kt)continue;Et=!1;break}if(st){if(!ve(x,function(Ft,tr){if(!_e(st,tr)&&(bt===Ft||Te(bt,Ft,C,G,ie)))return st.push(tr)})){Et=!1;break}}else if(!(bt===wt||Te(bt,wt,C,G,ie))){Et=!1;break}}return ie.delete(d),ie.delete(x),Et}function Py(d,x,C,G,Te,ie,Fe){switch(C){case X:if(d.byteLength!=x.byteLength||d.byteOffset!=x.byteOffset)return!1;d=d.buffer,x=x.buffer;case k:return!(d.byteLength!=x.byteLength||!ie(new mt(d),new mt(x)));case l:case m:case R:return Ha(+d,+x);case b:return d.name==x.name&&d.message==x.message;case v:case a:return d==x+"";case P:var Je=le;case y:var rt=G&i;if(Je||(Je=ce),d.size!=x.size&&!rt)return!1;var Ae=Fe.get(d);if(Ae)return Ae==x;G|=s,Fe.set(d,x);var gt=Ka(Je(d),Je(x),G,Te,ie,Fe);return Fe.delete(d),gt;case p:if(Be)return Be.call(d)==Be.call(x)}return!1}function Cy(d,x,C,G,Te,ie){var Fe=C&i,Je=qa(d),rt=Je.length,Ae=qa(x),gt=Ae.length;if(rt!=gt&&!Fe)return!1;for(var Et=rt;Et--;){var st=Je[Et];if(!(Fe?st in x:re.call(x,st)))return!1}var bt=ie.get(d);if(bt&&ie.get(x))return bt==x;var wt=!0;ie.set(d,x),ie.set(x,d);for(var Kt=Fe;++Et<rt;){st=Je[Et];var Ft=d[st],tr=x[st];if(G)var ka=Fe?G(tr,Ft,st,x,d,ie):G(Ft,tr,st,d,x,ie);if(!(ka===void 0?Ft===tr||Te(Ft,tr,C,G,ie):ka)){wt=!1;break}Kt||(Kt=st=="constructor")}if(wt&&!Kt){var mn=d.constructor,En=x.constructor;mn!=En&&"constructor"in d&&"constructor"in x&&!(typeof mn=="function"&&mn instanceof mn&&typeof En=="function"&&En instanceof En)&&(wt=!1)}return ie.delete(d),ie.delete(x),wt}function qa(d){return Iy(d,Hy,Ly)}function wn(d,x){var C=d.__data__;return $y(x)?C[typeof x=="string"?"string":"hash"]:C.map}function fr(d,x){var C=pe(d,x);return Ny(C)?C:void 0}function Fy(d){var x=re.call(d,pt),C=d[pt];try{d[pt]=void 0;var G=!0}catch{}var Te=we.call(d);return G&&(x?d[pt]=C:delete d[pt]),Te}var Ly=Zt?function(d){return d==null?[]:(d=Object(d),ye(Zt(d),function(x){return Tt.call(d,x)}))}:Vy,Bt=Mr;($e&&Bt(new $e(new ArrayBuffer(1)))!=X||Pe&&Bt(new Pe)!=P||Me&&Bt(Me.resolve())!=O||je&&Bt(new je)!=y||ze&&Bt(new ze)!=z)&&(Bt=function(d){var x=Mr(d),C=x==E?d.constructor:void 0,G=C?er(C):"";if(G)switch(G){case He:return X;case Ve:return P;case Ge:return O;case We:return y;case Ye:return z}return x});function Uy(d,x){return x=x??o,!!x&&(typeof d=="number"||Q.test(d))&&d>-1&&d%1==0&&d<x}function $y(d){var x=typeof d;return x=="string"||x=="number"||x=="symbol"||x=="boolean"?d!=="__proto__":d===null}function My(d){return!!be&&be in d}function jy(d){var x=d&&d.constructor,C=typeof x=="function"&&x.prototype||ee;return d===C}function zy(d){return we.call(d)}function er(d){if(d!=null){try{return ge.call(d)}catch{}try{return d+""}catch{}}return""}function Ha(d,x){return d===x||d!==d&&x!==x}var By=za(function(){return arguments}())?za:function(d){return jr(d)&&re.call(d,"callee")&&!Tt.call(d,"callee")},vn=Array.isArray;function Ky(d){return d!=null&&Ga(d.length)&&!Va(d)}var $i=$r||Gy;function qy(d,x){return Ba(d,x)}function Va(d){if(!Wa(d))return!1;var x=Mr(d);return x==w||x==D||x==f||x==g}function Ga(d){return typeof d=="number"&&d>-1&&d%1==0&&d<=o}function Wa(d){var x=typeof d;return d!=null&&(x=="object"||x=="function")}function jr(d){return d!=null&&typeof d=="object"}var Ya=he?Re(he):Ay;function Hy(d){return Ky(d)?Oy(d):Ry(d)}function Vy(){return[]}function Gy(){return!1}e.exports=qy})(Oi,Oi.exports);var vg=Oi.exports,mg=Object.defineProperty,ra=Object.getOwnPropertySymbols,Eg=Object.prototype.hasOwnProperty,Dg=Object.prototype.propertyIsEnumerable,na=(e,t,r)=>t in e?mg(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,at=(e,t)=>{for(var r in t||(t={}))Eg.call(t,r)&&na(e,r,t[r]);if(ra)for(var r of ra(t))Dg.call(t,r)&&na(e,r,t[r]);return e};function Sg(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var s=e.charAt(i),o=s.charCodeAt(0);if(r[o]!==255)throw new TypeError(s+" is ambiguous");r[o]=i}var c=e.length,h=e.charAt(0),f=Math.log(c)/Math.log(256),l=Math.log(256)/Math.log(c);function m(D){if(D instanceof Uint8Array||(ArrayBuffer.isView(D)?D=new Uint8Array(D.buffer,D.byteOffset,D.byteLength):Array.isArray(D)&&(D=Uint8Array.from(D))),!(D instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(D.length===0)return"";for(var P=0,R=0,$=0,E=D.length;$!==E&&D[$]===0;)$++,P++;for(var O=(E-$)*l+1>>>0,g=new Uint8Array(O);$!==E;){for(var v=D[$],y=0,a=O-1;(v!==0||y<R)&&a!==-1;a--,y++)v+=256*g[a]>>>0,g[a]=v%c>>>0,v=v/c>>>0;if(v!==0)throw new Error("Non-zero carry");R=y,$++}for(var p=O-R;p!==O&&g[p]===0;)p++;for(var L=h.repeat(P);p<O;++p)L+=e.charAt(g[p]);return L}function b(D){if(typeof D!="string")throw new TypeError("Expected String");if(D.length===0)return new Uint8Array;var P=0;if(D[P]!==" "){for(var R=0,$=0;D[P]===h;)R++,P++;for(var E=(D.length-P)*f+1>>>0,O=new Uint8Array(E);D[P];){var g=r[D.charCodeAt(P)];if(g===255)return;for(var v=0,y=E-1;(g!==0||v<$)&&y!==-1;y--,v++)g+=c*O[y]>>>0,O[y]=g%256>>>0,g=g/256>>>0;if(g!==0)throw new Error("Non-zero carry");$=v,P++}if(D[P]!==" "){for(var a=E-$;a!==E&&O[a]===0;)a++;for(var p=new Uint8Array(R+(E-a)),L=R;a!==E;)p[L++]=O[a++];return p}}}function w(D){var P=b(D);if(P)return P;throw new Error(`Non-${t} character`)}return{encode:m,decodeUnsafe:b,decode:w}}var xg=Sg,Og=xg;const ia=e=>{if(e instanceof Uint8Array&&e.constructor.name==="Uint8Array")return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},Ig=e=>new TextEncoder().encode(e),Tg=e=>new TextDecoder().decode(e);class Ng{constructor(t,r,n){this.name=t,this.prefix=r,this.baseEncode=n}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class Ag{constructor(t,r,n){if(this.name=t,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return sa(this,t)}}class Rg{constructor(t){this.decoders=t}or(t){return sa(this,t)}decode(t){const r=t[0],n=this.decoders[r];if(n)return n.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const sa=(e,t)=>new Rg(at(at({},e.decoders||{[e.prefix]:e}),t.decoders||{[t.prefix]:t}));class Pg{constructor(t,r,n,i){this.name=t,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new Ng(t,r,n),this.decoder=new Ag(t,r,i)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const cn=({name:e,prefix:t,encode:r,decode:n})=>new Pg(e,t,r,n),Fr=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:i}=Og(r,t);return cn({prefix:e,name:t,encode:n,decode:s=>ia(i(s))})},Cg=(e,t,r,n)=>{const i={};for(let l=0;l<t.length;++l)i[t[l]]=l;let s=e.length;for(;e[s-1]==="=";)--s;const o=new Uint8Array(s*r/8|0);let c=0,h=0,f=0;for(let l=0;l<s;++l){const m=i[e[l]];if(m===void 0)throw new SyntaxError(`Non-${n} character`);h=h<<r|m,c+=r,c>=8&&(c-=8,o[f++]=255&h>>c)}if(c>=r||255&h<<8-c)throw new SyntaxError("Unexpected end of data");return o},Fg=(e,t,r)=>{const n=t[t.length-1]==="=",i=(1<<r)-1;let s="",o=0,c=0;for(let h=0;h<e.length;++h)for(c=c<<8|e[h],o+=8;o>r;)o-=r,s+=t[i&c>>o];if(o&&(s+=t[i&c<<r-o]),n)for(;s.length*r&7;)s+="=";return s},tt=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>cn({prefix:t,name:e,encode(i){return Fg(i,n,r)},decode(i){return Cg(i,n,r,e)}}),Lg=cn({prefix:"\0",name:"identity",encode:e=>Tg(e),decode:e=>Ig(e)});var Ug=Object.freeze({__proto__:null,identity:Lg});const $g=tt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Mg=Object.freeze({__proto__:null,base2:$g});const jg=tt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var zg=Object.freeze({__proto__:null,base8:jg});const Bg=Fr({prefix:"9",name:"base10",alphabet:"0123456789"});var Kg=Object.freeze({__proto__:null,base10:Bg});const qg=tt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Hg=tt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Vg=Object.freeze({__proto__:null,base16:qg,base16upper:Hg});const Gg=tt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Wg=tt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Yg=tt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),kg=tt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Xg=tt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Jg=tt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Zg=tt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Qg=tt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),e0=tt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var t0=Object.freeze({__proto__:null,base32:Gg,base32upper:Wg,base32pad:Yg,base32padupper:kg,base32hex:Xg,base32hexupper:Jg,base32hexpad:Zg,base32hexpadupper:Qg,base32z:e0});const r0=Fr({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),n0=Fr({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var i0=Object.freeze({__proto__:null,base36:r0,base36upper:n0});const s0=Fr({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),o0=Fr({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var a0=Object.freeze({__proto__:null,base58btc:s0,base58flickr:o0});const c0=tt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),u0=tt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),f0=tt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),h0=tt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var l0=Object.freeze({__proto__:null,base64:c0,base64pad:u0,base64url:f0,base64urlpad:h0});const oa=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),d0=oa.reduce((e,t,r)=>(e[r]=t,e),[]),p0=oa.reduce((e,t,r)=>(e[t.codePointAt(0)]=r,e),[]);function g0(e){return e.reduce((t,r)=>(t+=d0[r],t),"")}function _0(e){const t=[];for(const r of e){const n=p0[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);t.push(n)}return new Uint8Array(t)}const y0=cn({prefix:"\u{1F680}",name:"base256emoji",encode:g0,decode:_0});var b0=Object.freeze({__proto__:null,base256emoji:y0}),w0=ca,aa=128,v0=127,m0=~v0,E0=Math.pow(2,31);function ca(e,t,r){t=t||[],r=r||0;for(var n=r;e>=E0;)t[r++]=e&255|aa,e/=128;for(;e&m0;)t[r++]=e&255|aa,e>>>=7;return t[r]=e|0,ca.bytes=r-n+1,t}var D0=Ii,S0=128,ua=127;function Ii(e,n){var r=0,n=n||0,i=0,s=n,o,c=e.length;do{if(s>=c)throw Ii.bytes=0,new RangeError("Could not decode varint");o=e[s++],r+=i<28?(o&ua)<<i:(o&ua)*Math.pow(2,i),i+=7}while(o>=S0);return Ii.bytes=s-n,r}var x0=Math.pow(2,7),O0=Math.pow(2,14),I0=Math.pow(2,21),T0=Math.pow(2,28),N0=Math.pow(2,35),A0=Math.pow(2,42),R0=Math.pow(2,49),P0=Math.pow(2,56),C0=Math.pow(2,63),F0=function(e){return e<x0?1:e<O0?2:e<I0?3:e<T0?4:e<N0?5:e<A0?6:e<R0?7:e<P0?8:e<C0?9:10},L0={encode:w0,decode:D0,encodingLength:F0},fa=L0;const ha=(e,t,r=0)=>(fa.encode(e,t,r),t),la=e=>fa.encodingLength(e),Ti=(e,t)=>{const r=t.byteLength,n=la(e),i=n+la(r),s=new Uint8Array(i+r);return ha(e,s,0),ha(r,s,n),s.set(t,i),new U0(e,r,t,s)};class U0{constructor(t,r,n,i){this.code=t,this.size=r,this.digest=n,this.bytes=i}}const da=({name:e,code:t,encode:r})=>new $0(e,t,r);class $0{constructor(t,r,n){this.name=t,this.code=r,this.encode=n}digest(t){if(t instanceof Uint8Array){const r=this.encode(t);return r instanceof Uint8Array?Ti(this.code,r):r.then(n=>Ti(this.code,n))}else throw Error("Unknown type, must be binary type")}}const pa=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),M0=da({name:"sha2-256",code:18,encode:pa("SHA-256")}),j0=da({name:"sha2-512",code:19,encode:pa("SHA-512")});var z0=Object.freeze({__proto__:null,sha256:M0,sha512:j0});const ga=0,B0="identity",_a=ia;var K0=Object.freeze({__proto__:null,identity:{code:ga,name:B0,encode:_a,digest:e=>Ti(ga,_a(e))}});new TextEncoder,new TextDecoder;const ya=at(at(at(at(at(at(at(at(at(at({},Ug),Mg),zg),Kg),Vg),t0),i0),a0),l0),b0);at(at({},z0),K0);function q0(e=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(e):new Uint8Array(e)}function ba(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const wa=ba("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>new TextEncoder().encode(e.substring(1))),Ni=ba("ascii","a",e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},e=>{e=e.substring(1);const t=q0(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}),H0=at({utf8:wa,"utf-8":wa,hex:ya.base16,latin1:Ni,ascii:Ni,binary:Ni},ya);function V0(e,t="utf8"){const r=H0[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(e,"utf8"):r.decoder.decode(`${r.prefix}${e}`)}const va="wc",G0=2,Ai="core",Mt=`${va}@${2}:${Ai}:`,W0={name:Ai,logger:"error"},Y0={database:":memory:"},k0="crypto",ma="client_ed25519_seed",X0=Z.ONE_DAY,J0="keychain",Z0="0.3",Q0="messages",e_="0.3",t_=Z.SIX_HOURS,r_="publisher",Ea="irn",n_="error",i_="wss://relay.walletconnect.com",s_="relayer",it={message:"relayer_message",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},o_="_subscription",un={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},Da=Z.ONE_SECOND,a_="2.3.3",c_="0.3",Ot={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},u_="subscription",f_="0.3",h_=Z.FIVE_SECONDS*1e3,l_="pairing",d_="0.3",Lr={wc_pairingDelete:{req:{ttl:Z.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:Z.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:Z.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:Z.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:Z.ONE_DAY,prompt:!1,tag:0},res:{ttl:Z.ONE_DAY,prompt:!1,tag:0}}},It={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},p_="history",g_="0.3",__="expirer",yt={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},y_="0.3";class b_{constructor(t,r){this.core=t,this.logger=r,this.keychain=new Map,this.name=J0,this.version=Z0,this.initialized=!1,this.storagePrefix=Mt,this.init=async()=>{if(!this.initialized){const n=await this.getKeyChain();typeof n<"u"&&(this.keychain=n),this.initialized=!0}},this.has=n=>(this.isInitialized(),this.keychain.has(n)),this.set=async(n,i)=>{this.isInitialized(),this.keychain.set(n,i),await this.persist()},this.get=n=>{this.isInitialized();const i=this.keychain.get(n);if(typeof i>"u"){const{message:s}=H("NO_MATCHING_KEY",`${this.name}: ${n}`);throw new Error(s)}return i},this.del=async n=>{this.isInitialized(),this.keychain.delete(n),await this.persist()},this.core=t,this.logger=xe.generateChildLogger(r,this.name)}get context(){return xe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(t){await this.core.storage.setItem(this.storageKey,Fo(t))}async getKeyChain(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?Lo(t):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:t}=H("NOT_INITIALIZED",this.name);throw new Error(t)}}}class w_{constructor(t,r,n){this.core=t,this.logger=r,this.name=k0,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=i=>(this.isInitialized(),this.keychain.has(i)),this.getClientId=async()=>{this.isInitialized();const i=await this.getClientSeed(),s=so(i);return io(s.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const i=Dd();return this.setPrivateKey(i.publicKey,i.privateKey)},this.signJWT=async i=>{this.isInitialized();const s=await this.getClientSeed(),o=so(s),c=hi();return await Rl(c,i,X0,o)},this.generateSharedKey=(i,s,o)=>{this.isInitialized();const c=this.getPrivateKey(i),h=Sd(c,s);return this.setSymKey(h,o)},this.setSymKey=async(i,s)=>{this.isInitialized();const o=s||xd(i);return await this.keychain.set(o,i),o},this.deleteKeyPair=async i=>{this.isInitialized(),await this.keychain.del(i)},this.deleteSymKey=async i=>{this.isInitialized(),await this.keychain.del(i)},this.encode=async(i,s,o)=>{this.isInitialized();const c=To(o),h=Hn(s);if(No(c)){const b=c.senderPublicKey,w=c.receiverPublicKey;i=await this.generateSharedKey(b,w)}const f=this.getSymKey(i),{type:l,senderPublicKey:m}=c;return Id({type:l,symKey:f,message:h,senderPublicKey:m})},this.decode=async(i,s,o)=>{this.isInitialized();const c=Ad(s,o);if(No(c)){const l=c.receiverPublicKey,m=c.senderPublicKey;i=await this.generateSharedKey(l,m)}const h=this.getSymKey(i),f=Td({symKey:h,encoded:s});return Ts(f)},this.core=t,this.logger=xe.generateChildLogger(r,this.name),this.keychain=n||new b_(this.core,this.logger)}get context(){return xe.getLoggerContext(this.logger)}getPayloadType(t){const r=di(t);return Nr(r.type)}async setPrivateKey(t,r){return await this.keychain.set(t,r),t}getPrivateKey(t){return this.keychain.get(t)}async getClientSeed(){let t="";try{t=this.keychain.get(ma)}catch{t=hi(),await this.keychain.set(ma,t)}return V0(t,"base16")}getSymKey(t){return this.keychain.get(t)}isInitialized(){if(!this.initialized){const{message:t}=H("NOT_INITIALIZED",this.name);throw new Error(t)}}}class v_ extends pf{constructor(t,r){super(t,r),this.logger=t,this.core=r,this.messages=new Map,this.name=Q0,this.version=e_,this.initialized=!1,this.storagePrefix=Mt,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const n=await this.getRelayerMessages();typeof n<"u"&&(this.messages=n),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(n){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(n)}finally{this.initialized=!0}}},this.set=async(n,i)=>{this.isInitialized();const s=li(i);let o=this.messages.get(n);return typeof o>"u"&&(o={}),typeof o[s]<"u"||(o[s]=i,this.messages.set(n,o),await this.persist()),s},this.get=n=>{this.isInitialized();let i=this.messages.get(n);return typeof i>"u"&&(i={}),i},this.has=(n,i)=>{this.isInitialized();const s=this.get(n),o=li(i);return typeof s[o]<"u"},this.del=async n=>{this.isInitialized(),this.messages.delete(n),await this.persist()},this.logger=xe.generateChildLogger(t,this.name),this.core=r}get context(){return xe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(t){await this.core.storage.setItem(this.storageKey,Fo(t))}async getRelayerMessages(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?Lo(t):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:t}=H("NOT_INITIALIZED",this.name);throw new Error(t)}}}class m_ extends gf{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.events=new ct.exports.EventEmitter,this.name=r_,this.queue=new Map,this.publishTimeout=1e4,this.publish=async(n,i,s)=>{this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:i,opts:s}});try{const o=s?.ttl||t_,c=pi(s),h=s?.prompt||!1,f=s?.tag||0,l={topic:n,message:i,opts:{ttl:o,relay:c,prompt:h,tag:f}},m=li(i);this.queue.set(m,l);try{await await Uo(this.rpcPublish(n,i,o,c,h,f),this.publishTimeout),this.relayer.events.emit(it.publish,l)}catch{this.logger.debug("Publishing Payload stalled"),this.relayer.events.emit(it.connection_stalled);return}this.onPublish(m,l),this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:i,opts:s}})}catch(o){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(o),o}},this.on=(n,i)=>{this.events.on(n,i)},this.once=(n,i)=>{this.events.once(n,i)},this.off=(n,i)=>{this.events.off(n,i)},this.removeListener=(n,i)=>{this.events.removeListener(n,i)},this.relayer=t,this.logger=xe.generateChildLogger(r,this.name),this.registerEventListeners()}get context(){return xe.getLoggerContext(this.logger)}rpcPublish(t,r,n,i,s,o){var c,h,f,l;const m={method:gi(i.protocol).publish,params:{topic:t,message:r,ttl:n,prompt:s,tag:o}};return _t((c=m.params)==null?void 0:c.prompt)&&((h=m.params)==null||delete h.prompt),_t((f=m.params)==null?void 0:f.tag)&&((l=m.params)==null||delete l.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:m}),this.relayer.provider.request(m)}onPublish(t,r){this.queue.delete(t)}checkQueue(){this.queue.forEach(async t=>{const{topic:r,message:n,opts:i}=t;await this.publish(r,n,i)})}registerEventListeners(){this.relayer.core.heartbeat.on(br.HEARTBEAT_EVENTS.pulse,()=>{this.checkQueue()})}}class E_{constructor(){this.map=new Map,this.set=(t,r)=>{const n=this.get(t);this.exists(t,r)||this.map.set(t,[...n,r])},this.get=t=>this.map.get(t)||[],this.exists=(t,r)=>this.get(t).includes(r),this.delete=(t,r)=>{if(typeof r>"u"){this.map.delete(t);return}if(!this.map.has(t))return;const n=this.get(t);if(!this.exists(t,r))return;const i=n.filter(s=>s!==r);if(!i.length){this.map.delete(t);return}this.map.set(t,i)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var D_=Object.defineProperty,S_=Object.defineProperties,x_=Object.getOwnPropertyDescriptors,Sa=Object.getOwnPropertySymbols,O_=Object.prototype.hasOwnProperty,I_=Object.prototype.propertyIsEnumerable,xa=(e,t,r)=>t in e?D_(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,fn=(e,t)=>{for(var r in t||(t={}))O_.call(t,r)&&xa(e,r,t[r]);if(Sa)for(var r of Sa(t))I_.call(t,r)&&xa(e,r,t[r]);return e},Ri=(e,t)=>S_(e,x_(t));class T_ extends bf{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.subscriptions=new Map,this.topicMap=new E_,this.events=new ct.exports.EventEmitter,this.name=u_,this.version=f_,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pendingSubInterval=20,this.storagePrefix=Mt,this.subscribeTimeout=1e4,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restart(),this.registerEventListeners(),this.onEnable())},this.subscribe=async(n,i)=>{this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:i}});try{const s=pi(i),o={topic:n,relay:s};this.pending.set(n,o);const c=await this.rpcSubscribe(n,s);return this.onSubscribe(c,o),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:i}}),c}catch(s){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(s),s}},this.unsubscribe=async(n,i)=>{this.isInitialized(),typeof i?.id<"u"?await this.unsubscribeById(n,i.id,i):await this.unsubscribeByTopic(n,i)},this.isSubscribed=async n=>this.topics.includes(n)?!0:await new Promise((i,s)=>{const o=new Z.Watch;o.start(this.pendingSubscriptionWatchLabel);const c=setInterval(()=>{!this.pending.has(n)&&this.topics.includes(n)&&(clearInterval(c),o.stop(this.pendingSubscriptionWatchLabel),i(!0)),o.elapsed(this.pendingSubscriptionWatchLabel)>=h_&&(clearInterval(c),o.stop(this.pendingSubscriptionWatchLabel),s(!1))},this.pendingSubInterval)}),this.on=(n,i)=>{this.events.on(n,i)},this.once=(n,i)=>{this.events.once(n,i)},this.off=(n,i)=>{this.events.off(n,i)},this.removeListener=(n,i)=>{this.events.removeListener(n,i)},this.restart=async()=>{await this.restore(),await this.reset()},this.relayer=t,this.logger=xe.generateChildLogger(r,this.name)}get context(){return xe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(t,r){let n=!1;try{n=this.getSubscription(t).topic===r}catch{}return n}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear(),this.initialized=!1}async unsubscribeByTopic(t,r){const n=this.topicMap.get(t);await Promise.all(n.map(async i=>await this.unsubscribeById(t,i,r)))}async unsubscribeById(t,r,n){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:n}});try{const i=pi(n);await this.rpcUnsubscribe(t,r,i);const s=qe("USER_DISCONNECTED",`${this.name}, ${t}`);await this.onUnsubscribe(t,r,s),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:n}})}catch(i){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(i),i}}async rpcSubscribe(t,r){const n={method:gi(r.protocol).subscribe,params:{topic:t}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});let i;try{i=await await Uo(this.relayer.provider.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(it.connection_stalled)}return i}rpcUnsubscribe(t,r,n){const i={method:gi(n.protocol).unsubscribe,params:{topic:t,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i}),this.relayer.provider.request(i)}onSubscribe(t,r){this.setSubscription(t,Ri(fn({},r),{id:t})),this.pending.delete(r.topic)}onResubscribe(t,r){this.addSubscription(t,Ri(fn({},r),{id:t})),this.pending.delete(r.topic)}async onUnsubscribe(t,r,n){this.events.removeAllListeners(r),this.hasSubscription(r,t)&&this.deleteSubscription(r,n),await this.relayer.messages.del(t)}async setRelayerSubscriptions(t){await this.relayer.core.storage.setItem(this.storageKey,t)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(t,r){this.subscriptions.has(t)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:t,subscription:r}),this.addSubscription(t,r))}addSubscription(t,r){this.subscriptions.set(t,fn({},r)),this.topicMap.set(r.topic,t),this.events.emit(Ot.created,r)}getSubscription(t){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:t});const r=this.subscriptions.get(t);if(!r){const{message:n}=H("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(n)}return r}deleteSubscription(t,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:t,reason:r});const n=this.getSubscription(t);this.subscriptions.delete(t),this.topicMap.delete(n.topic,t),this.events.emit(Ot.deleted,Ri(fn({},n),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Ot.sync)}async reset(){this.cached.length&&await Promise.all(this.cached.map(async t=>await this.resubscribe(t))),this.events.emit(Ot.resubscribed)}async restore(){try{const t=await this.getRelayerSubscriptions();if(typeof t>"u"||!t.length)return;if(this.subscriptions.size){const{message:r}=H("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(t){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(t)}}async resubscribe(t){if(!this.ids.includes(t.id)){const{topic:r,relay:n}=t,i={topic:r,relay:n};this.pending.set(i.topic,i);const s=await this.rpcSubscribe(i.topic,i.relay);this.onResubscribe(s,i)}}async onConnect(){await this.restart(),this.onEnable()}onDisconnect(){this.onDisable()}checkPending(){this.relayer.transportExplicitlyClosed||this.pending.forEach(async t=>{const r=await this.rpcSubscribe(t.topic,t.relay);this.onSubscribe(r,t)})}registerEventListeners(){this.relayer.core.heartbeat.on(br.HEARTBEAT_EVENTS.pulse,()=>{this.checkPending()}),this.relayer.on(it.connect,async()=>{await this.onConnect()}),this.relayer.on(it.disconnect,()=>{this.onDisconnect()}),this.events.on(Ot.created,async t=>{const r=Ot.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()}),this.events.on(Ot.deleted,async t=>{const r=Ot.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=H("NOT_INITIALIZED",this.name);throw new Error(t)}}}var N_=Object.defineProperty,Oa=Object.getOwnPropertySymbols,A_=Object.prototype.hasOwnProperty,R_=Object.prototype.propertyIsEnumerable,Ia=(e,t,r)=>t in e?N_(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,P_=(e,t)=>{for(var r in t||(t={}))A_.call(t,r)&&Ia(e,r,t[r]);if(Oa)for(var r of Oa(t))R_.call(t,r)&&Ia(e,r,t[r]);return e};class C_ extends _f{constructor(t){super(t),this.protocol="wc",this.version=2,this.events=new ct.exports.EventEmitter,this.name=s_,this.transportExplicitlyClosed=!1,this.initialized=!1,this.core=t.core,this.logger=typeof t.logger<"u"&&typeof t.logger!="string"?xe.generateChildLogger(t.logger,this.name):zr(xe.getDefaultLoggerOptions({level:t.logger||n_})),this.messages=new v_(this.logger,t.core),this.subscriber=new T_(this,this.logger),this.publisher=new m_(this,this.logger),this.relayUrl=t?.relayUrl||i_,this.projectId=t.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),this.provider=await this.createProvider(),await Promise.all([this.messages.init(),this.transportOpen(),this.subscriber.init()]),this.registerEventListeners(),this.initialized=!0}get context(){return xe.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(t,r,n){this.isInitialized(),await this.publisher.publish(t,r,n),await this.recordMessageEvent({topic:t,message:r})}async subscribe(t,r){this.isInitialized();let n="";return await Promise.all([new Promise(i=>{this.subscriber.once(Ot.created,s=>{s.topic===t&&i()})}),new Promise(async i=>{n=await this.subscriber.subscribe(t,r),i()})]),n}async unsubscribe(t,r){this.isInitialized(),await this.subscriber.unsubscribe(t,r)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.connected&&(await this.provider.disconnect(),this.events.emit(it.transport_closed))}async transportOpen(t){this.relayUrl=t||this.relayUrl,this.transportExplicitlyClosed=!1;try{await Promise.all([new Promise(r=>{this.initialized||r(),this.subscriber.once(Ot.resubscribed,()=>{r()})}),await Promise.race([this.provider.connect(),new Promise((r,n)=>this.once(it.transport_closed,()=>{n(new Error("closeTransport called before connection was established"))}))])])}catch(r){const n=r;if(!/socket hang up/i.test(n.message))throw new Error(n.message);this.logger.error(n),this.events.emit(it.transport_closed)}}async restartTransport(t){await this.transportClose(),await new Promise(r=>setTimeout(r,Da)),await this.transportOpen(t)}async createProvider(){const t=await this.core.crypto.signJWT(this.relayUrl);return new gg(new wg(Hd({sdkVersion:a_,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:t})))}async recordMessageEvent(t){const{topic:r,message:n}=t;await this.messages.set(r,n)}async shouldIgnoreMessageEvent(t){const{topic:r,message:n}=t;return await this.subscriber.isSubscribed(r)?this.messages.has(r,n):!0}async onProviderPayload(t){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:t}),Si(t)){if(!t.method.endsWith(o_))return;const r=t.params,{topic:n,message:i}=r.data,s={topic:n,message:i};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(P_({type:"event",event:r.id},s)),this.events.emit(r.id,s),await this.acknowledgePayload(t),await this.onMessageEvent(s)}}async onMessageEvent(t){await this.shouldIgnoreMessageEvent(t)||(this.events.emit(it.message,t),await this.recordMessageEvent(t))}async acknowledgePayload(t){const r=Ei(t.id,!0);await this.provider.connection.send(r)}registerEventListeners(){this.provider.on(un.payload,t=>this.onProviderPayload(t)),this.provider.on(un.connect,()=>{this.events.emit(it.connect)}),this.provider.on(un.disconnect,()=>{this.events.emit(it.disconnect),this.attemptToReconnect()}),this.provider.on(un.error,t=>this.events.emit(it.error,t)),this.events.on(it.connection_stalled,async()=>{await this.restartTransport()})}attemptToReconnect(){this.transportExplicitlyClosed||setTimeout(async()=>{await this.transportOpen()},Z.toMiliseconds(Da))}isInitialized(){if(!this.initialized){const{message:t}=H("NOT_INITIALIZED",this.name);throw new Error(t)}}}var F_=Object.defineProperty,Ta=Object.getOwnPropertySymbols,L_=Object.prototype.hasOwnProperty,U_=Object.prototype.propertyIsEnumerable,Na=(e,t,r)=>t in e?F_(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Aa=(e,t)=>{for(var r in t||(t={}))L_.call(t,r)&&Na(e,r,t[r]);if(Ta)for(var r of Ta(t))U_.call(t,r)&&Na(e,r,t[r]);return e};class hn extends yf{constructor(t,r,n,i=Mt,s=void 0){super(t,r,n,i),this.core=t,this.logger=r,this.name=n,this.map=new Map,this.version=c_,this.cached=[],this.initialized=!1,this.storagePrefix=Mt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(o=>{hp(o)?this.map.set(o.id,o):lp(o)?this.map.set(o.topic,o):this.getKey&&o!==null&&!_t(o)&&this.map.set(this.getKey(o),o)}),this.cached=[],this.initialized=!0)},this.set=async(o,c)=>{this.isInitialized(),this.map.has(o)?await this.update(o,c):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:o,value:c}),this.map.set(o,c),await this.persist())},this.get=o=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:o}),this.getData(o)),this.getAll=o=>(this.isInitialized(),o?this.values.filter(c=>Object.keys(o).every(h=>vg(c[h],o[h]))):this.values),this.update=async(o,c)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:o,update:c});const h=Aa(Aa({},this.getData(o)),c);this.map.set(o,h),await this.persist()},this.delete=async(o,c)=>{this.isInitialized(),this.map.has(o)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:o,reason:c}),this.map.delete(o),await this.persist())},this.logger=xe.generateChildLogger(r,this.name),this.storagePrefix=i,this.getKey=s}get context(){return xe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(t){await this.core.storage.setItem(this.storageKey,t)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(t){const r=this.map.get(t);if(!r){const{message:n}=H("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(n),new Error(n)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const t=await this.getDataStore();if(typeof t>"u"||!t.length)return;if(this.map.size){const{message:r}=H("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(t){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(t)}}isInitialized(){if(!this.initialized){const{message:t}=H("NOT_INITIALIZED",this.name);throw new Error(t)}}}class $_{constructor(t,r){this.core=t,this.logger=r,this.name=l_,this.version=d_,this.events=new ct.exports,this.initialized=!1,this.storagePrefix=Mt,this.ignoredPayloadTypes=[Xt],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:n})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...n])]},this.create=async()=>{this.isInitialized();const n=hi(),i=await this.core.crypto.setSymKey(n),s=xt(Z.FIVE_MINUTES),o={protocol:Ea},c={topic:i,expiry:s,relay:o,active:!1},h=tp({protocol:this.core.protocol,version:this.core.version,topic:i,symKey:n,relay:o});return await this.pairings.set(i,c),await this.core.relayer.subscribe(i),this.core.expirer.set(i,s),{topic:i,uri:h}},this.pair=async n=>{this.isInitialized(),this.isValidPair(n);const{topic:i,symKey:s,relay:o}=Qd(n.uri),c=xt(Z.FIVE_MINUTES),h={topic:i,relay:o,expiry:c,active:!1};return await this.pairings.set(i,h),await this.core.crypto.setSymKey(s,i),await this.core.relayer.subscribe(i,{relay:o}),this.core.expirer.set(i,c),n.activatePairing&&await this.activate({topic:i}),h},this.activate=async({topic:n})=>{this.isInitialized();const i=xt(Z.THIRTY_DAYS);await this.pairings.update(n,{active:!0,expiry:i}),this.core.expirer.set(n,i)},this.ping=async n=>{this.isInitialized(),await this.isValidPing(n);const{topic:i}=n;if(this.pairings.keys.includes(i)){const s=await this.sendRequest(i,"wc_pairingPing",{}),{done:o,resolve:c,reject:h}=Jt();this.events.once(Le("pairing_ping",s),({error:f})=>{f?h(f):c()}),await o()}},this.updateExpiry=async({topic:n,expiry:i})=>{this.isInitialized(),await this.pairings.update(n,{expiry:i})},this.updateMetadata=async({topic:n,metadata:i})=>{this.isInitialized(),await this.pairings.update(n,{peerMetadata:i})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async n=>{this.isInitialized(),await this.isValidDisconnect(n);const{topic:i}=n;this.pairings.keys.includes(i)&&(await this.sendRequest(i,"wc_pairingDelete",qe("USER_DISCONNECTED")),await this.deletePairing(i))},this.sendRequest=async(n,i,s)=>{const o=an(i,s),c=await this.core.crypto.encode(n,o),h=Lr[i].req;return this.core.history.set(n,o),await this.core.relayer.publish(n,c,h),o.id},this.sendResult=async(n,i,s)=>{const o=Ei(n,s),c=await this.core.crypto.encode(i,o),h=await this.core.history.get(i,n),f=Lr[h.request.method].res;await this.core.relayer.publish(i,c,f),await this.core.history.resolve(o)},this.sendError=async(n,i,s)=>{const o=Di(n,s),c=await this.core.crypto.encode(i,o),h=await this.core.history.get(i,n),f=Lr[h.request.method]?Lr[h.request.method].res:Lr.unregistered_method.res;await this.core.relayer.publish(i,c,f),await this.core.history.resolve(o)},this.deletePairing=async(n,i)=>{await this.core.relayer.unsubscribe(n),await Promise.all([this.pairings.delete(n,qe("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(n),i?Promise.resolve():this.core.expirer.del(n)])},this.cleanup=async()=>{const n=this.pairings.getAll().filter(i=>$t(i.expiry));await Promise.all(n.map(i=>this.deletePairing(i.topic)))},this.onRelayEventRequest=n=>{const{topic:i,payload:s}=n,o=s.method;if(this.pairings.keys.includes(i))switch(o){case"wc_pairingPing":return this.onPairingPingRequest(i,s);case"wc_pairingDelete":return this.onPairingDeleteRequest(i,s);default:return this.onUnknownRpcMethodRequest(i,s)}},this.onRelayEventResponse=async n=>{const{topic:i,payload:s}=n,o=(await this.core.history.get(i,s.id)).request.method;if(this.pairings.keys.includes(i))switch(o){case"wc_pairingPing":return this.onPairingPingResponse(i,s);default:return this.onUnknownRpcMethodResponse(o)}},this.onPairingPingRequest=async(n,i)=>{const{id:s}=i;try{this.isValidPing({topic:n}),await this.sendResult(s,n,!0),this.events.emit("pairing_ping",{id:s,topic:n})}catch(o){await this.sendError(s,n,o),this.logger.error(o)}},this.onPairingPingResponse=(n,i)=>{const{id:s}=i;setTimeout(()=>{Rt(i)?this.events.emit(Le("pairing_ping",s),{}):vt(i)&&this.events.emit(Le("pairing_ping",s),{error:i.error})},500)},this.onPairingDeleteRequest=async(n,i)=>{const{id:s}=i;try{this.isValidDisconnect({topic:n}),await this.sendResult(s,n,!0),await this.deletePairing(n),this.events.emit("pairing_delete",{id:s,topic:n})}catch(o){await this.sendError(s,n,o),this.logger.error(o)}},this.onUnknownRpcMethodRequest=async(n,i)=>{const{id:s,method:o}=i;try{if(this.registeredMethods.includes(o))return;const c=qe("WC_METHOD_UNSUPPORTED",o);await this.sendError(s,n,c),this.logger.error(c)}catch(c){await this.sendError(s,n,c),this.logger.error(c)}},this.onUnknownRpcMethodResponse=n=>{this.registeredMethods.includes(n)||this.logger.error(qe("WC_METHOD_UNSUPPORTED",n))},this.isValidPair=n=>{if(!lt(n)){const{message:i}=H("MISSING_OR_INVALID",`pair() params: ${n}`);throw new Error(i)}if(!fp(n.uri)){const{message:i}=H("MISSING_OR_INVALID",`pair() uri: ${n.uri}`);throw new Error(i)}},this.isValidPing=async n=>{if(!lt(n)){const{message:s}=H("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(s)}const{topic:i}=n;await this.isValidPairingTopic(i)},this.isValidDisconnect=async n=>{if(!lt(n)){const{message:s}=H("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(s)}const{topic:i}=n;await this.isValidPairingTopic(i)},this.isValidPairingTopic=async n=>{if(!et(n,!1)){const{message:i}=H("MISSING_OR_INVALID",`pairing topic should be a string: ${n}`);throw new Error(i)}if(!this.pairings.keys.includes(n)){const{message:i}=H("NO_MATCHING_KEY",`pairing topic doesn't exist: ${n}`);throw new Error(i)}if($t(this.pairings.get(n).expiry)){await this.deletePairing(n);const{message:i}=H("EXPIRED",`pairing topic: ${n}`);throw new Error(i)}},this.core=t,this.logger=xe.generateChildLogger(r,this.name),this.pairings=new hn(this.core,this.logger,this.name,this.storagePrefix)}get context(){return xe.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:t}=H("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.core.relayer.on(it.message,async t=>{const{topic:r,message:n}=t;if(this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(n)))return;const i=await this.core.crypto.decode(r,n);Si(i)?(this.core.history.set(r,i),this.onRelayEventRequest({topic:r,payload:i})):xi(i)&&(await this.core.history.resolve(i),this.onRelayEventResponse({topic:r,payload:i}))})}registerExpirerEvents(){this.core.expirer.on(yt.expired,async t=>{const{topic:r}=Mo(t.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit("pairing_expire",{topic:r}))})}}class M_ extends df{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.records=new Map,this.events=new ct.exports.EventEmitter,this.name=p_,this.version=g_,this.cached=[],this.initialized=!1,this.storagePrefix=Mt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.records.set(n.id,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(n,i,s)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:n,request:i,chainId:s}),this.records.has(i.id))return;const o={id:i.id,topic:n,request:{method:i.method,params:i.params||null},chainId:s};this.records.set(o.id,o),this.events.emit(It.created,o)},this.resolve=async n=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:n}),!this.records.has(n.id))return;const i=await this.getRecord(n.id);typeof i.response>"u"&&(i.response=vt(n)?{error:n.error}:{result:n.result},this.records.set(i.id,i),this.events.emit(It.updated,i))},this.get=async(n,i)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:n,id:i}),await this.getRecord(i)),this.delete=(n,i)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:i}),this.values.forEach(s=>{if(s.topic===n){if(typeof i<"u"&&s.id!==i)return;this.records.delete(s.id),this.events.emit(It.deleted,s)}})},this.exists=async(n,i)=>(this.isInitialized(),this.records.has(i)?(await this.getRecord(i)).topic===n:!1),this.on=(n,i)=>{this.events.on(n,i)},this.once=(n,i)=>{this.events.once(n,i)},this.off=(n,i)=>{this.events.off(n,i)},this.removeListener=(n,i)=>{this.events.removeListener(n,i)},this.logger=xe.generateChildLogger(r,this.name)}get context(){return xe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const t=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const n={topic:r.topic,request:an(r.request.method,r.request.params,r.id),chainId:r.chainId};return t.push(n)}),t}async setJsonRpcRecords(t){await this.core.storage.setItem(this.storageKey,t)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(t){this.isInitialized();const r=this.records.get(t);if(!r){const{message:n}=H("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(n)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(It.sync)}async restore(){try{const t=await this.getJsonRpcRecords();if(typeof t>"u"||!t.length)return;if(this.records.size){const{message:r}=H("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(t){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(t)}}registerEventListeners(){this.events.on(It.created,t=>{const r=It.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(It.updated,t=>{const r=It.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(It.deleted,t=>{const r=It.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=H("NOT_INITIALIZED",this.name);throw new Error(t)}}}class j_ extends wf{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.expirations=new Map,this.events=new ct.exports.EventEmitter,this.name=__,this.version=y_,this.cached=[],this.initialized=!1,this.storagePrefix=Mt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.expirations.set(n.target,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=n=>{try{const i=this.formatTarget(n);return typeof this.getExpiration(i)<"u"}catch{return!1}},this.set=(n,i)=>{this.isInitialized();const s=this.formatTarget(n),o={target:s,expiry:i};this.expirations.set(s,o),this.checkExpiry(s,o),this.events.emit(yt.created,{target:s,expiration:o})},this.get=n=>{this.isInitialized();const i=this.formatTarget(n);return this.getExpiration(i)},this.del=n=>{if(this.isInitialized(),this.has(n)){const i=this.formatTarget(n),s=this.getExpiration(i);this.expirations.delete(i),this.events.emit(yt.deleted,{target:i,expiration:s})}},this.on=(n,i)=>{this.events.on(n,i)},this.once=(n,i)=>{this.events.once(n,i)},this.off=(n,i)=>{this.events.off(n,i)},this.removeListener=(n,i)=>{this.events.removeListener(n,i)},this.logger=xe.generateChildLogger(r,this.name)}get context(){return xe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(t){if(typeof t=="string")return Vd(t);if(typeof t=="number")return Gd(t);const{message:r}=H("UNKNOWN_TYPE",`Target type: ${typeof t}`);throw new Error(r)}async setExpirations(t){await this.core.storage.setItem(this.storageKey,t)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(yt.sync)}async restore(){try{const t=await this.getExpirations();if(typeof t>"u"||!t.length)return;if(this.expirations.size){const{message:r}=H("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(t){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(t)}}getExpiration(t){const r=this.expirations.get(t);if(!r){const{message:n}=H("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(n),new Error(n)}return r}checkExpiry(t,r){const{expiry:n}=r;Z.toMiliseconds(n)-Date.now()<=0&&this.expire(t,r)}expire(t,r){this.expirations.delete(t),this.events.emit(yt.expired,{target:t,expiration:r})}checkExpirations(){this.expirations.forEach((t,r)=>this.checkExpiry(r,t))}registerEventListeners(){this.core.heartbeat.on(br.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(yt.created,t=>{const r=yt.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(yt.expired,t=>{const r=yt.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(yt.deleted,t=>{const r=yt.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=H("NOT_INITIALIZED",this.name);throw new Error(t)}}}var z_=Object.defineProperty,Ra=Object.getOwnPropertySymbols,B_=Object.prototype.hasOwnProperty,K_=Object.prototype.propertyIsEnumerable,Pa=(e,t,r)=>t in e?z_(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Ca=(e,t)=>{for(var r in t||(t={}))B_.call(t,r)&&Pa(e,r,t[r]);if(Ra)for(var r of Ra(t))K_.call(t,r)&&Pa(e,r,t[r]);return e};class Pi extends lf{constructor(t){super(t),this.protocol=va,this.version=G0,this.name=Ai,this.events=new ct.exports.EventEmitter,this.initialized=!1,this.on=(n,i)=>this.events.on(n,i),this.once=(n,i)=>this.events.once(n,i),this.off=(n,i)=>this.events.off(n,i),this.removeListener=(n,i)=>this.events.removeListener(n,i),this.projectId=t?.projectId;const r=typeof t?.logger<"u"&&typeof t?.logger!="string"?t.logger:zr(xe.getDefaultLoggerOptions({level:t?.logger||W0.logger}));this.logger=xe.generateChildLogger(r,this.name),this.heartbeat=new br.HeartBeat,this.crypto=new w_(this,this.logger,t?.keychain),this.history=new M_(this,this.logger),this.expirer=new j_(this,this.logger),this.storage=t!=null&&t.storage?t.storage:new qc(Ca(Ca({},Y0),t?.storageOptions)),this.relayer=new C_({core:this,logger:this.logger,relayUrl:t?.relayUrl,projectId:this.projectId}),this.pairing=new $_(this,this.logger)}static async init(t){const r=new Pi(t);return await r.initialize(),r}get context(){return xe.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(t){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,t),this.logger.error(t.message),t}}}const q_=Pi,Ci="wc",Fi=2,Li="client",ln=`${Ci}@${Fi}:${Li}:`,dn={name:Li,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},H_={session_proposal:"session_proposal",session_update:"session_update",session_extend:"session_extend",session_ping:"session_ping",session_delete:"session_delete",session_expire:"session_expire",session_request:"session_request",session_event:"session_event",proposal_expire:"proposal_expire"},V_={database:":memory:"},G_={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},W_="history",Y_="0.3",Fa="proposal",k_=Z.THIRTY_DAYS,La="session",Ur=Z.SEVEN_DAYS,Ua="engine",ur={wc_sessionPropose:{req:{ttl:Z.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:Z.ONE_DAY,prompt:!1,tag:1104},res:{ttl:Z.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:Z.ONE_DAY,prompt:!1,tag:1106},res:{ttl:Z.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:Z.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:Z.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:Z.ONE_DAY,prompt:!1,tag:1112},res:{ttl:Z.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:Z.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:Z.THIRTY_SECONDS,prompt:!1,tag:1115}}},pn={min:Z.FIVE_MINUTES,max:Z.SEVEN_DAYS},$a="request";var X_=Object.defineProperty,J_=Object.defineProperties,Z_=Object.getOwnPropertyDescriptors,Ma=Object.getOwnPropertySymbols,Q_=Object.prototype.hasOwnProperty,ey=Object.prototype.propertyIsEnumerable,ja=(e,t,r)=>t in e?X_(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Pt=(e,t)=>{for(var r in t||(t={}))Q_.call(t,r)&&ja(e,r,t[r]);if(Ma)for(var r of Ma(t))ey.call(t,r)&&ja(e,r,t[r]);return e},Ui=(e,t)=>J_(e,Z_(t));class ty extends mf{constructor(t){super(t),this.name=Ua,this.events=new ct.exports,this.initialized=!1,this.ignoredPayloadTypes=[Xt],this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.client.core.pairing.register({methods:Object.keys(ur)}),this.initialized=!0)},this.connect=async r=>{this.isInitialized(),await this.isValidConnect(r);const{pairingTopic:n,requiredNamespaces:i,relays:s}=r;let o=n,c,h=!1;if(o&&(h=this.client.core.pairing.pairings.get(o).active),!o||!h){const{topic:R,uri:$}=await this.client.core.pairing.create();o=R,c=$}const f=await this.client.core.crypto.generateKeyPair(),l={requiredNamespaces:i,relays:s??[{protocol:Ea}],proposer:{publicKey:f,metadata:this.client.metadata}},{reject:m,resolve:b,done:w}=Jt();if(this.events.once(Le("session_connect"),async({error:R,session:$})=>{if(R)m(R);else if($){$.self.publicKey=f;const E=Ui(Pt({},$),{requiredNamespaces:$.requiredNamespaces});await this.client.session.set($.topic,E),await this.setExpiry($.topic,$.expiry),o&&await this.client.core.pairing.updateMetadata({topic:o,metadata:$.peer.metadata}),b(E)}}),!o){const{message:R}=H("NO_MATCHING_KEY",`connect() pairing topic: ${o}`);throw new Error(R)}const D=await this.sendRequest(o,"wc_sessionPropose",l),P=xt(Z.FIVE_MINUTES);return await this.setProposal(D,Pt({id:D,expiry:P},l)),{uri:c,approval:w}},this.pair=async r=>(this.isInitialized(),await this.client.core.pairing.pair(r)),this.approve=async r=>{this.isInitialized(),await this.isValidApprove(r);const{id:n,relayProtocol:i,namespaces:s}=r,o=this.client.proposal.get(n);let{pairingTopic:c,proposer:h,requiredNamespaces:f}=o;sn(f)||(f=sp(s,"approve()"),this.client.proposal.set(n,Ui(Pt({},o),{requiredNamespaces:f})));const l=await this.client.core.crypto.generateKeyPair(),m=h.publicKey,b=await this.client.core.crypto.generateSharedKey(l,m),w={relay:{protocol:i??"irn"},namespaces:s,requiredNamespaces:f,controller:{publicKey:l,metadata:this.client.metadata},expiry:xt(Ur)};await this.client.core.relayer.subscribe(b);const D=await this.sendRequest(b,"wc_sessionSettle",w),{done:P,resolve:R,reject:$}=Jt();this.events.once(Le("session_approve",D),({error:O})=>{O?$(O):R(this.client.session.get(b))});const E=Ui(Pt({},w),{topic:b,acknowledged:!1,self:w.controller,peer:{publicKey:h.publicKey,metadata:h.metadata},controller:l});return await this.client.session.set(b,E),await this.setExpiry(b,xt(Ur)),c&&await this.client.core.pairing.updateMetadata({topic:c,metadata:E.peer.metadata}),c&&n&&(await this.sendResult(n,c,{relay:{protocol:i??"irn"},responderPublicKey:l}),await this.client.proposal.delete(n,qe("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:c})),{topic:b,acknowledged:P}},this.reject=async r=>{this.isInitialized(),await this.isValidReject(r);const{id:n,reason:i}=r,{pairingTopic:s}=this.client.proposal.get(n);s&&(await this.sendError(n,s,i),await this.client.proposal.delete(n,qe("USER_DISCONNECTED")))},this.update=async r=>{this.isInitialized(),await this.isValidUpdate(r);const{topic:n,namespaces:i}=r,s=await this.sendRequest(n,"wc_sessionUpdate",{namespaces:i}),{done:o,resolve:c,reject:h}=Jt();return this.events.once(Le("session_update",s),({error:f})=>{f?h(f):c()}),await this.client.session.update(n,{namespaces:i}),{acknowledged:o}},this.extend=async r=>{this.isInitialized(),await this.isValidExtend(r);const{topic:n}=r,i=await this.sendRequest(n,"wc_sessionExtend",{}),{done:s,resolve:o,reject:c}=Jt();return this.events.once(Le("session_extend",i),({error:h})=>{h?c(h):o()}),await this.setExpiry(n,xt(Ur)),{acknowledged:s}},this.request=async r=>{this.isInitialized(),await this.isValidRequest(r);const{chainId:n,request:i,topic:s,expiry:o}=r,c=await this.sendRequest(s,"wc_sessionRequest",{request:i,chainId:n},o),{done:h,resolve:f,reject:l}=Jt(o);return this.events.once(Le("session_request",c),({error:m,result:b})=>{m?l(m):f(b)}),await h()},this.respond=async r=>{this.isInitialized(),await this.isValidRespond(r);const{topic:n,response:i}=r,{id:s}=i;Rt(i)?await this.sendResult(s,n,i.result):vt(i)&&await this.sendError(s,n,i.error),this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0})},this.ping=async r=>{this.isInitialized(),await this.isValidPing(r);const{topic:n}=r;if(this.client.session.keys.includes(n)){const i=await this.sendRequest(n,"wc_sessionPing",{}),{done:s,resolve:o,reject:c}=Jt();this.events.once(Le("session_ping",i),({error:h})=>{h?c(h):o()}),await s()}else this.client.core.pairing.pairings.keys.includes(n)&&await this.client.core.pairing.ping({topic:n})},this.emit=async r=>{this.isInitialized(),await this.isValidEmit(r);const{topic:n,event:i,chainId:s}=r;await this.sendRequest(n,"wc_sessionEvent",{event:i,chainId:s})},this.disconnect=async r=>{this.isInitialized(),await this.isValidDisconnect(r);const{topic:n}=r;this.client.session.keys.includes(n)?(await this.sendRequest(n,"wc_sessionDelete",qe("USER_DISCONNECTED")),await this.deleteSession(n)):await this.client.core.pairing.disconnect({topic:n})},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(n=>cp(n,r))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.deleteSession=async(r,n)=>{const{self:i}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),await Promise.all([this.client.session.delete(r,qe("USER_DISCONNECTED")),this.client.core.crypto.deleteKeyPair(i.publicKey),this.client.core.crypto.deleteSymKey(r),n?Promise.resolve():this.client.core.expirer.del(r)])},this.deleteProposal=async(r,n)=>{await Promise.all([this.client.proposal.delete(r,qe("USER_DISCONNECTED")),n?Promise.resolve():this.client.core.expirer.del(r)])},this.deletePendingSessionRequest=async(r,n,i=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,n),i?Promise.resolve():this.client.core.expirer.del(r)])},this.setExpiry=async(r,n)=>{this.client.session.keys.includes(r)&&await this.client.session.update(r,{expiry:n}),this.client.core.expirer.set(r,n)},this.setProposal=async(r,n)=>{await this.client.proposal.set(r,n),this.client.core.expirer.set(r,n.expiry)},this.setPendingSessionRequest=async r=>{const n=ur.wc_sessionRequest.req.ttl,{id:i,topic:s,params:o}=r;await this.client.pendingRequest.set(i,{id:i,topic:s,params:o}),n&&this.client.core.expirer.set(i,xt(n))},this.sendRequest=async(r,n,i,s)=>{const o=an(n,i),c=await this.client.core.crypto.encode(r,o),h=ur[n].req;return s&&(h.ttl=s),this.client.core.history.set(r,o),this.client.core.relayer.publish(r,c,h),o.id},this.sendResult=async(r,n,i)=>{const s=Ei(r,i),o=await this.client.core.crypto.encode(n,s),c=await this.client.core.history.get(n,r),h=ur[c.request.method].res;this.client.core.relayer.publish(n,o,h),await this.client.core.history.resolve(s)},this.sendError=async(r,n,i)=>{const s=Di(r,i),o=await this.client.core.crypto.encode(n,s),c=await this.client.core.history.get(n,r),h=ur[c.request.method].res;this.client.core.relayer.publish(n,o,h),await this.client.core.history.resolve(s)},this.cleanup=async()=>{const r=[],n=[];this.client.session.getAll().forEach(i=>{$t(i.expiry)&&r.push(i.topic)}),this.client.proposal.getAll().forEach(i=>{$t(i.expiry)&&n.push(i.id)}),await Promise.all([...r.map(i=>this.deleteSession(i)),...n.map(i=>this.deleteProposal(i))])},this.onRelayEventRequest=r=>{const{topic:n,payload:i}=r,s=i.method;switch(s){case"wc_sessionPropose":return this.onSessionProposeRequest(n,i);case"wc_sessionSettle":return this.onSessionSettleRequest(n,i);case"wc_sessionUpdate":return this.onSessionUpdateRequest(n,i);case"wc_sessionExtend":return this.onSessionExtendRequest(n,i);case"wc_sessionPing":return this.onSessionPingRequest(n,i);case"wc_sessionDelete":return this.onSessionDeleteRequest(n,i);case"wc_sessionRequest":return this.onSessionRequest(n,i);case"wc_sessionEvent":return this.onSessionEventRequest(n,i);default:return this.client.logger.info(`Unsupported request method ${s}`)}},this.onRelayEventResponse=async r=>{const{topic:n,payload:i}=r,s=(await this.client.core.history.get(n,i.id)).request.method;switch(s){case"wc_sessionPropose":return this.onSessionProposeResponse(n,i);case"wc_sessionSettle":return this.onSessionSettleResponse(n,i);case"wc_sessionUpdate":return this.onSessionUpdateResponse(n,i);case"wc_sessionExtend":return this.onSessionExtendResponse(n,i);case"wc_sessionPing":return this.onSessionPingResponse(n,i);case"wc_sessionRequest":return this.onSessionRequestResponse(n,i);default:return this.client.logger.info(`Unsupported response method ${s}`)}},this.onSessionProposeRequest=async(r,n)=>{const{params:i,id:s}=n;try{this.isValidConnect(Pt({},n.params));const o=xt(Z.FIVE_MINUTES),c=Pt({id:s,pairingTopic:r,expiry:o},i);await this.setProposal(s,c),this.client.events.emit("session_proposal",{id:s,params:c})}catch(o){await this.sendError(s,r,o),this.client.logger.error(o)}},this.onSessionProposeResponse=async(r,n)=>{const{id:i}=n;if(Rt(n)){const{result:s}=n;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:s});const o=this.client.proposal.get(i);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:o});const c=o.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:c});const h=s.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:h});const f=await this.client.core.crypto.generateSharedKey(c,h);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:f});const l=await this.client.core.relayer.subscribe(f);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:l}),await this.client.core.pairing.activate({topic:r})}else vt(n)&&(await this.client.proposal.delete(i,qe("USER_DISCONNECTED")),this.events.emit(Le("session_connect"),{error:n.error}))},this.onSessionSettleRequest=async(r,n)=>{const{id:i,params:s}=n;try{this.isValidSessionSettleRequest(s);const{relay:o,controller:c,expiry:h,namespaces:f,requiredNamespaces:l}=n.params,m={topic:r,relay:o,expiry:h,namespaces:f,acknowledged:!0,requiredNamespaces:l,controller:c.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:c.publicKey,metadata:c.metadata}};await this.sendResult(n.id,r,!0),this.events.emit(Le("session_connect"),{session:m})}catch(o){await this.sendError(i,r,o),this.client.logger.error(o)}},this.onSessionSettleResponse=async(r,n)=>{const{id:i}=n;Rt(n)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(Le("session_approve",i),{})):vt(n)&&(await this.client.session.delete(r,qe("USER_DISCONNECTED")),this.events.emit(Le("session_approve",i),{error:n.error}))},this.onSessionUpdateRequest=async(r,n)=>{const{params:i,id:s}=n;try{this.isValidUpdate(Pt({topic:r},i)),await this.client.session.update(r,{namespaces:i.namespaces}),await this.sendResult(s,r,!0),this.client.events.emit("session_update",{id:s,topic:r,params:i})}catch(o){await this.sendError(s,r,o),this.client.logger.error(o)}},this.onSessionUpdateResponse=(r,n)=>{const{id:i}=n;Rt(n)?this.events.emit(Le("session_update",i),{}):vt(n)&&this.events.emit(Le("session_update",i),{error:n.error})},this.onSessionExtendRequest=async(r,n)=>{const{id:i}=n;try{this.isValidExtend({topic:r}),await this.setExpiry(r,xt(Ur)),await this.sendResult(i,r,!0),this.client.events.emit("session_extend",{id:i,topic:r})}catch(s){await this.sendError(i,r,s),this.client.logger.error(s)}},this.onSessionExtendResponse=(r,n)=>{const{id:i}=n;Rt(n)?this.events.emit(Le("session_extend",i),{}):vt(n)&&this.events.emit(Le("session_extend",i),{error:n.error})},this.onSessionPingRequest=async(r,n)=>{const{id:i}=n;try{this.isValidPing({topic:r}),await this.sendResult(i,r,!0),this.client.events.emit("session_ping",{id:i,topic:r})}catch(s){await this.sendError(i,r,s),this.client.logger.error(s)}},this.onSessionPingResponse=(r,n)=>{const{id:i}=n;setTimeout(()=>{Rt(n)?this.events.emit(Le("session_ping",i),{}):vt(n)&&this.events.emit(Le("session_ping",i),{error:n.error})},500)},this.onSessionDeleteRequest=async(r,n)=>{const{id:i}=n;try{this.isValidDisconnect({topic:r,reason:n.params}),this.client.core.relayer.once(it.publish,async()=>{await this.deleteSession(r)}),await this.sendResult(i,r,!0),this.client.events.emit("session_delete",{id:i,topic:r})}catch(s){await this.sendError(i,r,s),this.client.logger.error(s)}},this.onSessionRequest=async(r,n)=>{const{id:i,params:s}=n;try{this.isValidRequest(Pt({topic:r},s)),await this.setPendingSessionRequest({id:i,topic:r,params:s}),this.client.events.emit("session_request",{id:i,topic:r,params:s})}catch(o){await this.sendError(i,r,o),this.client.logger.error(o)}},this.onSessionRequestResponse=(r,n)=>{const{id:i}=n;Rt(n)?this.events.emit(Le("session_request",i),{result:n.result}):vt(n)&&this.events.emit(Le("session_request",i),{error:n.error})},this.onSessionEventRequest=async(r,n)=>{const{id:i,params:s}=n;try{this.isValidEmit(Pt({topic:r},s)),this.client.events.emit("session_event",{id:i,topic:r,params:s})}catch(o){await this.sendError(i,r,o),this.client.logger.error(o)}},this.isValidConnect=async r=>{if(!lt(r)){const{message:c}=H("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(c)}const{pairingTopic:n,requiredNamespaces:i,relays:s}=r;if(_t(n)||await this.isValidPairingTopic(n),!_t(i)&&sn(i)===0)return;const o=wp(i,"connect()");if(o)throw new Error(o.message);if(!vp(s,!0)){const{message:c}=H("MISSING_OR_INVALID",`connect() relays: ${s}`);throw new Error(c)}},this.isValidApprove=async r=>{if(!lt(r))throw new Error(H("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:n,namespaces:i,relayProtocol:s}=r;await this.isValidProposalId(n);const o=this.client.proposal.get(n),c=on(i,"approve()");if(c)throw new Error(c.message);const h=Vo(o.requiredNamespaces,i,"update()");if(h)throw new Error(h.message);if(!et(s,!0)){const{message:f}=H("MISSING_OR_INVALID",`approve() relayProtocol: ${s}`);throw new Error(f)}},this.isValidReject=async r=>{if(!lt(r)){const{message:s}=H("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(s)}const{id:n,reason:i}=r;if(await this.isValidProposalId(n),!Ep(i)){const{message:s}=H("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(i)}`);throw new Error(s)}},this.isValidSessionSettleRequest=r=>{if(!lt(r)){const{message:f}=H("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(f)}const{relay:n,controller:i,namespaces:s,expiry:o}=r;if(!qo(n)){const{message:f}=H("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(f)}const c=dp(i,"onSessionSettleRequest()");if(c)throw new Error(c.message);const h=on(s,"onSessionSettleRequest()");if(h)throw new Error(h.message);if($t(o)){const{message:f}=H("EXPIRED","onSessionSettleRequest()");throw new Error(f)}},this.isValidUpdate=async r=>{if(!lt(r)){const{message:h}=H("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(h)}const{topic:n,namespaces:i}=r;await this.isValidSessionTopic(n);const s=this.client.session.get(n),o=on(i,"update()");if(o)throw new Error(o.message);const c=Vo(s.requiredNamespaces,i,"update()");if(c)throw new Error(c.message)},this.isValidExtend=async r=>{if(!lt(r)){const{message:i}=H("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(i)}const{topic:n}=r;await this.isValidSessionTopic(n)},this.isValidRequest=async r=>{if(!lt(r)){const{message:h}=H("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(h)}const{topic:n,request:i,chainId:s,expiry:o}=r;await this.isValidSessionTopic(n);const{namespaces:c}=this.client.session.get(n);if(!Ho(c,s)){const{message:h}=H("MISSING_OR_INVALID",`request() chainId: ${s}`);throw new Error(h)}if(!Dp(i)){const{message:h}=H("MISSING_OR_INVALID",`request() ${JSON.stringify(i)}`);throw new Error(h)}if(!Op(c,s,i.method)){const{message:h}=H("MISSING_OR_INVALID",`request() method: ${i.method}`);throw new Error(h)}if(o&&!Tp(o,pn)){const{message:h}=H("MISSING_OR_INVALID",`request() expiry: ${o}. Expiry must be a number (in seconds) between ${pn.min} and ${pn.max}`);throw new Error(h)}},this.isValidRespond=async r=>{if(!lt(r)){const{message:s}=H("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(s)}const{topic:n,response:i}=r;if(await this.isValidSessionTopic(n),!Sp(i)){const{message:s}=H("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(i)}`);throw new Error(s)}},this.isValidPing=async r=>{if(!lt(r)){const{message:i}=H("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(i)}const{topic:n}=r;await this.isValidSessionOrPairingTopic(n)},this.isValidEmit=async r=>{if(!lt(r)){const{message:c}=H("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(c)}const{topic:n,event:i,chainId:s}=r;await this.isValidSessionTopic(n);const{namespaces:o}=this.client.session.get(n);if(!Ho(o,s)){const{message:c}=H("MISSING_OR_INVALID",`emit() chainId: ${s}`);throw new Error(c)}if(!xp(i)){const{message:c}=H("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(i)}`);throw new Error(c)}if(!Ip(o,s,i.name)){const{message:c}=H("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(i)}`);throw new Error(c)}},this.isValidDisconnect=async r=>{if(!lt(r)){const{message:i}=H("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(i)}const{topic:n}=r;await this.isValidSessionOrPairingTopic(n)}}isInitialized(){if(!this.initialized){const{message:t}=H("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.client.core.relayer.on(it.message,async t=>{const{topic:r,message:n}=t;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(n)))return;const i=await this.client.core.crypto.decode(r,n);Si(i)?(this.client.core.history.set(r,i),this.onRelayEventRequest({topic:r,payload:i})):xi(i)&&(await this.client.core.history.resolve(i),this.onRelayEventResponse({topic:r,payload:i}))})}registerExpirerEvents(){this.client.core.expirer.on(yt.expired,async t=>{const{topic:r,id:n}=Mo(t.target);if(n&&this.client.pendingRequest.keys.includes(n))return await this.deletePendingSessionRequest(n,H("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession(r,!0),this.client.events.emit("session_expire",{topic:r})):n&&(await this.deleteProposal(n,!0),this.client.events.emit("proposal_expire",{id:n}))})}isValidPairingTopic(t){if(!et(t,!1)){const{message:r}=H("MISSING_OR_INVALID",`pairing topic should be a string: ${t}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(t)){const{message:r}=H("NO_MATCHING_KEY",`pairing topic doesn't exist: ${t}`);throw new Error(r)}if($t(this.client.core.pairing.pairings.get(t).expiry)){const{message:r}=H("EXPIRED",`pairing topic: ${t}`);throw new Error(r)}}async isValidSessionTopic(t){if(!et(t,!1)){const{message:r}=H("MISSING_OR_INVALID",`session topic should be a string: ${t}`);throw new Error(r)}if(!this.client.session.keys.includes(t)){const{message:r}=H("NO_MATCHING_KEY",`session topic doesn't exist: ${t}`);throw new Error(r)}if($t(this.client.session.get(t).expiry)){await this.deleteSession(t);const{message:r}=H("EXPIRED",`session topic: ${t}`);throw new Error(r)}}async isValidSessionOrPairingTopic(t){if(this.client.session.keys.includes(t))await this.isValidSessionTopic(t);else if(this.client.core.pairing.pairings.keys.includes(t))this.isValidPairingTopic(t);else if(et(t,!1)){const{message:r}=H("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${t}`);throw new Error(r)}else{const{message:r}=H("MISSING_OR_INVALID",`session or pairing topic should be a string: ${t}`);throw new Error(r)}}async isValidProposalId(t){if(!mp(t)){const{message:r}=H("MISSING_OR_INVALID",`proposal id should be a number: ${t}`);throw new Error(r)}if(!this.client.proposal.keys.includes(t)){const{message:r}=H("NO_MATCHING_KEY",`proposal id doesn't exist: ${t}`);throw new Error(r)}if($t(this.client.proposal.get(t).expiry)){await this.deleteProposal(t);const{message:r}=H("EXPIRED",`proposal id: ${t}`);throw new Error(r)}}}class ry extends hn{constructor(t,r){super(t,r,Fa,ln),this.core=t,this.logger=r}}class ny extends hn{constructor(t,r){super(t,r,La,ln),this.core=t,this.logger=r}}class iy extends hn{constructor(t,r){super(t,r,$a,ln),this.core=t,this.logger=r}}class gn extends vf{constructor(t){super(t),this.protocol=Ci,this.version=Fi,this.name=dn.name,this.events=new ct.exports.EventEmitter,this.on=(n,i)=>this.events.on(n,i),this.once=(n,i)=>this.events.once(n,i),this.off=(n,i)=>this.events.off(n,i),this.removeListener=(n,i)=>this.events.removeListener(n,i),this.removeAllListeners=n=>this.events.removeAllListeners(n),this.connect=async n=>{try{return await this.engine.connect(n)}catch(i){throw this.logger.error(i.message),i}},this.pair=async n=>{try{return await this.engine.pair(n)}catch(i){throw this.logger.error(i.message),i}},this.approve=async n=>{try{return await this.engine.approve(n)}catch(i){throw this.logger.error(i.message),i}},this.reject=async n=>{try{return await this.engine.reject(n)}catch(i){throw this.logger.error(i.message),i}},this.update=async n=>{try{return await this.engine.update(n)}catch(i){throw this.logger.error(i.message),i}},this.extend=async n=>{try{return await this.engine.extend(n)}catch(i){throw this.logger.error(i.message),i}},this.request=async n=>{try{return await this.engine.request(n)}catch(i){throw this.logger.error(i.message),i}},this.respond=async n=>{try{return await this.engine.respond(n)}catch(i){throw this.logger.error(i.message),i}},this.ping=async n=>{try{return await this.engine.ping(n)}catch(i){throw this.logger.error(i.message),i}},this.emit=async n=>{try{return await this.engine.emit(n)}catch(i){throw this.logger.error(i.message),i}},this.disconnect=async n=>{try{return await this.engine.disconnect(n)}catch(i){throw this.logger.error(i.message),i}},this.find=n=>{try{return this.engine.find(n)}catch(i){throw this.logger.error(i.message),i}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(n){throw this.logger.error(n.message),n}},this.name=t?.name||dn.name,this.metadata=t?.metadata||zd();const r=typeof t?.logger<"u"&&typeof t?.logger!="string"?t.logger:zr(xe.getDefaultLoggerOptions({level:t?.logger||dn.logger}));this.core=t?.core||new q_(t),this.logger=xe.generateChildLogger(r,this.name),this.session=new ny(this.core,this.logger),this.proposal=new ry(this.core,this.logger),this.pendingRequest=new iy(this.core,this.logger),this.engine=new ty(this)}static async init(t){const r=new gn(t);return await r.initialize(),r}get context(){return xe.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success")}catch(t){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(t.message),t}}}const sy=gn;Ie.ENGINE_CONTEXT=Ua,Ie.ENGINE_RPC_OPTS=ur,Ie.HISTORY_CONTEXT=W_,Ie.HISTORY_EVENTS=G_,Ie.HISTORY_STORAGE_VERSION=Y_,Ie.PROPOSAL_CONTEXT=Fa,Ie.PROPOSAL_EXPIRY=k_,Ie.REQUEST_CONTEXT=$a,Ie.SESSION_CONTEXT=La,Ie.SESSION_EXPIRY=Ur,Ie.SESSION_REQUEST_EXPIRY_BOUNDARIES=pn,Ie.SIGN_CLIENT_CONTEXT=Li,Ie.SIGN_CLIENT_DEFAULT=dn,Ie.SIGN_CLIENT_EVENTS=H_,Ie.SIGN_CLIENT_PROTOCOL=Ci,Ie.SIGN_CLIENT_STORAGE_OPTIONS=V_,Ie.SIGN_CLIENT_STORAGE_PREFIX=ln,Ie.SIGN_CLIENT_VERSION=Fi,Ie.SignClient=sy,Ie.default=gn,Object.defineProperty(Ie,"__esModule",{value:!0})});
//# sourceMappingURL=index.umd.js.map
