"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.createStackFrame = createStackFrame;
exports.createChildStackFrame = createChildStackFrame;

function createStackFrame(code, locals, originatingModule, allocator) {
  return {
    code: code,
    locals: locals,
    globals: [],

    /**
     * Labels are named block of code.
     * We maintain a map to access the block for a given identifier.
     *
     * https://webassembly.github.io/spec/core/exec/runtime.html#labels
     */
    labels: [],

    /**
     * Local applicatif Stack for the current stackframe.
     *
     * https://webassembly.github.io/spec/core/exec/runtime.html#stack
     */
    values: [],

    /**
     * We keep a reference to its originating module.
     *
     * When we need to lookup a function by addr for example.
     */
    originatingModule: originatingModule,

    /**
     * For shared memory operations
     */
    allocator: allocator
  };
}

function createChildStackFrame(parent, code) {
  var locals = parent.locals,
      originatingModule = parent.originatingModule,
      labels = parent.labels,
      allocator = parent.allocator;
  var frame = createStackFrame(code, locals, originatingModule, allocator);
  frame.labels = labels;
  return frame;
}